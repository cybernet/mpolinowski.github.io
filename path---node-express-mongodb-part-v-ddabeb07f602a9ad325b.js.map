{"version":3,"sources":["webpack:///path---node-express-mongodb-part-v-ddabeb07f602a9ad325b.js","webpack:///./.cache/json/node-express-mongodb-part-v.json"],"names":["webpackJsonp","660","module","exports","data","post","id","html","fields","slug","prefix","frontmatter","title","subTitle","cover","childImageSharp","resize","src","author","footnote","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,GAAA,oIAAAC,KAAA;AAA4zyIC,QAAu9BC,KAAA,gCAAAC,OAAA,cAA6DC,aAAgBC,MAAA,iCAAAC,SAAA,sFAAAC,OAAmJC,iBAAmBC,QAAUC,IAAA,+FAAoGC,QAAWZ,GAAA,6FAAAC,KAAA,4OAAsVY,UAAab,GAAA,+FAAAC,KAAA,0jBAAgrBa,aAAgBX,KAAA","file":"path---node-express-mongodb-part-v-ddabeb07f602a9ad325b.js","sourcesContent":["webpackJsonp([43217172008614],{\n\n/***/ 660:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"post\":{\"id\":\"E:/gatsby-starter-personal-blog/content/posts/2016-06-09--node-express-mongodb-part-v/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-7319b.jpg\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 43.134171907756816%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAGMtLnUP//EABkQAQACAwAAAAAAAAAAAAAAAAEAAhAxQf/aAAgBAQABBQLixwS2/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwGI/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAECAQE/Abqv/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEQMUGBoeH/2gAIAQEABj8CssFNHBT/AP/EABwQAAICAgMAAAAAAAAAAAAAAAERADEQQSFRcf/aAAgBAQABPyEOhRbgo7PnaO6MGNvcf//aAAwDAQACAAMAAAAQvD//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxCEP//EABcRAQADAAAAAAAAAAAAAAAAAAARUWH/2gAIAQIBAT8Q2St//8QAHBAAAQUBAQEAAAAAAAAAAAAAAQARITFxQVFh/9oACAEBAAE/EBIH8JEDnjRTcR4SIoBobEYiL5fSrpV3V2L/2Q=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Harbin\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-78f2b.jpg\\\"\\n        srcset=\\\"/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-dce19.jpg 200w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-c1413.jpg 400w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-78f2b.jpg 800w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-ab4c4.jpg 1200w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-bc99b.jpg 1600w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-7319b.jpg 1908w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p><a href=\\\"github.com/mpolinowski/node_express_git\\\">Github Repository</a></p>\\n<blockquote>\\n<p>This code is part of a training in web development with <a href=\\\"https://nodejs.org/en/\\\">Node.js</a>. <a href=\\\"http://ejs.co\\\">EJS</a> will be used as template engine for rendering HTML out of <a href=\\\"https://expressjs.com\\\">Express</a>. The library application will use <a href=\\\"https://www.mongodb.com\\\">MongoDB</a> to store information about books and authors - but will also employ the <a href=\\\"https://www.goodreads.com/api\\\">GoodReads API</a> to provide more details on each. <a href=\\\"http://www.passportjs.org\\\">Passport.js</a> is used for local security.</p>\\n</blockquote>\\n<ul>\\n<li>In <a href=\\\"/node-express-mongodb-part-i/\\\">Part I</a> we go through the basic <a href=\\\"https://nodejs.org/en/\\\">Node.js</a> and <a href=\\\"https://expressjs.com\\\">Express</a> setup</li>\\n<li>In <a href=\\\"/node-express-mongodb-part-ii/\\\">Part II</a> we added <a href=\\\"https://bower.io/\\\">Bower.js</a> and the <a href=\\\"https://gulpjs.com/\\\">Gulp.js</a> taskrunner to manage our style dependencies and auto-restart our development environment using <a href=\\\"https://nodemon.io\\\">Nodemon.js</a></li>\\n<li>Here Part III and we add the magic of the <a href=\\\"http://ejs.co\\\">EJS</a> templating engine</li>\\n<li><a href=\\\"/node-express-mongodb-part-iv/\\\">Part IV</a> deals with advanced Express routing options</li>\\n<li><a href=\\\"/node-express-mongodb-part-v/\\\">Part V</a> deals with <a href=\\\"http://www.passportjs.org\\\">Passport.js</a> user authentication and <a href=\\\"https://www.mongodb.com\\\">MongoDB</a></li>\\n</ul>\\n<!-- TOC -->\\n<ul>\\n<li>\\n<p><a href=\\\"#01-adding-mongodb\\\">01 Adding MongoDB</a></p>\\n<ul>\\n<li><a href=\\\"#download-and-install-mongodb\\\">Download and Install MongoDB</a></li>\\n<li><a href=\\\"#create-adminroutes-to-populate-the-database\\\">Create adminRoutes to populate the Database</a></li>\\n</ul>\\n</li>\\n<li>\\n<p><a href=\\\"#02-use-the-mongodb-response\\\">02 Use the MongoDB Response</a></p>\\n<ul>\\n<li><a href=\\\"#select-many\\\">Select Many</a></li>\\n<li><a href=\\\"#select-one\\\">Select One</a></li>\\n</ul>\\n</li>\\n<li><a href=\\\"#03-creating-a-signin-form-on-indexejs\\\">03 Creating a SignIn Form on Index.ejs</a></li>\\n<li><a href=\\\"#05-creating-the-authentication-route\\\">05 Creating the Authentication Route</a></li>\\n<li><a href=\\\"#06-adding-passportjs-middleware\\\">06 Adding Passport.js Middleware</a></li>\\n<li><a href=\\\"#07-authentication-with-local-strategy\\\">07 Authentication with Local Strategy</a></li>\\n<li><a href=\\\"#08-saving-the-user-to-mongodb\\\">08 Saving the User to MongoDB</a></li>\\n<li><a href=\\\"#09-user-signin-from-mongodb\\\">09 User SignIn from mongoDB</a></li>\\n<li><a href=\\\"#10-verifying-user-in-db\\\">10 Verifying User in DB</a></li>\\n</ul>\\n<!-- /TOC -->\\n<h2 id=\\\"01-adding-mongodb\\\"><a href=\\\"#01-adding-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>01 Adding MongoDB</h2>\\n<h3 id=\\\"download-and-install-mongodb\\\"><a href=\\\"#download-and-install-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Download and Install MongoDB</h3>\\n<p>The installer can be downloaded from <a href=\\\"https://www.mongodb.com\\\">MongoDB.com</a></p>\\n<p>Install the database, navigate to the install directory (e.g. <em>C:\\\\Program Files\\\\MongoDB\\\\Server\\\\3.2\\\\bin</em>) with your command line and start the application with the command <strong>mongod</strong>. Make sure that you created a directory C:\\\\data\\\\db before running the mongod process!</p>\\n<p>Useful Commands for MongoDB:</p>\\n<table>\\n<thead>\\n<tr>\\n<th></th>\\n<th></th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td><strong><em>Command</em></strong></td>\\n<td><strong><em>Function</em></strong></td>\\n</tr>\\n<tr>\\n<td><strong>mongo</strong></td>\\n<td>Start</td>\\n</tr>\\n<tr>\\n<td><strong>show dbs</strong></td>\\n<td>Display all Databases</td>\\n</tr>\\n<tr>\\n<td><strong>mongo libraryApp</strong></td>\\n<td>Open libraryApp Database</td>\\n</tr>\\n<tr>\\n<td><strong>show collections</strong></td>\\n<td>Show all Collections of the opened Databases</td>\\n</tr>\\n<tr>\\n<td><strong>db.books.find();</strong></td>\\n<td>Display all Objects inside the books Collection</td>\\n</tr>\\n<tr>\\n<td><strong>db.books.remove({})</strong></td>\\n<td>Remove all Objects from the books Collection</td>\\n</tr>\\n</tbody>\\n</table>\\n<h3 id=\\\"create-adminroutes-to-populate-the-database\\\"><a href=\\\"#create-adminroutes-to-populate-the-database\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Create adminRoutes to populate the Database</h3>\\n<p>First install mongoDB into our project with <em>npm install —save mongodb</em></p>\\n<p>Now we create a new file adminRoutes.js in the src/routes directory.</p>\\n<p>adminRoutes.js</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Pull in the mongoClient */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> books <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Copy books from bookRoutes.js */</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Cryptonomicon'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0060512806'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Neil Stephenson'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'816'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/414L%2BIbzcvL._SX317_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Leviathan Wakes'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0316129089'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'James S.A. Corey'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'9533361'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/51QvTzb2vYL._SX322_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'The Lord of the Rings'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0395193958'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'J.R.R. Tolkien'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'569465'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/51eq24cRtRL._SX331_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Norwegian Wood'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0375704027'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Haruki Murakami'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'11297'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/512ZgaaHjIL._SX322_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Microserfs'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0006548598'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Douglas Coupland'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'2751'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/512ZD5DVC4L._SX345_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Up Country'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0446611913'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Nelson Demille'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'33820'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/512Jrk-RopL._SX290_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Night over Water'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0451173139'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Ken Follett'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'967690'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/51OON2-%2BI-L._SX297_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'The Stand'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0307947300'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Stephen King'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'13155183'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/41IzCMjxPWL._SX320_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    adminRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/addBooks'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">/* open http://localhost:8080/Admin/addBooks to add books to MongoDB */</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Connect to our local installation of MongoDB via the default port 27017 - create DB libraryApp on insert */</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Connect to a Collection in libraryApp named books - is created on first insert */</span>\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">insertMany</span><span class=\\\"token punctuation\\\">(</span>books<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* insertMany inserts all Objects from the books variable from above (otherwise insertOne) */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span>results<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Display the Collection after Insert - Object will be assigned ID by MongoDB*/</span>\\n                        db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">close</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* db.close has to be inside the callback (async !)*/</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> adminRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Add the /Admin route to App.js and use adminRouter for it</p>\\n<p><strong>app.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> port <span class=\\\"token operator\\\">=</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">PORT</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> nav <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Book'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Author'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/bookRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/adminRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Add adminRoutes */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'views'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'./src/views'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'view engine'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'ejs'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span> bookRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Admin'</span><span class=\\\"token punctuation\\\">,</span> adminRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use adminRoutes for /Admin */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'index'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Hello from render'</span><span class=\\\"token punctuation\\\">,</span>\\n        nav<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Authors'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/books'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Hello Books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'running server on port '</span> <span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Now make sure mongod is running and access <a href=\\\"http://localhost:8080/Admin/addBooks\\\">http://localhost:8080/Admin/addBooks</a> - you will get a JSON Object as MongoDB Response. All books will have an ID assigned by the Database and the DB ‘libraryApp’ and Collection ‘books’ will be created. Use the mongo commands (List, above) to check.</p>\\n<h2 id=\\\"02-use-the-mongodb-response\\\"><a href=\\\"#02-use-the-mongodb-response\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>02 Use the MongoDB Response</h2>\\n<h3 id=\\\"select-many\\\"><a href=\\\"#select-many\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Select Many</h3>\\n<p>Remove the hardcoded books variable and use the mongoDB response instead. Display all books from the books Collection. (bookListView.ejs)</p>\\n<p><strong>bookRoutes.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n <span class=\\\"token comment\\\">/* var books = [...]; has been deleted */</span>\\n\\n    bookRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Connect to mongoDBs libraryApp books Collection */</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toArray</span><span class=\\\"token punctuation\\\">(</span> <span class=\\\"token comment\\\">/* find all Objects in the books Collection and put it into an Array */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bookListView'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Copy the res.render from before into the function to render the result of our mongoDB query*/</span>\\n                            title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span><span class=\\\"token punctuation\\\">,</span>\\n                            nav<span class=\\\"token punctuation\\\">:</span> nav<span class=\\\"token punctuation\\\">,</span>\\n                            books<span class=\\\"token punctuation\\\">:</span> results\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> bookRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h3 id=\\\"select-one\\\"><a href=\\\"#select-one\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Select One</h3>\\n<p>Now we want to have a books details page (bookView.ejs) that only displays one book from the books Collection</p>\\n<p><strong>bookRoutes.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> objectId <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>ObjectID<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Each book is assigned an ID by mongoDB - we make this ID available for our bookListView.ejs */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    bookRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toArray</span><span class=\\\"token punctuation\\\">(</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bookListView'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n                            title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span><span class=\\\"token punctuation\\\">,</span>\\n                            nav<span class=\\\"token punctuation\\\">:</span> nav<span class=\\\"token punctuation\\\">,</span>\\n                            books<span class=\\\"token punctuation\\\">:</span> results\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    bookRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/:id'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> id <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">objectId</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>params<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We use the mongoDB ID (_id) for id -> URL is now /Books/:_id instead of /Books/:id */</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findOne</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>_id<span class=\\\"token punctuation\\\">:</span> id<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* findOne returns the first book from the books collection with the same _id */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bookView'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* result will be rendered in bookView.ejs */</span>\\n                            title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span><span class=\\\"token punctuation\\\">,</span>\\n                            nav<span class=\\\"token punctuation\\\">:</span> nav<span class=\\\"token punctuation\\\">,</span>\\n                            book<span class=\\\"token punctuation\\\">:</span> results\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> bookRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Now we want to have a books details page (bookView.ejs) that only displays one book from the books Collection</p>\\n<p><strong>bookListView.ejs</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\">...\\n<span class=\\\"token comment\\\">&lt;!-- ################################################ Media ######################################################### --></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>section</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>container<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">margin-bottom</span><span class=\\\"token punctuation\\\">:</span> 400px<span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>row<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n        &lt;% for(var i=0; i&lt;books.length;i++){%>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-6 col-md-4 col-lg-3 center-block<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">margin-bottom</span><span class=\\\"token punctuation\\\">:</span> 10px<span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>panel panel-default<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>panel-heading<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>h4</span><span class=\\\"token punctuation\\\">></span></span>&lt;%=books[i].title%><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>h4</span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>panel-body<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-12 col-sm-4 col-lg-6<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>a</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>story-title<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">href</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>/Books/&lt;%=books[i]._id%><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>img</span> <span class=\\\"token attr-name\\\">alt</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>&lt;%=books[i].cover%><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">height</span><span class=\\\"token punctuation\\\">:</span>100px</span><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>img-thumbnail<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-12 col-sm-8 col-lg-6<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>p</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>label label-default<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>strong</span><span class=\\\"token punctuation\\\">></span></span>&lt;%=books[i].author%><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>strong</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>p</span><span class=\\\"token punctuation\\\">></span></span>\\n                            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>p</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">font-family</span><span class=\\\"token punctuation\\\">:</span>courier,<span class=\\\"token string\\\">'new courier'</span><span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text-muted<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>a</span> <span class=\\\"token attr-name\\\">href</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>/Books/&lt;%=books[i]._id%><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text-muted<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>Read More<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>p</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Change URL from /Books/:i (&lt;%= i %> with i = 0,1,2,3....8) to /Books/:_id -> _id will be used to findOne --></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n            &lt;%}%>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>hr</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>section</span><span class=\\\"token punctuation\\\">></span></span>\\n...</code></pre>\\n      </div>\\n<h2 id=\\\"03-creating-a-signin-form-on-indexejs\\\"><a href=\\\"#03-creating-a-signin-form-on-indexejs\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>03 Creating a SignIn Form on Index.ejs</h2>\\n<p>Just a simple Input Form</p>\\n<p><strong>index.ejs</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\">...\\n<span class=\\\"token comment\\\">&lt;!-- ################################################ Login ######################################################### --></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-4 col-xs-offset-1<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">margin-top</span><span class=\\\"token punctuation\\\">:</span> 30px<span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>container<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>row<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-sm-offset-1 col-sm-2 col-xs-12 text-center<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>form</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>signUpForm<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">action</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>/auth/signUp<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>post<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Creating a form to post SignUp to /auth/signUp --></span>\\n                    User Name:\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>input</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>userName<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>userName<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Input userName for post --></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    Password:\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>input</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>password<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>password<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Input password for post --></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>input</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>submit<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">value</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>Sign Up<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Submit post --></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>form</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- /row --></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- /container --></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- /v-center --></span>\\n\\n<span class=\\\"token comment\\\">&lt;!-- ################################################ /Login ######################################################### --></span>\\n...</code></pre>\\n      </div>\\n<h2 id=\\\"05-creating-the-authentication-route\\\"><a href=\\\"#05-creating-the-authentication-route\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>05 Creating the Authentication Route</h2>\\n<p>We need to add var bodyParser = require(‘body-parser’); to app.js. The body-parser middleware will be used in app.use(bodyParser.json()); and app.use(bodyParser.urlencoded()); to create a req.body object from JSON elements or URL parameter. Body-parser is install with npm install —save body-parser.</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Creating the Authentication Router */</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">/* Creating the SingUp route */</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We log the req.body Object created by bodyParser from the signUp post to /auth/signup */</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* return authRouter to be available for app.js */</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>We now add the authRoute to app.js</p>\\n<p><strong>app.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bodyParser <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'body-parser'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">/* Install bodyParser see above */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> port <span class=\\\"token operator\\\">=</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">PORT</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> nav <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Book'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Author'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/bookRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/adminRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/authRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use the created authRouter for the Authentication routes */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use bodyParser to create req.body Object from JSON elements*/</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">urlencoded</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use bodyParser to create req.body Object from URL encoded JSON elements*/</span>\\n\\n<span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/config/passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>app<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'views'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'./src/views'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'view engine'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'ejs'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span> bookRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Admin'</span><span class=\\\"token punctuation\\\">,</span> adminRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Auth'</span><span class=\\\"token punctuation\\\">,</span> authRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use the created authRouter for the Authentication routes */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'index'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Hello from render'</span><span class=\\\"token punctuation\\\">,</span>\\n        nav<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Authors'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/books'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Hello Books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'running server on port '</span> <span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"06-adding-passportjs-middleware\\\"><a href=\\\"#06-adding-passportjs-middleware\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>06 Adding Passport.js Middleware</h2>\\n<p>First we need to <em>npm install —save cookie-parser passport express-session</em>.</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bodyParser <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'body-parser'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> cookieParser <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'cookie-parser'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* To parse the session cookie used by passport */</span>\\n<span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* user authentication */</span>\\n<span class=\\\"token keyword\\\">var</span> session <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express-session'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* for passport-session: creates a session for the logged in user. Session stores the user information inside a cookie for the active session */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> port <span class=\\\"token operator\\\">=</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">PORT</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> nav <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Book'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Author'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/bookRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/adminRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/authRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">urlencoded</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">cookieParser</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* use cookieParser to parse the session cookie */</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">session</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>secret<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'library'</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* The session needs a secret - can be chosen freely */</span>\\n\\n<span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/config/passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>app<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We separate the passport stuff src/config/passport.js - we pull in (app) to be able to app.use inside passport.js */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'views'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'./src/views'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'view engine'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'ejs'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span> bookRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Admin'</span><span class=\\\"token punctuation\\\">,</span> adminRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Auth'</span><span class=\\\"token punctuation\\\">,</span> authRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'index'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Hello from render'</span><span class=\\\"token punctuation\\\">,</span>\\n        nav<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Authors'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/books'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Hello Books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'running server on port '</span> <span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Separate the passport component to <em>src/config/passport.js</em>. We need to <em>npm install —save passport-local</em> to use the local strategy of authentication (not OAuth).</p>\\n<p><strong>passport.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* pull in passport */</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function-variable function\\\">exports</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>app<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">initialize</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">session</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">serializeUser</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span> done<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Add User to Session */</span>\\n        <span class=\\\"token function\\\">done</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Callback User from Database */</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">deserializeUser</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span> done<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Remove User from Session */</span>\\n        <span class=\\\"token function\\\">done</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./strategies/local.strategy'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We only use a local.strategy for authentication - not passport.google, passport.facebook, etc. - Third-party OAuth. We save the file in src/config/strategies/local.strategy.js */</span>\\n\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"07-authentication-with-local-strategy\\\"><a href=\\\"#07-authentication-with-local-strategy\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>07 Authentication with Local Strategy</h2>\\n<p>Now we create the local.strategy.js as required in passport.js:</p>\\n<p><strong>local.strategy.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n    LocalStrategy <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport-local'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>Strategy<span class=\\\"token punctuation\\\">,</span>\\n    mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function-variable function\\\">exports</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">LocalStrategy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n          usernameField<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'userName'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* take userName from input form in index.ejs when posted to /auth/signUp (bodyParser) */</span>\\n          passwordField<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'password'</span> <span class=\\\"token comment\\\">/* take password from input form in index.ejs when posted to /auth/signUp (bodyParser) */</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>username<span class=\\\"token punctuation\\\">,</span> password<span class=\\\"token punctuation\\\">,</span> done<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Pass username/password - then callBack done */</span>\\n          <span class=\\\"token keyword\\\">var</span> user <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>username<span class=\\\"token punctuation\\\">:</span> username<span class=\\\"token punctuation\\\">,</span>\\n                      password<span class=\\\"token punctuation\\\">:</span> password\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token function\\\">done</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Take user and return user - authentication with mongoDB comes next */</span>\\n                  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>req.login and redirect to Profile</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            req<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">login</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* We do not yet save the user to mongoDB - just redirect him to /auth/profile */</span>\\n              res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/profile'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">/* we have to create the profile route */</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* When GET /profile... */</span>\\n        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* ... respond with the JSON Object user */</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"08-saving-the-user-to-mongodb\\\"><a href=\\\"#08-saving-the-user-to-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>08 Saving the User to MongoDB</h2>\\n<p>SignUp save User to MongoDB</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* connect to local install of mongoDB */</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'users'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* open users collection that is created on first signUp */</span>\\n                <span class=\\\"token keyword\\\">var</span> user <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Creation of a user object from req.body */</span>\\n                    username<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>userName<span class=\\\"token punctuation\\\">,</span>\\n                    password<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>password\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">insert</span><span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* the user is automatically inserted into the users collection (collection is automatically created) */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        req<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">login</span><span class=\\\"token punctuation\\\">(</span>results<span class=\\\"token punctuation\\\">.</span>ops<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* user is no longer taken from req.body but from the results ops[0] limits the result to the {username, password, _id} JSON object */</span>\\n                            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/profile'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"09-user-signin-from-mongodb\\\"><a href=\\\"#09-user-signin-from-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>09 User SignIn from mongoDB</h2>\\n<p>Creating the SignIn Form</p>\\n<p><strong>index.ejs</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> ################################################ Login ######################################################### <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n\\n<span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"col-xs-4 col-xs-offset-1\\\"</span> style<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"margin-top: 30px;\\\"</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"container\\\"</span><span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"row\\\"</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"col-sm-offset-3 col-sm-2 col-xs-12 text-center\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span>form name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"signInForm\\\"</span> action<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"/auth/signIn\\\"</span> method<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"post\\\"</span><span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> SignIN <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n                    User Name<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    Password<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input type<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"submit\\\"</span> value<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"Sign In\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>form<span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n\\n            <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"clearfix visible-xs\\\"</span> style<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"margin-bottom: 20px;\\\"</span><span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n\\n            <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"col-sm-offset-1 col-sm-2 col-xs-12 text-center\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span>form name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"signUpForm\\\"</span> action<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"/auth/signUp\\\"</span> method<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"post\\\"</span><span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> SignUp <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n                    User Name<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    Password<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input type<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"submit\\\"</span> value<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"Sign Up\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>form<span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> <span class=\\\"token operator\\\">/</span>row <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> <span class=\\\"token operator\\\">/</span>container <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> <span class=\\\"token operator\\\">/</span>v<span class=\\\"token operator\\\">-</span>center <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> ################################################ <span class=\\\"token operator\\\">/</span>Login ######################################################### <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span></code></pre>\\n      </div>\\n<p>SignIn save User to MongoDB</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Pull in passport for signIn */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'users'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">var</span> user <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n                    username<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>userName<span class=\\\"token punctuation\\\">,</span>\\n                    password<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>password\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">insert</span><span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        req<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">login</span><span class=\\\"token punctuation\\\">(</span>results<span class=\\\"token punctuation\\\">.</span>ops<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signIn'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span>passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">authenticate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'local'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* user post is authenticated with passport local strategy */</span>\\n            failureRedirect<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span> <span class=\\\"token comment\\\">/* If user did not sign up first - redirect back to home */</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* If successfully authenticated go to profile page */</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/profile'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">all</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token function\\\">next</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"10-verifying-user-in-db\\\"><a href=\\\"#10-verifying-user-in-db\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>10 Verifying User in DB</h2>\\n<p><strong>authRoute.js</strong></p>\\n<p>…</p>\\n<ul>\\n<li><a href=\\\"/node-express-mongodb-part-i/\\\">Part I</a></li>\\n<li><a href=\\\"/node-express-mongodb-part-ii/\\\">Part II</a></li>\\n<li><a href=\\\"/node-express-mongodb-part-iii/\\\">Part III</a></li>\\n<li><a href=\\\"/node-express-mongodb-part-iv/\\\">Part IV</a></li>\\n</ul>\",\"fields\":{\"slug\":\"/node-express-mongodb-part-v/\",\"prefix\":\"2016-06-09\"},\"frontmatter\":{\"title\":\"Node/Express with MongoDB (IV)\",\"subTitle\":\"Building a Express Web Library with a MongoDB Backend and Goodreads API Integration\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/photo-34607488365_9f40aafb01_o-cover-c8667551af902c842b1faf2b28f188f7-ada8c.jpg\"}}}}},\"author\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p><strong>Mike Polinowski</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\\\"/contact/\\\">contact me</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. :hearts:</p>\"},\"footnote\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>This is a personal Developer Blog</li>\\n<li>Ξ</li>\\n<li>built by <a href=\\\"https://github.com/mpolinowski\\\">Mike Polinowski</a></li>\\n<li>Ξ</li>\\n<li>with <a href=\\\"https://www.gatsbyjs.org/\\\">Gatsby</a> &#x26; <a href=\\\"https://reactjs.org\\\">React</a></li>\\n<li>Ξ</li>\\n<li>source code on <a href=\\\"https://github.com/mpolinowski/mpolinowski.github.io\\\">GitHub</a></li>\\n<li>Ξ</li>\\n<li>deliverd by <a href=\\\"https://pages.github.com\\\">Github Pages</a></li>\\n<li>Ξ</li>\\n<li>photos from <a href=\\\"https://www.flickr.com/people/149680084@N06/\\\">Flickr</a></li>\\n</ul>\"}},\"pathContext\":{\"slug\":\"/node-express-mongodb-part-v/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---node-express-mongodb-part-v-ddabeb07f602a9ad325b.js","module.exports = {\"data\":{\"post\":{\"id\":\"E:/gatsby-starter-personal-blog/content/posts/2016-06-09--node-express-mongodb-part-v/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-7319b.jpg\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 43.134171907756816%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAGMtLnUP//EABkQAQACAwAAAAAAAAAAAAAAAAEAAhAxQf/aAAgBAQABBQLixwS2/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwGI/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAECAQE/Abqv/8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEQMUGBoeH/2gAIAQEABj8CssFNHBT/AP/EABwQAAICAgMAAAAAAAAAAAAAAAERADEQQSFRcf/aAAgBAQABPyEOhRbgo7PnaO6MGNvcf//aAAwDAQACAAMAAAAQvD//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxCEP//EABcRAQADAAAAAAAAAAAAAAAAAAARUWH/2gAIAQIBAT8Q2St//8QAHBAAAQUBAQEAAAAAAAAAAAAAAQARITFxQVFh/9oACAEBAAE/EBIH8JEDnjRTcR4SIoBobEYiL5fSrpV3V2L/2Q=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Harbin\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-78f2b.jpg\\\"\\n        srcset=\\\"/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-dce19.jpg 200w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-c1413.jpg 400w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-78f2b.jpg 800w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-ab4c4.jpg 1200w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-bc99b.jpg 1600w,\\n/static/photo-34607488365_9f40aafb01_o-632356ef9bf974ad113163bedbf15fd0-7319b.jpg 1908w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p><a href=\\\"github.com/mpolinowski/node_express_git\\\">Github Repository</a></p>\\n<blockquote>\\n<p>This code is part of a training in web development with <a href=\\\"https://nodejs.org/en/\\\">Node.js</a>. <a href=\\\"http://ejs.co\\\">EJS</a> will be used as template engine for rendering HTML out of <a href=\\\"https://expressjs.com\\\">Express</a>. The library application will use <a href=\\\"https://www.mongodb.com\\\">MongoDB</a> to store information about books and authors - but will also employ the <a href=\\\"https://www.goodreads.com/api\\\">GoodReads API</a> to provide more details on each. <a href=\\\"http://www.passportjs.org\\\">Passport.js</a> is used for local security.</p>\\n</blockquote>\\n<ul>\\n<li>In <a href=\\\"/node-express-mongodb-part-i/\\\">Part I</a> we go through the basic <a href=\\\"https://nodejs.org/en/\\\">Node.js</a> and <a href=\\\"https://expressjs.com\\\">Express</a> setup</li>\\n<li>In <a href=\\\"/node-express-mongodb-part-ii/\\\">Part II</a> we added <a href=\\\"https://bower.io/\\\">Bower.js</a> and the <a href=\\\"https://gulpjs.com/\\\">Gulp.js</a> taskrunner to manage our style dependencies and auto-restart our development environment using <a href=\\\"https://nodemon.io\\\">Nodemon.js</a></li>\\n<li>Here Part III and we add the magic of the <a href=\\\"http://ejs.co\\\">EJS</a> templating engine</li>\\n<li><a href=\\\"/node-express-mongodb-part-iv/\\\">Part IV</a> deals with advanced Express routing options</li>\\n<li><a href=\\\"/node-express-mongodb-part-v/\\\">Part V</a> deals with <a href=\\\"http://www.passportjs.org\\\">Passport.js</a> user authentication and <a href=\\\"https://www.mongodb.com\\\">MongoDB</a></li>\\n</ul>\\n<!-- TOC -->\\n<ul>\\n<li>\\n<p><a href=\\\"#01-adding-mongodb\\\">01 Adding MongoDB</a></p>\\n<ul>\\n<li><a href=\\\"#download-and-install-mongodb\\\">Download and Install MongoDB</a></li>\\n<li><a href=\\\"#create-adminroutes-to-populate-the-database\\\">Create adminRoutes to populate the Database</a></li>\\n</ul>\\n</li>\\n<li>\\n<p><a href=\\\"#02-use-the-mongodb-response\\\">02 Use the MongoDB Response</a></p>\\n<ul>\\n<li><a href=\\\"#select-many\\\">Select Many</a></li>\\n<li><a href=\\\"#select-one\\\">Select One</a></li>\\n</ul>\\n</li>\\n<li><a href=\\\"#03-creating-a-signin-form-on-indexejs\\\">03 Creating a SignIn Form on Index.ejs</a></li>\\n<li><a href=\\\"#05-creating-the-authentication-route\\\">05 Creating the Authentication Route</a></li>\\n<li><a href=\\\"#06-adding-passportjs-middleware\\\">06 Adding Passport.js Middleware</a></li>\\n<li><a href=\\\"#07-authentication-with-local-strategy\\\">07 Authentication with Local Strategy</a></li>\\n<li><a href=\\\"#08-saving-the-user-to-mongodb\\\">08 Saving the User to MongoDB</a></li>\\n<li><a href=\\\"#09-user-signin-from-mongodb\\\">09 User SignIn from mongoDB</a></li>\\n<li><a href=\\\"#10-verifying-user-in-db\\\">10 Verifying User in DB</a></li>\\n</ul>\\n<!-- /TOC -->\\n<h2 id=\\\"01-adding-mongodb\\\"><a href=\\\"#01-adding-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>01 Adding MongoDB</h2>\\n<h3 id=\\\"download-and-install-mongodb\\\"><a href=\\\"#download-and-install-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Download and Install MongoDB</h3>\\n<p>The installer can be downloaded from <a href=\\\"https://www.mongodb.com\\\">MongoDB.com</a></p>\\n<p>Install the database, navigate to the install directory (e.g. <em>C:\\\\Program Files\\\\MongoDB\\\\Server\\\\3.2\\\\bin</em>) with your command line and start the application with the command <strong>mongod</strong>. Make sure that you created a directory C:\\\\data\\\\db before running the mongod process!</p>\\n<p>Useful Commands for MongoDB:</p>\\n<table>\\n<thead>\\n<tr>\\n<th></th>\\n<th></th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td><strong><em>Command</em></strong></td>\\n<td><strong><em>Function</em></strong></td>\\n</tr>\\n<tr>\\n<td><strong>mongo</strong></td>\\n<td>Start</td>\\n</tr>\\n<tr>\\n<td><strong>show dbs</strong></td>\\n<td>Display all Databases</td>\\n</tr>\\n<tr>\\n<td><strong>mongo libraryApp</strong></td>\\n<td>Open libraryApp Database</td>\\n</tr>\\n<tr>\\n<td><strong>show collections</strong></td>\\n<td>Show all Collections of the opened Databases</td>\\n</tr>\\n<tr>\\n<td><strong>db.books.find();</strong></td>\\n<td>Display all Objects inside the books Collection</td>\\n</tr>\\n<tr>\\n<td><strong>db.books.remove({})</strong></td>\\n<td>Remove all Objects from the books Collection</td>\\n</tr>\\n</tbody>\\n</table>\\n<h3 id=\\\"create-adminroutes-to-populate-the-database\\\"><a href=\\\"#create-adminroutes-to-populate-the-database\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Create adminRoutes to populate the Database</h3>\\n<p>First install mongoDB into our project with <em>npm install —save mongodb</em></p>\\n<p>Now we create a new file adminRoutes.js in the src/routes directory.</p>\\n<p>adminRoutes.js</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Pull in the mongoClient */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> books <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Copy books from bookRoutes.js */</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Cryptonomicon'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0060512806'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Neil Stephenson'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'816'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/414L%2BIbzcvL._SX317_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Leviathan Wakes'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0316129089'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'James S.A. Corey'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'9533361'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/51QvTzb2vYL._SX322_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'The Lord of the Rings'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0395193958'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'J.R.R. Tolkien'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'569465'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/51eq24cRtRL._SX331_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Norwegian Wood'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0375704027'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Haruki Murakami'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'11297'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/512ZgaaHjIL._SX322_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Microserfs'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0006548598'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Douglas Coupland'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'2751'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/512ZD5DVC4L._SX345_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Up Country'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0446611913'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Nelson Demille'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'33820'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/512Jrk-RopL._SX290_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Night over Water'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0451173139'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Ken Follett'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'967690'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/51OON2-%2BI-L._SX297_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'The Stand'</span><span class=\\\"token punctuation\\\">,</span>\\n    isbn10<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'0307947300'</span><span class=\\\"token punctuation\\\">,</span>\\n    author<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Stephen King'</span><span class=\\\"token punctuation\\\">,</span>\\n    bookId<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'13155183'</span><span class=\\\"token punctuation\\\">,</span>\\n    cover<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'http://ecx.images-amazon.com/images/I/41IzCMjxPWL._SX320_BO1,204,203,200_.jpg'</span><span class=\\\"token punctuation\\\">,</span>\\n    read<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">true</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    adminRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/addBooks'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">/* open http://localhost:8080/Admin/addBooks to add books to MongoDB */</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Connect to our local installation of MongoDB via the default port 27017 - create DB libraryApp on insert */</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Connect to a Collection in libraryApp named books - is created on first insert */</span>\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">insertMany</span><span class=\\\"token punctuation\\\">(</span>books<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* insertMany inserts all Objects from the books variable from above (otherwise insertOne) */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span>results<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Display the Collection after Insert - Object will be assigned ID by MongoDB*/</span>\\n                        db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">close</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* db.close has to be inside the callback (async !)*/</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> adminRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Add the /Admin route to App.js and use adminRouter for it</p>\\n<p><strong>app.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> port <span class=\\\"token operator\\\">=</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">PORT</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> nav <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Book'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Author'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/bookRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/adminRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Add adminRoutes */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'views'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'./src/views'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'view engine'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'ejs'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span> bookRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Admin'</span><span class=\\\"token punctuation\\\">,</span> adminRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use adminRoutes for /Admin */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'index'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Hello from render'</span><span class=\\\"token punctuation\\\">,</span>\\n        nav<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Authors'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/books'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Hello Books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'running server on port '</span> <span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Now make sure mongod is running and access <a href=\\\"http://localhost:8080/Admin/addBooks\\\">http://localhost:8080/Admin/addBooks</a> - you will get a JSON Object as MongoDB Response. All books will have an ID assigned by the Database and the DB ‘libraryApp’ and Collection ‘books’ will be created. Use the mongo commands (List, above) to check.</p>\\n<h2 id=\\\"02-use-the-mongodb-response\\\"><a href=\\\"#02-use-the-mongodb-response\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>02 Use the MongoDB Response</h2>\\n<h3 id=\\\"select-many\\\"><a href=\\\"#select-many\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Select Many</h3>\\n<p>Remove the hardcoded books variable and use the mongoDB response instead. Display all books from the books Collection. (bookListView.ejs)</p>\\n<p><strong>bookRoutes.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n <span class=\\\"token comment\\\">/* var books = [...]; has been deleted */</span>\\n\\n    bookRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Connect to mongoDBs libraryApp books Collection */</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toArray</span><span class=\\\"token punctuation\\\">(</span> <span class=\\\"token comment\\\">/* find all Objects in the books Collection and put it into an Array */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bookListView'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Copy the res.render from before into the function to render the result of our mongoDB query*/</span>\\n                            title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span><span class=\\\"token punctuation\\\">,</span>\\n                            nav<span class=\\\"token punctuation\\\">:</span> nav<span class=\\\"token punctuation\\\">,</span>\\n                            books<span class=\\\"token punctuation\\\">:</span> results\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> bookRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h3 id=\\\"select-one\\\"><a href=\\\"#select-one\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Select One</h3>\\n<p>Now we want to have a books details page (bookView.ejs) that only displays one book from the books Collection</p>\\n<p><strong>bookRoutes.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> objectId <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>ObjectID<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Each book is assigned an ID by mongoDB - we make this ID available for our bookListView.ejs */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n\\n    bookRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">toArray</span><span class=\\\"token punctuation\\\">(</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bookListView'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n                            title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span><span class=\\\"token punctuation\\\">,</span>\\n                            nav<span class=\\\"token punctuation\\\">:</span> nav<span class=\\\"token punctuation\\\">,</span>\\n                            books<span class=\\\"token punctuation\\\">:</span> results\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    bookRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/:id'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">var</span> id <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">objectId</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>params<span class=\\\"token punctuation\\\">.</span>id<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We use the mongoDB ID (_id) for id -> URL is now /Books/:_id instead of /Books/:id */</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">findOne</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>_id<span class=\\\"token punctuation\\\">:</span> id<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* findOne returns the first book from the books collection with the same _id */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'bookView'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* result will be rendered in bookView.ejs */</span>\\n                            title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span><span class=\\\"token punctuation\\\">,</span>\\n                            nav<span class=\\\"token punctuation\\\">:</span> nav<span class=\\\"token punctuation\\\">,</span>\\n                            book<span class=\\\"token punctuation\\\">:</span> results\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                    <span class=\\\"token punctuation\\\">}</span>\\n                <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> bookRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Now we want to have a books details page (bookView.ejs) that only displays one book from the books Collection</p>\\n<p><strong>bookListView.ejs</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\">...\\n<span class=\\\"token comment\\\">&lt;!-- ################################################ Media ######################################################### --></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>section</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>container<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">margin-bottom</span><span class=\\\"token punctuation\\\">:</span> 400px<span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>row<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n        &lt;% for(var i=0; i&lt;books.length;i++){%>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-6 col-md-4 col-lg-3 center-block<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">margin-bottom</span><span class=\\\"token punctuation\\\">:</span> 10px<span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>panel panel-default<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>panel-heading<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>h4</span><span class=\\\"token punctuation\\\">></span></span>&lt;%=books[i].title%><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>h4</span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>panel-body<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-12 col-sm-4 col-lg-6<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>a</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>story-title<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">href</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>/Books/&lt;%=books[i]._id%><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>img</span> <span class=\\\"token attr-name\\\">alt</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">src</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>&lt;%=books[i].cover%><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">height</span><span class=\\\"token punctuation\\\">:</span>100px</span><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>img-thumbnail<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-12 col-sm-8 col-lg-6<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>p</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>label label-default<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>strong</span><span class=\\\"token punctuation\\\">></span></span>&lt;%=books[i].author%><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>strong</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>p</span><span class=\\\"token punctuation\\\">></span></span>\\n                            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>p</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>span</span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">font-family</span><span class=\\\"token punctuation\\\">:</span>courier,<span class=\\\"token string\\\">'new courier'</span><span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text-muted<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>a</span> <span class=\\\"token attr-name\\\">href</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>/Books/&lt;%=books[i]._id%><span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>text-muted<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>Read More<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>span</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>p</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Change URL from /Books/:i (&lt;%= i %> with i = 0,1,2,3....8) to /Books/:_id -> _id will be used to findOne --></span>\\n                        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n            &lt;%}%>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>hr</span><span class=\\\"token punctuation\\\">></span></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>section</span><span class=\\\"token punctuation\\\">></span></span>\\n...</code></pre>\\n      </div>\\n<h2 id=\\\"03-creating-a-signin-form-on-indexejs\\\"><a href=\\\"#03-creating-a-signin-form-on-indexejs\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>03 Creating a SignIn Form on Index.ejs</h2>\\n<p>Just a simple Input Form</p>\\n<p><strong>index.ejs</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-html\\\"><code class=\\\"language-html\\\">...\\n<span class=\\\"token comment\\\">&lt;!-- ################################################ Login ######################################################### --></span>\\n\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-xs-4 col-xs-offset-1<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token style-attr language-css\\\"><span class=\\\"token attr-name\\\"> <span class=\\\"token attr-name\\\">style</span></span><span class=\\\"token punctuation\\\">=\\\"</span><span class=\\\"token attr-value\\\"><span class=\\\"token property\\\">margin-top</span><span class=\\\"token punctuation\\\">:</span> 30px<span class=\\\"token punctuation\\\">;</span></span><span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>container<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>row<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span> <span class=\\\"token attr-name\\\">class</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>col-sm-offset-1 col-sm-2 col-xs-12 text-center<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>form</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>signUpForm<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">action</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>/auth/signUp<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">method</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>post<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Creating a form to post SignUp to /auth/signUp --></span>\\n                    User Name:\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>input</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>userName<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>userName<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Input userName for post --></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    Password:\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>input</span> <span class=\\\"token attr-name\\\">name</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>password<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">id</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>password<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Input password for post --></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>br</span><span class=\\\"token punctuation\\\">/></span></span>\\n                    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>input</span> <span class=\\\"token attr-name\\\">type</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>submit<span class=\\\"token punctuation\\\">\\\"</span></span> <span class=\\\"token attr-name\\\">value</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">\\\"</span>Sign Up<span class=\\\"token punctuation\\\">\\\"</span></span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- Submit post --></span>\\n                <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>form</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- /row --></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- /container --></span>\\n<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span> <span class=\\\"token comment\\\">&lt;!-- /v-center --></span>\\n\\n<span class=\\\"token comment\\\">&lt;!-- ################################################ /Login ######################################################### --></span>\\n...</code></pre>\\n      </div>\\n<h2 id=\\\"05-creating-the-authentication-route\\\"><a href=\\\"#05-creating-the-authentication-route\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>05 Creating the Authentication Route</h2>\\n<p>We need to add var bodyParser = require(‘body-parser’); to app.js. The body-parser middleware will be used in app.use(bodyParser.json()); and app.use(bodyParser.urlencoded()); to create a req.body object from JSON elements or URL parameter. Body-parser is install with npm install —save body-parser.</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Creating the Authentication Router */</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">/* Creating the SingUp route */</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We log the req.body Object created by bodyParser from the signUp post to /auth/signup */</span>\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* return authRouter to be available for app.js */</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>We now add the authRoute to app.js</p>\\n<p><strong>app.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bodyParser <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'body-parser'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">/* Install bodyParser see above */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> port <span class=\\\"token operator\\\">=</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">PORT</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> nav <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Book'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Author'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/bookRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/adminRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/authRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use the created authRouter for the Authentication routes */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use bodyParser to create req.body Object from JSON elements*/</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">urlencoded</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use bodyParser to create req.body Object from URL encoded JSON elements*/</span>\\n\\n<span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/config/passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>app<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'views'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'./src/views'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'view engine'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'ejs'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span> bookRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Admin'</span><span class=\\\"token punctuation\\\">,</span> adminRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Auth'</span><span class=\\\"token punctuation\\\">,</span> authRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Use the created authRouter for the Authentication routes */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'index'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Hello from render'</span><span class=\\\"token punctuation\\\">,</span>\\n        nav<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Authors'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/books'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Hello Books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'running server on port '</span> <span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"06-adding-passportjs-middleware\\\"><a href=\\\"#06-adding-passportjs-middleware\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>06 Adding Passport.js Middleware</h2>\\n<p>First we need to <em>npm install —save cookie-parser passport express-session</em>.</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bodyParser <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'body-parser'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> cookieParser <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'cookie-parser'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* To parse the session cookie used by passport */</span>\\n<span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* user authentication */</span>\\n<span class=\\\"token keyword\\\">var</span> session <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express-session'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* for passport-session: creates a session for the logged in user. Session stores the user information inside a cookie for the active session */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> port <span class=\\\"token operator\\\">=</span> process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">PORT</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token number\\\">5000</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> nav <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Book'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n    Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n    Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Author'</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> bookRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/bookRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> adminRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/adminRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/routes/authRoutes'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>nav<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>bodyParser<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">urlencoded</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">cookieParser</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* use cookieParser to parse the session cookie */</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">session</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>secret<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'library'</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* The session needs a secret - can be chosen freely */</span>\\n\\n<span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./src/config/passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span>app<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We separate the passport stuff src/config/passport.js - we pull in (app) to be able to app.use inside passport.js */</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'views'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'./src/views'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">set</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'view engine'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'ejs'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span> bookRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Admin'</span><span class=\\\"token punctuation\\\">,</span> adminRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/Auth'</span><span class=\\\"token punctuation\\\">,</span> authRouter<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'index'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n        title<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Hello from render'</span><span class=\\\"token punctuation\\\">,</span>\\n        nav<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Books'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Books'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>\\n            Link<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/Authors'</span><span class=\\\"token punctuation\\\">,</span>\\n            Text<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'Authors'</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/books'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Hello Books'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'running server on port '</span> <span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>Separate the passport component to <em>src/config/passport.js</em>. We need to <em>npm install —save passport-local</em> to use the local strategy of authentication (not OAuth).</p>\\n<p><strong>passport.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* pull in passport */</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function-variable function\\\">exports</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>app<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">initialize</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">session</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">serializeUser</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span> done<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Add User to Session */</span>\\n        <span class=\\\"token function\\\">done</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Callback User from Database */</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">deserializeUser</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span> done<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Remove User from Session */</span>\\n        <span class=\\\"token function\\\">done</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'./strategies/local.strategy'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* We only use a local.strategy for authentication - not passport.google, passport.facebook, etc. - Third-party OAuth. We save the file in src/config/strategies/local.strategy.js */</span>\\n\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"07-authentication-with-local-strategy\\\"><a href=\\\"#07-authentication-with-local-strategy\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>07 Authentication with Local Strategy</h2>\\n<p>Now we create the local.strategy.js as required in passport.js:</p>\\n<p><strong>local.strategy.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n    LocalStrategy <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport-local'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>Strategy<span class=\\\"token punctuation\\\">,</span>\\n    mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function-variable function\\\">exports</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">LocalStrategy</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n          usernameField<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'userName'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* take userName from input form in index.ejs when posted to /auth/signUp (bodyParser) */</span>\\n          passwordField<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'password'</span> <span class=\\\"token comment\\\">/* take password from input form in index.ejs when posted to /auth/signUp (bodyParser) */</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>username<span class=\\\"token punctuation\\\">,</span> password<span class=\\\"token punctuation\\\">,</span> done<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Pass username/password - then callBack done */</span>\\n          <span class=\\\"token keyword\\\">var</span> user <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>username<span class=\\\"token punctuation\\\">:</span> username<span class=\\\"token punctuation\\\">,</span>\\n                      password<span class=\\\"token punctuation\\\">:</span> password\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token function\\\">done</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">,</span> user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Take user and return user - authentication with mongoDB comes next */</span>\\n                  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<p>req.login and redirect to Profile</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            req<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">login</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* We do not yet save the user to mongoDB - just redirect him to /auth/profile */</span>\\n              res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/profile'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">/* we have to create the profile route */</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* When GET /profile... */</span>\\n        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* ... respond with the JSON Object user */</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"08-saving-the-user-to-mongodb\\\"><a href=\\\"#08-saving-the-user-to-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>08 Saving the User to MongoDB</h2>\\n<p>SignUp save User to MongoDB</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* connect to local install of mongoDB */</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'users'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* open users collection that is created on first signUp */</span>\\n                <span class=\\\"token keyword\\\">var</span> user <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* Creation of a user object from req.body */</span>\\n                    username<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>userName<span class=\\\"token punctuation\\\">,</span>\\n                    password<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>password\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">insert</span><span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token comment\\\">/* the user is automatically inserted into the users collection (collection is automatically created) */</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        req<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">login</span><span class=\\\"token punctuation\\\">(</span>results<span class=\\\"token punctuation\\\">.</span>ops<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* user is no longer taken from req.body but from the results ops[0] limits the result to the {username, password, _id} JSON object */</span>\\n                            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/profile'</span><span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"09-user-signin-from-mongodb\\\"><a href=\\\"#09-user-signin-from-mongodb\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>09 User SignIn from mongoDB</h2>\\n<p>Creating the SignIn Form</p>\\n<p><strong>index.ejs</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> ################################################ Login ######################################################### <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n\\n<span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"col-xs-4 col-xs-offset-1\\\"</span> style<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"margin-top: 30px;\\\"</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"container\\\"</span><span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"row\\\"</span><span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"col-sm-offset-3 col-sm-2 col-xs-12 text-center\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span>form name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"signInForm\\\"</span> action<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"/auth/signIn\\\"</span> method<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"post\\\"</span><span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> SignIN <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n                    User Name<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    Password<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input type<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"submit\\\"</span> value<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"Sign In\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>form<span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n\\n            <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"clearfix visible-xs\\\"</span> style<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"margin-bottom: 20px;\\\"</span><span class=\\\"token operator\\\">></span><span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n\\n            <span class=\\\"token operator\\\">&lt;</span>div <span class=\\\"token keyword\\\">class</span><span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"col-sm-offset-1 col-sm-2 col-xs-12 text-center\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span>form name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"signUpForm\\\"</span> action<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"/auth/signUp\\\"</span> method<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"post\\\"</span><span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> SignUp <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n                    User Name<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"userName\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    Password<span class=\\\"token punctuation\\\">:</span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input name<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span> id<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"password\\\"</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>br<span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n                    <span class=\\\"token operator\\\">&lt;</span>input type<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"submit\\\"</span> value<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">\\\"Sign Up\\\"</span><span class=\\\"token operator\\\">></span>\\n                <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>form<span class=\\\"token operator\\\">></span>\\n            <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span>\\n        <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> <span class=\\\"token operator\\\">/</span>row <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n    <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> <span class=\\\"token operator\\\">/</span>container <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">/</span>div<span class=\\\"token operator\\\">></span> <span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> <span class=\\\"token operator\\\">/</span>v<span class=\\\"token operator\\\">-</span>center <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span>\\n<span class=\\\"token operator\\\">&lt;</span><span class=\\\"token operator\\\">!</span><span class=\\\"token operator\\\">--</span> ################################################ <span class=\\\"token operator\\\">/</span>Login ######################################################### <span class=\\\"token operator\\\">--</span><span class=\\\"token operator\\\">></span></code></pre>\\n      </div>\\n<p>SignIn save User to MongoDB</p>\\n<p><strong>authRoute.js</strong></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">var</span> express <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'express'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> authRouter <span class=\\\"token operator\\\">=</span> express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">Router</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> mongodb <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'mongodb'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>MongoClient<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">var</span> passport <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'passport'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* Pull in passport for signIn */</span>\\n\\n<span class=\\\"token keyword\\\">var</span> <span class=\\\"token function-variable function\\\">router</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signUp'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token keyword\\\">var</span> url <span class=\\\"token operator\\\">=</span>\\n                <span class=\\\"token string\\\">'mongodb://localhost:27017/libraryApp'</span><span class=\\\"token punctuation\\\">;</span>\\n            mongodb<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">connect</span><span class=\\\"token punctuation\\\">(</span>url<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> db<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                <span class=\\\"token keyword\\\">var</span> collection <span class=\\\"token operator\\\">=</span> db<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">collection</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'users'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                <span class=\\\"token keyword\\\">var</span> user <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n                    username<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>userName<span class=\\\"token punctuation\\\">,</span>\\n                    password<span class=\\\"token punctuation\\\">:</span> req<span class=\\\"token punctuation\\\">.</span>body<span class=\\\"token punctuation\\\">.</span>password\\n                <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\n                collection<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">insert</span><span class=\\\"token punctuation\\\">(</span>user<span class=\\\"token punctuation\\\">,</span>\\n                    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>err<span class=\\\"token punctuation\\\">,</span> results<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                        req<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">login</span><span class=\\\"token punctuation\\\">(</span>results<span class=\\\"token punctuation\\\">.</span>ops<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n                    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/signIn'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">post</span><span class=\\\"token punctuation\\\">(</span>passport<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">authenticate</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'local'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">/* user post is authenticated with passport local strategy */</span>\\n            failureRedirect<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span> <span class=\\\"token comment\\\">/* If user did not sign up first - redirect back to home */</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/auth/profile'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">/* If successfully authenticated go to profile page */</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    authRouter<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">route</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/profile'</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">all</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n                res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">redirect</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n            <span class=\\\"token punctuation\\\">}</span>\\n            <span class=\\\"token function\\\">next</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n        <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token keyword\\\">function</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n            res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>user<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">return</span> authRouter<span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">;</span>\\n\\nmodule<span class=\\\"token punctuation\\\">.</span>exports <span class=\\\"token operator\\\">=</span> router<span class=\\\"token punctuation\\\">;</span></code></pre>\\n      </div>\\n<h2 id=\\\"10-verifying-user-in-db\\\"><a href=\\\"#10-verifying-user-in-db\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>10 Verifying User in DB</h2>\\n<p><strong>authRoute.js</strong></p>\\n<p>…</p>\\n<ul>\\n<li><a href=\\\"/node-express-mongodb-part-i/\\\">Part I</a></li>\\n<li><a href=\\\"/node-express-mongodb-part-ii/\\\">Part II</a></li>\\n<li><a href=\\\"/node-express-mongodb-part-iii/\\\">Part III</a></li>\\n<li><a href=\\\"/node-express-mongodb-part-iv/\\\">Part IV</a></li>\\n</ul>\",\"fields\":{\"slug\":\"/node-express-mongodb-part-v/\",\"prefix\":\"2016-06-09\"},\"frontmatter\":{\"title\":\"Node/Express with MongoDB (IV)\",\"subTitle\":\"Building a Express Web Library with a MongoDB Backend and Goodreads API Integration\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/photo-34607488365_9f40aafb01_o-cover-c8667551af902c842b1faf2b28f188f7-ada8c.jpg\"}}}}},\"author\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p><strong>Mike Polinowski</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\\\"/contact/\\\">contact me</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. :hearts:</p>\"},\"footnote\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>This is a personal Developer Blog</li>\\n<li>Ξ</li>\\n<li>built by <a href=\\\"https://github.com/mpolinowski\\\">Mike Polinowski</a></li>\\n<li>Ξ</li>\\n<li>with <a href=\\\"https://www.gatsbyjs.org/\\\">Gatsby</a> &#x26; <a href=\\\"https://reactjs.org\\\">React</a></li>\\n<li>Ξ</li>\\n<li>source code on <a href=\\\"https://github.com/mpolinowski/mpolinowski.github.io\\\">GitHub</a></li>\\n<li>Ξ</li>\\n<li>deliverd by <a href=\\\"https://pages.github.com\\\">Github Pages</a></li>\\n<li>Ξ</li>\\n<li>photos from <a href=\\\"https://www.flickr.com/people/149680084@N06/\\\">Flickr</a></li>\\n</ul>\"}},\"pathContext\":{\"slug\":\"/node-express-mongodb-part-v/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/node-express-mongodb-part-v.json\n// module id = 660\n// module chunks = 43217172008614"],"sourceRoot":""}