{"version":3,"sources":["webpack:///path---server-side-render-react-router-9cda896fdde1f9de3433.js","webpack:///./.cache/json/server-side-render-react-router.json"],"names":["webpackJsonp","680","module","exports","data","post","id","html","fields","slug","prefix","frontmatter","title","subTitle","cover","childImageSharp","resize","src","author","footnote","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,GAAA,wIAAAC,KAAA;AAA2h/EC,QAA8IC,KAAA,oCAAAC,OAAA,cAAiEC,aAAgBC,MAAA,+CAAAC,SAAA,wTAAAC,OAAmYC,iBAAmBC,QAAUC,IAAA,+FAAoGC,QAAWZ,GAAA,6FAAAC,KAAA,4OAAsVY,UAAab,GAAA,+FAAAC,KAAA,0jBAAgrBa,aAAgBX,KAAA","file":"path---server-side-render-react-router-9cda896fdde1f9de3433.js","sourcesContent":["webpackJsonp([123176868339148],{\n\n/***/ 680:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"post\":{\"id\":\"E:/gatsby-starter-personal-blog/content/posts/2018-01-17--server-side-render-react-router/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-72e4a.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 46.733333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACGUlEQVQozy2SX1NSURTF9z4HblwCVBgFDbyg4DiYiCYj2DRKQ4UpqJM5xoSalWFZOY30Z8aXXpse6hP02vRh6gP1sFqED2vOPXPO+e2197pirWCcisQEvlGBXBcMPxAkXwrS+4LCiWLlK/fPBMFVRWpJMbLoRzJh8DAu+F61WJ4W6KTAmeD7gKsoZxS5gsDlBZkTXG2ywI4gdSaItQTRDUFty6BYt/AODX51XLSyBtUFxY+mweptwmgkQKjYACvT2bWMIDNrYGcMHFYMV+ikTq2xAOHeniA7T1UVx2XFp3nFWsEHmyYkJbjSAxb57QsL/GFFpWjxZ38Q7fsu3FsK70Ax+pyAF4IQW/dq5j/MW1cEb3IULDjxmGPKs5tKX7pM4HjeotZ0UWr7Ub0jmGsQcqwYbivcTcKoqUPBuzOD065i47Mg/5H3XglyTwSTVL4rGHurcBYJ/NkI4HfTQWiJTlt0ca6Yfi8YIDixqYjcY2tbgr+PFGhZvL4Q2FPOrCMYekPnu9wTKid0WOL67UMU3d0QPDrxjhRxHo7wMMJ1gHNLHvXnt8O5fVlxcKNuIDWBYRDKIKXUD1Ky3HOO0rjwIX9uEeOjQSYapCIHTPYpv9uCON1E2J4waWFLboqjmCGwN68xQtKXoCmuvVAKHYvUnkFogW3c5YN1iu1GtwliWw7BwqS1yu8yQ0gQRlne11me9VLOUfxTlAX+AfQS/RQSCrItAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Angkor, Cambodia\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-48538.png\\\"\\n        srcset=\\\"/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-bed0f.png 200w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-5fd34.png 400w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-48538.png 800w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-b70ec.png 1200w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-72e4a.png 1500w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<blockquote>\\n<p>Server side rendering a React app can provide a few different benefits including performance and SEO. The problem is with those benefits comes a cost of additional complexity to your application. In this project, we’ll start from scratch and slowly build a server side rendered React 16.3 with React Router 4.</p>\\n</blockquote>\\n<!-- TOC -->\\n<ul>\\n<li><a href=\\\"#01-setup-webpack-3\\\">01 Setup Webpack 3</a></li>\\n<li><a href=\\\"#02-hello-world\\\">02 Hello World</a></li>\\n<li><a href=\\\"#03-rehydration\\\">03 Rehydration</a></li>\\n<li><a href=\\\"#04-data-fetch-api\\\">04 Data Fetch Api</a></li>\\n<li>\\n<p><a href=\\\"#05-react-router\\\">05 React Router</a></p>\\n<ul>\\n<li><a href=\\\"#server-side\\\">Server Side</a></li>\\n<li><a href=\\\"#client-side\\\">Client Side</a></li>\\n</ul>\\n</li>\\n</ul>\\n<!-- /TOC -->\\n<h2 id=\\\"01-setup-webpack-3\\\"><a href=\\\"#01-setup-webpack-3\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>01 Setup Webpack 3</h2>\\n<p>When accessing our app, we first want to be presented with a static HTML scaffold of our app, that loads immediately. This static layout will be re-hydrated by the actual react app, in form of an embedded <em>bundle.js</em> file. This file can become quite big and might take a while to download - the static HTML is going to help us bridging the load time, before react kicks into action.</p>\\n<p>This way there are two render cases that we have to handle inside webpack - on our server and inside the clients browser. To accomplish this we need to add two configs - browserConfig and serverConfig to our ./webpack.config.js file.</p>\\n<p>The following dependencies need to be <em>npm installed</em>  and required in our Webpack Config:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">var</span> path <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'path'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">var</span> webpack <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'webpack'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">var</span> nodeExternals <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'webpack-node-externals'</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>Client Side Rendering Case:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">var</span> browserConfig <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  entry<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'./src/browser/index.js'</span><span class=\\\"token punctuation\\\">,</span>\\n  output<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span>__dirname<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n    filename<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'bundle.js'</span><span class=\\\"token punctuation\\\">,</span>\\n    publicPath<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  module<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    rules<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n      test<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token regex\\\">/\\\\.(js)$/</span><span class=\\\"token punctuation\\\">,</span>\\n      use<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'babel-loader'</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  plugins<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">webpack<span class=\\\"token punctuation\\\">.</span>DefinePlugin</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n      __isBrowser__<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"true\\\"</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>Webpack is going to take a <code class=\\\"language-text\\\">./src/browser/index.js</code> file, and - with the help of Babel - bundle everything into a big / browser-readable javascript file in <code class=\\\"language-text\\\">./public</code>. Make sure to install the following Babel components for this to work:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> babel-core babel-loader babel-plugin-transform-object-rest-spread babel-preset-env babel-preset-react</code></pre>\\n      </div>\\n<p>And configure babel to use the <em>react</em> and <em>env</em> preset inside your ./package.json file:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token property\\\">\\\"babel\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token property\\\">\\\"presets\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n      <span class=\\\"token string\\\">\\\"env\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token string\\\">\\\"react\\\"</span>\\n    <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"plugins\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n      <span class=\\\"token string\\\">\\\"transform-object-rest-spread\\\"</span>\\n    <span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span></code></pre>\\n      </div>\\n<p>Server Side Rendering Case:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">var</span> serverConfig <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  entry<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'./src/server/index.js'</span><span class=\\\"token punctuation\\\">,</span>\\n  target<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'node'</span><span class=\\\"token punctuation\\\">,</span>\\n  externals<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token function\\\">nodeExternals</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  output<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> __dirname<span class=\\\"token punctuation\\\">,</span>\\n    filename<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'server.js'</span><span class=\\\"token punctuation\\\">,</span>\\n    publicPath<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  module<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    rules<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n      test<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token regex\\\">/\\\\.(js)$/</span><span class=\\\"token punctuation\\\">,</span>\\n      use<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'babel-loader'</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  plugins<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">webpack<span class=\\\"token punctuation\\\">.</span>DefinePlugin</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n      __isBrowser__<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"false\\\"</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>When <strong>isBrowser</strong> is set to false, Webpack will use the serverConfig, grabs the <code class=\\\"language-text\\\">./src/server/index.js</code>, targets <em>node</em> and babel-transpiles / bundles everything up inside <em>server.js</em> in the root directory. The <em>externals</em> line only states, that our <em>node-modules</em> are not bundled up as well.</p>\\n<h2 id=\\\"02-hello-world\\\"><a href=\\\"#02-hello-world\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>02 Hello World</h2>\\n<p>Now we need to create the files that we defined in our Webpack Config. Lets create a <code class=\\\"language-text\\\">./src</code> folder and add <code class=\\\"language-text\\\">./src/browser</code>, <code class=\\\"language-text\\\">./src/server</code> and <code class=\\\"language-text\\\">./src/shared</code>. The last one will contain code, that is shared between the server and client side rendered file.</p>\\n<p>First, lets:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> react react-dom</code></pre>\\n      </div>\\n<p>Then get started with an Hello World, add an <code class=\\\"language-text\\\">./src/shared/app.js</code> file with our primary react component:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>Component<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        Hello World\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>Inside <code class=\\\"language-text\\\">./src/server/index.js</code> we want to create an <a href=\\\"https://expressjs.com\\\">Express.js</a> webserver for our app. first <code class=\\\"language-text\\\">npm install express cors</code>, import them and create an Express App that is listening on port 3000, serving the content of our <code class=\\\"language-text\\\">./public</code>.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> express <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'express'</span>\\n<span class=\\\"token keyword\\\">import</span> cors <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'cors'</span>\\n\\n<span class=\\\"token keyword\\\">const</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token keyword\\\">const</span> port <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">3000</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">cors</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Express Server listening on port: '</span><span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>To make Express serve our Hello World component, we can use the <code class=\\\"language-text\\\">render-to-string</code> method from <code class=\\\"language-text\\\">react-dom</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token operator\\\">...</span>\\n\\n<span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> renderToString <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-dom/server'</span>\\n<span class=\\\"token keyword\\\">import</span> App <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/App'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token operator\\\">&lt;</span>App <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//Create HTML Markup from App React Component</span>\\n\\n  res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;!DOCTYPE html>\\n    &lt;html>\\n      &lt;head>\\n        &lt;title>Server Rendering with React and React Router&lt;/title>\\n        &lt;script src='/bundle.js' defer>&lt;/script>\\n      &lt;/head>\\n\\n      &lt;body>\\n        &lt;div id=\\\"app\\\"></span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>markup<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/div>\\n      &lt;/body>\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//Wrap Markup inside HTML site and send to client and link to generated bundle.js</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>To test our app, lets install <a href=\\\"https://nodemon.io\\\">Nodemon</a> (it will catch changes we make to the code and automatically restart the server, when necessary) and add a <code class=\\\"language-text\\\">npm start script</code> inside the package.json that allow us to run both npm scripts - the <code class=\\\"language-text\\\">develop script</code> that starts Webpack and the <code class=\\\"language-text\\\">watch script</code> - in parallel with our start script:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token property\\\">\\\"scripts\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token property\\\">\\\"start\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"npm run develop | npm run watch\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"develop\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"webpack --watch\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"watch\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"nodemon server.js\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"test\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"echo \\\\\\\"Error: no test specified\\\\\\\" &amp;&amp; exit 1\\\"</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span></code></pre>\\n      </div>\\n<p>A proposed alternative to piping both commands together, is using <a href=\\\"https://www.npmjs.com/package/npm-run-all\\\">npm-run-all</a> (another would have been <a href=\\\"https://www.npmjs.com/package/concurrently\\\">concurrently</a>, which has to be installed as a dev dependency:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token property\\\">\\\"scripts\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n<span class=\\\"token property\\\">\\\"start\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"npm-run-all --parallel develop watch\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token property\\\">\\\"develop\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"webpack -w\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token property\\\">\\\"watch\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"nodemon server.js\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token property\\\">\\\"test\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"echo \\\\\\\"Error: no test specified\\\\\\\" &amp;&amp; exit 1\\\"</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>We can now <code class=\\\"language-text\\\">npm start</code> both components of the app server and see our Hello World by accessing <em><a href=\\\"http://localhost:3000\\\">http://localhost:3000</a></em> with a web browser.</p>\\n<h2 id=\\\"03-rehydration\\\"><a href=\\\"#03-rehydration\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>03 Rehydration</h2>\\n<p>We now have the server-side rendered part of our app. The next step is to build the client-side part - and rehydrate the static HTML with React, once the Javascript bundle is loaded. To visualize the process, let’s add some data to our App React Component:</p>\\n<p><em>./src/shared/app.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        Hello <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>Now we can call our app with data in <code class=\\\"language-text\\\">./src/server/index.js</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\">app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token operator\\\">&lt;</span>App data<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">'World'</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>This is going to display our old <strong>Hello World</strong>. By calling the component with a data string in the client side version of our app, we will be able to see the Rehydration in process:</p>\\n<p><code class=\\\"language-text\\\">./src/browser/index.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> hydrate <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-dom'</span>\\n<span class=\\\"token keyword\\\">import</span> App <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/App'</span>\\n\\n<span class=\\\"token function\\\">hydrate</span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token operator\\\">&lt;</span>App data<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">'You'</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n  document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'app'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>This process will search for the Element ID ‘app’ inside our server-side rendered HTML and replace (rehydrate) the Element with corresponding, fully functional React Component. Since we are passing in different Data (World / You), we will be able to see, when the rehydration process succeeded - which on localhost is of course very fast:</p>\\n<p><img src=\\\"/ssrrr_01-dedd9bcd7301ed09e16d6a2145741d5e.gif\\\" alt=\\\"React Rehydration\\\"></p>\\n<p>But taking a look at your Browser Console tells you, that React is not happy about the mismatch - it expects the rendered content to be identical between the server and the client!</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-8f20b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 19.152542372881356%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAxUlEQVQY02WLS3KDMAyGuULbdAIkXWMIsSxjW4aQTO9/H22lGpou2i6++V9SlcOVrQOmnBk9cp6JiRL7afomBE5E7BB3jSkxPD04t/9tWAAOMXJFHjUAqLdWoTea7KAEo04lB+cUhkFxHNU+1V0umhB1JdLkvd6KPpal3KLOMWq1ns7yef6QuW5kaRpZ29Pu17aVe9nmupZb0wodj3u3bY/SL8Xn4q8vr+LeDoKHd3GFqjed9sb8YujNv+4vpuvUbPrDlgtfMfN4MtUiew0AAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"React Rehydration\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-8f20b.png\\\"\\n        srcset=\\\"/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-4c510.png 200w,\\n/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-25818.png 400w,\\n/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-8f20b.png 590w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>To make sure that the data is always the same on both sides, we can only hardcode (you need to <code class=\\\"language-text\\\">npm install serialize-javascript</code>) it to the server side and pass it to the window object from there:</p>\\n<p><code class=\\\"language-text\\\">./src/server/index.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token operator\\\">...</span>\\n\\n<span class=\\\"token keyword\\\">import</span> serialize <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'serialize-javascript'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> world <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'World'</span>\\n  <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>world<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n  <span class=\\\"token punctuation\\\">)</span>\\n\\n  res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;!DOCTYPE html>\\n    &lt;html>\\n      &lt;head>\\n        &lt;title>Server Rendering with React and React Router&lt;/title>\\n        &lt;script src='/bundle.js' defer>&lt;/script>\\n        &lt;script>window.__INITIAL_DATA__ = </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">serialize</span><span class=\\\"token punctuation\\\">(</span>world<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/script>\\n      &lt;/head>\\n\\n      &lt;body>\\n        &lt;div id=\\\"app\\\"></span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>markup<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/div>\\n      &lt;/body>\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p><em>./src/browser/index.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token function\\\">hydrate</span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>window<span class=\\\"token punctuation\\\">.</span>__INITIAL_DATA__<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span><span class=\\\"token punctuation\\\">,</span>\\n  document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'app'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p><img src=\\\"/ssrrr_03-87c112a19809917f93086087649e3e33.gif\\\" alt=\\\"React Rehydration\\\"></p>\\n<p>Now the server rendered version will have the hardcoded data, and the client side can pick it up from <strong>__INITIAL_DATA__</strong></p>\\n<h2 id=\\\"04-data-fetch-api\\\"><a href=\\\"#04-data-fetch-api\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>04 Data Fetch Api</h2>\\n<p>To make our app a little bit more useful, lets - instead of using hardcoded strings - fetch some Data from the <a href=\\\"https://developer.github.com/v3/\\\">Github API</a>. We create a <code class=\\\"language-text\\\">./src/shared/api.js</code> file and add the necessary fetch api AJAX request (you need to <code class=\\\"language-text\\\">npm install isomorphic-fetch</code>) to retrieve a JSON response with the most beloved repositories from different programming languages:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> fetch <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'isomorphic-fetch'</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span>language <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'all'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> encodedURI <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">encodeURI</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`https://api.github.com/search/repositories?q=stars:>1+language:</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>language<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&amp;sort=stars&amp;order=desc&amp;type=Repositories`</span></span><span class=\\\"token punctuation\\\">)</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token function\\\">fetch</span><span class=\\\"token punctuation\\\">(</span>encodedURI<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> data<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>repos<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> repos<span class=\\\"token punctuation\\\">.</span>items<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">warn</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>To add this data to our server rendered HTML, we first need to import it:</p>\\n<p><code class=\\\"language-text\\\">./src/server/index.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> fetchPopularRepos <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/api'</span></code></pre>\\n      </div>\\n<p>And then pass the data response to the render function:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\">app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;!DOCTYPE html>\\n    &lt;html>\\n      &lt;head>\\n        &lt;title>Server Rendering with React and React Router&lt;/title>\\n        &lt;script src='/bundle.js' defer>&lt;/script>\\n        &lt;script>window.__INITIAL_DATA__ = </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">serialize</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/script>\\n      &lt;/head>\\n\\n      &lt;body>\\n        &lt;div id=\\\"app\\\"></span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>markup<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/div>\\n      &lt;/body>\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>To make the API response a little bit more readable, lets create a Grid component that will be imported to our &#x3C;App/> component.</p>\\n<p><em>./shared/grid.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> Component <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Grid</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> repos <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>data\\n\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>ul</span> <span class=\\\"token attr-name\\\">style</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">{</span> display<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'flex'</span><span class=\\\"token punctuation\\\">,</span> flexWrap<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'wrap'</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token punctuation\\\">{</span>repos<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">map</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> name<span class=\\\"token punctuation\\\">,</span> owner<span class=\\\"token punctuation\\\">,</span> stargazers_count<span class=\\\"token punctuation\\\">,</span> html_url <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span> <span class=\\\"token attr-name\\\">key</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>name<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token attr-name\\\">style</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">{</span> margin<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">30</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>ul</span><span class=\\\"token punctuation\\\">></span></span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>a</span> <span class=\\\"token attr-name\\\">href</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>html_url<span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">{</span>name<span class=\\\"token punctuation\\\">}</span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span><span class=\\\"token punctuation\\\">></span></span>@<span class=\\\"token punctuation\\\">{</span>owner<span class=\\\"token punctuation\\\">.</span>login<span class=\\\"token punctuation\\\">}</span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">{</span>stargazers_count<span class=\\\"token punctuation\\\">}</span> stars<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>ul</span><span class=\\\"token punctuation\\\">></span></span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>ul</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">default</span> Grid</code></pre>\\n      </div>\\n<p>Since we already passed down the data from our API call to the &#x3C;App/> component, we can now pass it further down to our new &#x3C;Grid/> component:</p>\\n<p><em>./src/shared/app.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> Grid <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./grid'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>Grid</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>The Github API call is now populating the Grid inside our App component. Opening <em><a href=\\\"http://localhost:3000\\\">http://localhost:3000</a></em> inside your browser will show you a list of the most popular github repositories for all programming languages:</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-514ea.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 627px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 37.16108452950559%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFklEQVQoz32Qi2rDMAxF8/+/txH2SFkbJ3E71uD4LVuWZ3XLGKNMEALn2keWOqKSAXJdZqBpSiRGoBCQaiVsWbEW6mlMdL021KqU0jjSugItMhXR7pyOkYTgM6V27Qw55+kwzHYYpD0MZ2+MT8xZoJTGvh+DlGtCxMK8Vb1crtD3J/36Mtvj20d8v9gUYr0JuSthyZhSxJwT7pfY2CSEGXKMPrdiIYeN55JTLAAhN3LjnHQc/i26B//L6ItzwsLsfajPT1t6fNCgVEDu2PaHm3I0DBqMscAv5UF4f5PYyrq6/K35acL/28jeOxpH4eZ5MUptsDc2xuAkhBPtCzHmnZ/PMkq5OK017KJd2t0b4Vd+b1z6bwWfOPEgwOy3McoAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Popular Repositories on Github\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-514ea.png\\\"\\n        srcset=\\\"/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-6f745.png 200w,\\n/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-e47ce.png 400w,\\n/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-514ea.png 627w\\\"\\n        sizes=\\\"(max-width: 627px) 100vw, 627px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2 id=\\\"05-react-router\\\"><a href=\\\"#05-react-router\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>05 React Router</h2>\\n<h3 id=\\\"server-side\\\"><a href=\\\"#server-side\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Server Side</h3>\\n<p>Now we want to add some routes to our app, using <a href=\\\"https://github.com/ReactTraining/react-router\\\">React Router</a>. We will have to use a shared route config for server and client side navigation. We will add this central route configuration file in <code class=\\\"language-text\\\">./src/shared/routes.js</code> :</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> Home <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./home'</span>\\n<span class=\\\"token keyword\\\">import</span> Grid <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./grid'</span>\\n\\n<span class=\\\"token keyword\\\">const</span> routes <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span>\\n  <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span>\\n    exact<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'true'</span><span class=\\\"token punctuation\\\">,</span>\\n    component<span class=\\\"token punctuation\\\">:</span> Home<span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/popular/:id'</span><span class=\\\"token punctuation\\\">,</span>\\n    component<span class=\\\"token punctuation\\\">:</span> Grid<span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">]</span></code></pre>\\n      </div>\\n<p>The App will have 2 available routes - the root page and the page that will render the Github API response. Lets quickly add a scaffolding for the &#x3C;Home /> component, that will later let you choose the language, you want to see popular repositories for:</p>\\n<p><code class=\\\"language-text\\\">./src/shared/home.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">default</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">Home</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n      Select a language\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>To enable our server to pre-render each page, we have to add every data request that a route needs into the central route object <code class=\\\"language-text\\\">./src/shared/routes.js</code> :</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> fetchPopularRepos <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./api'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\n<span class=\\\"token punctuation\\\">{</span>\\n  path<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/popular/:id'</span><span class=\\\"token punctuation\\\">,</span>\\n  component<span class=\\\"token punctuation\\\">:</span> Grid<span class=\\\"token punctuation\\\">,</span>\\n  fetchInitialData<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">(</span>path <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span>path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">split</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pop</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>The user will be able to choose the programming language he is interested in inside the &#x3C;Home /> component and will navigate to the specific route <code class=\\\"language-text\\\">/popular/${language}</code>. The initialData for the server rendered page will be take from the Github API call with the chosen language from the URL path.</p>\\n<p>Now we need to make the <code class=\\\"language-text\\\">./src/server/index.js</code> aware what route the user chose, so that correct content will be pre-rendered. We can do this with the <strong>matchPath</strong> method, provided by react-router-dom:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> matchPath <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n<span class=\\\"token keyword\\\">import</span> routes <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/routes'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">//when app receives a GET request...</span>\\n  <span class=\\\"token keyword\\\">const</span> activeRoute <span class=\\\"token operator\\\">=</span> routes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>route<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token function\\\">matchPath</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>url<span class=\\\"token punctuation\\\">,</span> route<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span> <span class=\\\"token comment\\\">//find out what route matches the requested URL...</span>\\n\\n  <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token operator\\\">...</span></code></pre>\\n      </div>\\n<p>To find the active route, compare the requested URL with the route Object (imported from <code class=\\\"language-text\\\">./src/shared/routes/</code>), if no match is found, set the active route to an empty object.</p>\\n<p>We can now handle the fetching of Initial data with a promise and remove the <em>fetchPopularRepos</em> API call (as it is now handled inside the central route object):</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token comment\\\">// import { fetchPopularRepos } from '../shared/api' //REMOVE</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">//when app receives a GET request...</span>\\n  <span class=\\\"token keyword\\\">const</span> activeRoute <span class=\\\"token operator\\\">=</span> routes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>route<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token function\\\">matchPath</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>url<span class=\\\"token punctuation\\\">,</span> route<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span> <span class=\\\"token comment\\\">//find out what route matches the requested URL...</span>\\n\\n  <span class=\\\"token keyword\\\">const</span> promise <span class=\\\"token operator\\\">=</span> activeRoute<span class=\\\"token punctuation\\\">.</span>fetchInitialData <span class=\\\"token comment\\\">//find out if the route needs to fetch data</span>\\n    <span class=\\\"token operator\\\">?</span> activeRoute<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">fetchInitialData</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>path<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//if so, fetch the data for the active route</span>\\n    <span class=\\\"token punctuation\\\">:</span> Promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//if no data is needed (home route), just resolve</span>\\n\\n    promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">//when everything is fetched, render the app markup with the with {data}</span>\\n      <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n      <span class=\\\"token punctuation\\\">)</span>\\n\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;html>\\n    ...\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//and send the static HTML page to client</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span>next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//if there are any errors, move on to the next request</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token operator\\\">...</span></code></pre>\\n      </div>\\n<p>You can test the routing by opening a valid URL that follows our requirement <code class=\\\"language-text\\\">path:&#39;/popular/:id&#39;</code>, e.g. <em><a href=\\\"http://localhost:3000/popular/javascript\\\">http://localhost:3000/popular/javascript</a></em></p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-13b29.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 621px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 64.573268921095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABnUlEQVQoz5VS2Y6jMBDM/3/aPIxENNocwICTYALhcDh9M0VsJqt925YlykW3XdXt3bIs1trlHdaYRWu/AX79BLny/yTvsNFa5bk8n+fTaWRsejy6ILg2TSWliKIyzyscwthASGGtQXrbKiQzpnfujCgix2OSZdXz2Q9Dd7mkSinw1yupqgfAPM9pmmwk/foKOVe+uOuYEHyTCi1mw3rTCdmeHMcBy8s2a6ze8Pm1BAznWC/SSOkTsMP1LmsttlYdDuJy4cYIIXSWyaKQqKWU7fc3KSWaEgSUUpjXjKmPj7koxFrs7onj7HwmnMMa3++jJLmDrOuK0pvrMCFJ33fAjPVBEFFag/bFdf0Yxx4ALSlLimuBpVSuQwhIcp7neaqq4j2qvz07S86zn7t9t8olCOEfgivWcdxmGUPmMPAgKIuCGaPG0dzvdp41EqI/hDWQbZtGHw66aczbMyFpnucA0zSF4WkY1kncbuXnZ4znARyGIWPsZZB9fxO0Axp2myXpZgtVnPuBP58tllMO0k2xbZs0Tb3n5T9Da43hOfwDr3Tv00B/cxUAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Popular Javascript Repositories on Github\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-13b29.png\\\"\\n        srcset=\\\"/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-97e0b.png 200w,\\n/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-de510.png 400w,\\n/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-13b29.png 621w\\\"\\n        sizes=\\\"(max-width: 621px) 100vw, 621px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>The Router matches the URL, fetches the corresponding data from the Github API and provides it to the Grid component that is rendered and send to the client.</p>\\n<h3 id=\\\"client-side\\\"><a href=\\\"#client-side\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Client Side</h3>\\n<p>Now we have to add the client side routing. First, we wrap the &#x3C;App /> component <code class=\\\"language-text\\\">./src/browser/index.js</code> inside a &#x3C;BrowserRouter />:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> hydrate <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-dom'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> BrowserRouter <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n\\n<span class=\\\"token keyword\\\">import</span> App <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/App'</span>\\n\\n<span class=\\\"token function\\\">hydrate</span><span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>BrowserRouter</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>window<span class=\\\"token punctuation\\\">.</span>__INITIAL_DATA__<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>BrowserRouter</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">,</span>\\n  document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'app'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>And use the &#x3C;StaticRouter /> for the server side render:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> matchPath<span class=\\\"token punctuation\\\">,</span> StaticRouter <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\npromise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>StaticRouter</span> <span class=\\\"token attr-name\\\">location</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">'</span>req.url<span class=\\\"token punctuation\\\">'</span></span> <span class=\\\"token attr-name\\\">context</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>StaticRouter</span><span class=\\\"token punctuation\\\">></span></span>\\n      <span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>The &#x3C;App /> component in <code class=\\\"language-text\\\">./src/shared/app.js</code> now no longer needs to render the &#x3C;Grid /> but will receive </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> Component <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> routes <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./routes'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> Route <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token punctuation\\\">{</span>routes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">map</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> path<span class=\\\"token punctuation\\\">,</span> exact<span class=\\\"token punctuation\\\">,</span> component<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">C</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token operator\\\">...</span>rest <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>Route</span>\\n            <span class=\\\"token attr-name\\\">key</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>path<span class=\\\"token punctuation\\\">}</span></span>\\n            <span class=\\\"token attr-name\\\">path</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>path<span class=\\\"token punctuation\\\">}</span></span>\\n            <span class=\\\"token attr-name\\\">exact</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>exact<span class=\\\"token punctuation\\\">}</span></span>\\n            <span class=\\\"token attr-name\\\">render</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span>props<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>C</span> <span class=\\\"token spread\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">...</span><span class=\\\"token attr-value\\\">props</span><span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token spread\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">...</span><span class=\\\"token attr-value\\\">rest</span><span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n            <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span></span>\\n          <span class=\\\"token punctuation\\\">/></span></span>\\n        <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">default</span> App</code></pre>\\n      </div>\",\"fields\":{\"slug\":\"/server-side-render-react-router/\",\"prefix\":\"2018-01-17\"},\"frontmatter\":{\"title\":\"Server Rendering with React and React Router\",\"subTitle\":\"Server side rendering a React app can provide a few different benefits including performance and SEO. The problem is with those benefits comes a cost of additional complexity to your application. In this project, we'll start from scratch and slowly build a server side rendered React 16.3 with React Router 4.\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/photo-11627973773_7295195845_o-cover-7ddc1901cf1384438745069bddfdb4e7-160fa.png\"}}}}},\"author\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p><strong>Mike Polinowski</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\\\"/contact/\\\">contact me</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. :hearts:</p>\"},\"footnote\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>This is a personal Developer Blog</li>\\n<li>Ξ</li>\\n<li>built by <a href=\\\"https://github.com/mpolinowski\\\">Mike Polinowski</a></li>\\n<li>Ξ</li>\\n<li>with <a href=\\\"https://www.gatsbyjs.org/\\\">Gatsby</a> &#x26; <a href=\\\"https://reactjs.org\\\">React</a></li>\\n<li>Ξ</li>\\n<li>source code on <a href=\\\"https://github.com/mpolinowski/mpolinowski.github.io\\\">GitHub</a></li>\\n<li>Ξ</li>\\n<li>deliverd by <a href=\\\"https://pages.github.com\\\">Github Pages</a></li>\\n<li>Ξ</li>\\n<li>photos from <a href=\\\"https://www.flickr.com/people/149680084@N06/\\\">Flickr</a></li>\\n</ul>\"}},\"pathContext\":{\"slug\":\"/server-side-render-react-router/\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---server-side-render-react-router-9cda896fdde1f9de3433.js","module.exports = {\"data\":{\"post\":{\"id\":\"E:/gatsby-starter-personal-blog/content/posts/2018-01-17--server-side-render-react-router/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-72e4a.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 46.733333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACGUlEQVQozy2SX1NSURTF9z4HblwCVBgFDbyg4DiYiCYj2DRKQ4UpqJM5xoSalWFZOY30Z8aXXpse6hP02vRh6gP1sFqED2vOPXPO+e2197pirWCcisQEvlGBXBcMPxAkXwrS+4LCiWLlK/fPBMFVRWpJMbLoRzJh8DAu+F61WJ4W6KTAmeD7gKsoZxS5gsDlBZkTXG2ywI4gdSaItQTRDUFty6BYt/AODX51XLSyBtUFxY+mweptwmgkQKjYACvT2bWMIDNrYGcMHFYMV+ikTq2xAOHeniA7T1UVx2XFp3nFWsEHmyYkJbjSAxb57QsL/GFFpWjxZ38Q7fsu3FsK70Ax+pyAF4IQW/dq5j/MW1cEb3IULDjxmGPKs5tKX7pM4HjeotZ0UWr7Ub0jmGsQcqwYbivcTcKoqUPBuzOD065i47Mg/5H3XglyTwSTVL4rGHurcBYJ/NkI4HfTQWiJTlt0ca6Yfi8YIDixqYjcY2tbgr+PFGhZvL4Q2FPOrCMYekPnu9wTKid0WOL67UMU3d0QPDrxjhRxHo7wMMJ1gHNLHvXnt8O5fVlxcKNuIDWBYRDKIKXUD1Ky3HOO0rjwIX9uEeOjQSYapCIHTPYpv9uCON1E2J4waWFLboqjmCGwN68xQtKXoCmuvVAKHYvUnkFogW3c5YN1iu1GtwliWw7BwqS1yu8yQ0gQRlne11me9VLOUfxTlAX+AfQS/RQSCrItAAAAAElFTkSuQmCC'); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Angkor, Cambodia\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-48538.png\\\"\\n        srcset=\\\"/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-bed0f.png 200w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-5fd34.png 400w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-48538.png 800w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-b70ec.png 1200w,\\n/static/photo-11627973773_7295195845_o-b44cd2b6b49002ffcfaef01179bb583c-72e4a.png 1500w\\\"\\n        sizes=\\\"(max-width: 800px) 100vw, 800px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<blockquote>\\n<p>Server side rendering a React app can provide a few different benefits including performance and SEO. The problem is with those benefits comes a cost of additional complexity to your application. In this project, we’ll start from scratch and slowly build a server side rendered React 16.3 with React Router 4.</p>\\n</blockquote>\\n<!-- TOC -->\\n<ul>\\n<li><a href=\\\"#01-setup-webpack-3\\\">01 Setup Webpack 3</a></li>\\n<li><a href=\\\"#02-hello-world\\\">02 Hello World</a></li>\\n<li><a href=\\\"#03-rehydration\\\">03 Rehydration</a></li>\\n<li><a href=\\\"#04-data-fetch-api\\\">04 Data Fetch Api</a></li>\\n<li>\\n<p><a href=\\\"#05-react-router\\\">05 React Router</a></p>\\n<ul>\\n<li><a href=\\\"#server-side\\\">Server Side</a></li>\\n<li><a href=\\\"#client-side\\\">Client Side</a></li>\\n</ul>\\n</li>\\n</ul>\\n<!-- /TOC -->\\n<h2 id=\\\"01-setup-webpack-3\\\"><a href=\\\"#01-setup-webpack-3\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>01 Setup Webpack 3</h2>\\n<p>When accessing our app, we first want to be presented with a static HTML scaffold of our app, that loads immediately. This static layout will be re-hydrated by the actual react app, in form of an embedded <em>bundle.js</em> file. This file can become quite big and might take a while to download - the static HTML is going to help us bridging the load time, before react kicks into action.</p>\\n<p>This way there are two render cases that we have to handle inside webpack - on our server and inside the clients browser. To accomplish this we need to add two configs - browserConfig and serverConfig to our ./webpack.config.js file.</p>\\n<p>The following dependencies need to be <em>npm installed</em>  and required in our Webpack Config:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">var</span> path <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'path'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">var</span> webpack <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'webpack'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token keyword\\\">var</span> nodeExternals <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">require</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'webpack-node-externals'</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>Client Side Rendering Case:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">var</span> browserConfig <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  entry<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'./src/browser/index.js'</span><span class=\\\"token punctuation\\\">,</span>\\n  output<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span>__dirname<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">,</span>\\n    filename<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'bundle.js'</span><span class=\\\"token punctuation\\\">,</span>\\n    publicPath<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  module<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    rules<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n      test<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token regex\\\">/\\\\.(js)$/</span><span class=\\\"token punctuation\\\">,</span>\\n      use<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'babel-loader'</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  plugins<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">webpack<span class=\\\"token punctuation\\\">.</span>DefinePlugin</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n      __isBrowser__<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"true\\\"</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>Webpack is going to take a <code class=\\\"language-text\\\">./src/browser/index.js</code> file, and - with the help of Babel - bundle everything into a big / browser-readable javascript file in <code class=\\\"language-text\\\">./public</code>. Make sure to install the following Babel components for this to work:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> babel-core babel-loader babel-plugin-transform-object-rest-spread babel-preset-env babel-preset-react</code></pre>\\n      </div>\\n<p>And configure babel to use the <em>react</em> and <em>env</em> preset inside your ./package.json file:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token property\\\">\\\"babel\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token property\\\">\\\"presets\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n      <span class=\\\"token string\\\">\\\"env\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n      <span class=\\\"token string\\\">\\\"react\\\"</span>\\n    <span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"plugins\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n      <span class=\\\"token string\\\">\\\"transform-object-rest-spread\\\"</span>\\n    <span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span></code></pre>\\n      </div>\\n<p>Server Side Rendering Case:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">var</span> serverConfig <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">{</span>\\n  entry<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'./src/server/index.js'</span><span class=\\\"token punctuation\\\">,</span>\\n  target<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'node'</span><span class=\\\"token punctuation\\\">,</span>\\n  externals<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token function\\\">nodeExternals</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span>\\n  output<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> __dirname<span class=\\\"token punctuation\\\">,</span>\\n    filename<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'server.js'</span><span class=\\\"token punctuation\\\">,</span>\\n    publicPath<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  module<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    rules<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">{</span>\\n      test<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token regex\\\">/\\\\.(js)$/</span><span class=\\\"token punctuation\\\">,</span>\\n      use<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'babel-loader'</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">]</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  plugins<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span>\\n    <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">webpack<span class=\\\"token punctuation\\\">.</span>DefinePlugin</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span>\\n      __isBrowser__<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"false\\\"</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">]</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>When <strong>isBrowser</strong> is set to false, Webpack will use the serverConfig, grabs the <code class=\\\"language-text\\\">./src/server/index.js</code>, targets <em>node</em> and babel-transpiles / bundles everything up inside <em>server.js</em> in the root directory. The <em>externals</em> line only states, that our <em>node-modules</em> are not bundled up as well.</p>\\n<h2 id=\\\"02-hello-world\\\"><a href=\\\"#02-hello-world\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>02 Hello World</h2>\\n<p>Now we need to create the files that we defined in our Webpack Config. Lets create a <code class=\\\"language-text\\\">./src</code> folder and add <code class=\\\"language-text\\\">./src/browser</code>, <code class=\\\"language-text\\\">./src/server</code> and <code class=\\\"language-text\\\">./src/shared</code>. The last one will contain code, that is shared between the server and client side rendered file.</p>\\n<p>First, lets:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-bash\\\"><code class=\\\"language-bash\\\"><span class=\\\"token function\\\">npm</span> <span class=\\\"token function\\\">install</span> react react-dom</code></pre>\\n      </div>\\n<p>Then get started with an Hello World, add an <code class=\\\"language-text\\\">./src/shared/app.js</code> file with our primary react component:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span>Component<span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        Hello World\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>Inside <code class=\\\"language-text\\\">./src/server/index.js</code> we want to create an <a href=\\\"https://expressjs.com\\\">Express.js</a> webserver for our app. first <code class=\\\"language-text\\\">npm install express cors</code>, import them and create an Express App that is listening on port 3000, serving the content of our <code class=\\\"language-text\\\">./public</code>.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> express <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'express'</span>\\n<span class=\\\"token keyword\\\">import</span> cors <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'cors'</span>\\n\\n<span class=\\\"token keyword\\\">const</span> app <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">express</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token keyword\\\">const</span> port <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">3000</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token function\\\">cors</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">use</span><span class=\\\"token punctuation\\\">(</span>express<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">static</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'public'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">listen</span><span class=\\\"token punctuation\\\">(</span>port<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">log</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'Express Server listening on port: '</span><span class=\\\"token operator\\\">+</span> port<span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>To make Express serve our Hello World component, we can use the <code class=\\\"language-text\\\">render-to-string</code> method from <code class=\\\"language-text\\\">react-dom</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token operator\\\">...</span>\\n\\n<span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> renderToString <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-dom/server'</span>\\n<span class=\\\"token keyword\\\">import</span> App <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/App'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token operator\\\">&lt;</span>App <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//Create HTML Markup from App React Component</span>\\n\\n  res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;!DOCTYPE html>\\n    &lt;html>\\n      &lt;head>\\n        &lt;title>Server Rendering with React and React Router&lt;/title>\\n        &lt;script src='/bundle.js' defer>&lt;/script>\\n      &lt;/head>\\n\\n      &lt;body>\\n        &lt;div id=\\\"app\\\"></span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>markup<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/div>\\n      &lt;/body>\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//Wrap Markup inside HTML site and send to client and link to generated bundle.js</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>To test our app, lets install <a href=\\\"https://nodemon.io\\\">Nodemon</a> (it will catch changes we make to the code and automatically restart the server, when necessary) and add a <code class=\\\"language-text\\\">npm start script</code> inside the package.json that allow us to run both npm scripts - the <code class=\\\"language-text\\\">develop script</code> that starts Webpack and the <code class=\\\"language-text\\\">watch script</code> - in parallel with our start script:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token property\\\">\\\"scripts\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token property\\\">\\\"start\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"npm run develop | npm run watch\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"develop\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"webpack --watch\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"watch\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"nodemon server.js\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n    <span class=\\\"token property\\\">\\\"test\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"echo \\\\\\\"Error: no test specified\\\\\\\" &amp;&amp; exit 1\\\"</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span></code></pre>\\n      </div>\\n<p>A proposed alternative to piping both commands together, is using <a href=\\\"https://www.npmjs.com/package/npm-run-all\\\">npm-run-all</a> (another would have been <a href=\\\"https://www.npmjs.com/package/concurrently\\\">concurrently</a>, which has to be installed as a dev dependency:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-json\\\"><code class=\\\"language-json\\\"><span class=\\\"token property\\\">\\\"scripts\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token punctuation\\\">{</span>\\n<span class=\\\"token property\\\">\\\"start\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"npm-run-all --parallel develop watch\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token property\\\">\\\"develop\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"webpack -w\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token property\\\">\\\"watch\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"nodemon server.js\\\"</span><span class=\\\"token punctuation\\\">,</span>\\n<span class=\\\"token property\\\">\\\"test\\\"</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token string\\\">\\\"echo \\\\\\\"Error: no test specified\\\\\\\" &amp;&amp; exit 1\\\"</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>We can now <code class=\\\"language-text\\\">npm start</code> both components of the app server and see our Hello World by accessing <em><a href=\\\"http://localhost:3000\\\">http://localhost:3000</a></em> with a web browser.</p>\\n<h2 id=\\\"03-rehydration\\\"><a href=\\\"#03-rehydration\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>03 Rehydration</h2>\\n<p>We now have the server-side rendered part of our app. The next step is to build the client-side part - and rehydrate the static HTML with React, once the Javascript bundle is loaded. To visualize the process, let’s add some data to our App React Component:</p>\\n<p><em>./src/shared/app.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        Hello <span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>Now we can call our app with data in <code class=\\\"language-text\\\">./src/server/index.js</code>:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\">app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token operator\\\">&lt;</span>App data<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">'World'</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span>\\n  <span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>This is going to display our old <strong>Hello World</strong>. By calling the component with a data string in the client side version of our app, we will be able to see the Rehydration in process:</p>\\n<p><code class=\\\"language-text\\\">./src/browser/index.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> hydrate <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-dom'</span>\\n<span class=\\\"token keyword\\\">import</span> App <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/App'</span>\\n\\n<span class=\\\"token function\\\">hydrate</span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token operator\\\">&lt;</span>App data<span class=\\\"token operator\\\">=</span><span class=\\\"token string\\\">'You'</span> <span class=\\\"token operator\\\">/</span><span class=\\\"token operator\\\">></span><span class=\\\"token punctuation\\\">,</span>\\n  document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'app'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>This process will search for the Element ID ‘app’ inside our server-side rendered HTML and replace (rehydrate) the Element with corresponding, fully functional React Component. Since we are passing in different Data (World / You), we will be able to see, when the rehydration process succeeded - which on localhost is of course very fast:</p>\\n<p><img src=\\\"/ssrrr_01-dedd9bcd7301ed09e16d6a2145741d5e.gif\\\" alt=\\\"React Rehydration\\\"></p>\\n<p>But taking a look at your Browser Console tells you, that React is not happy about the mismatch - it expects the rendered content to be identical between the server and the client!</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-8f20b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 590px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 19.152542372881356%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAxUlEQVQY02WLS3KDMAyGuULbdAIkXWMIsSxjW4aQTO9/H22lGpou2i6++V9SlcOVrQOmnBk9cp6JiRL7afomBE5E7BB3jSkxPD04t/9tWAAOMXJFHjUAqLdWoTea7KAEo04lB+cUhkFxHNU+1V0umhB1JdLkvd6KPpal3KLOMWq1ns7yef6QuW5kaRpZ29Pu17aVe9nmupZb0wodj3u3bY/SL8Xn4q8vr+LeDoKHd3GFqjed9sb8YujNv+4vpuvUbPrDlgtfMfN4MtUiew0AAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"React Rehydration\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-8f20b.png\\\"\\n        srcset=\\\"/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-4c510.png 200w,\\n/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-25818.png 400w,\\n/static/ssrrr_02-ab8dd633238e44f850f9f7dca56f52cd-8f20b.png 590w\\\"\\n        sizes=\\\"(max-width: 590px) 100vw, 590px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>To make sure that the data is always the same on both sides, we can only hardcode (you need to <code class=\\\"language-text\\\">npm install serialize-javascript</code>) it to the server side and pass it to the window object from there:</p>\\n<p><code class=\\\"language-text\\\">./src/server/index.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token operator\\\">...</span>\\n\\n<span class=\\\"token keyword\\\">import</span> serialize <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'serialize-javascript'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> world <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'World'</span>\\n  <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>world<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n  <span class=\\\"token punctuation\\\">)</span>\\n\\n  res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;!DOCTYPE html>\\n    &lt;html>\\n      &lt;head>\\n        &lt;title>Server Rendering with React and React Router&lt;/title>\\n        &lt;script src='/bundle.js' defer>&lt;/script>\\n        &lt;script>window.__INITIAL_DATA__ = </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">serialize</span><span class=\\\"token punctuation\\\">(</span>world<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/script>\\n      &lt;/head>\\n\\n      &lt;body>\\n        &lt;div id=\\\"app\\\"></span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>markup<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/div>\\n      &lt;/body>\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p><em>./src/browser/index.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token function\\\">hydrate</span> <span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>window<span class=\\\"token punctuation\\\">.</span>__INITIAL_DATA__<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span><span class=\\\"token punctuation\\\">,</span>\\n  document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'app'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p><img src=\\\"/ssrrr_03-87c112a19809917f93086087649e3e33.gif\\\" alt=\\\"React Rehydration\\\"></p>\\n<p>Now the server rendered version will have the hardcoded data, and the client side can pick it up from <strong>__INITIAL_DATA__</strong></p>\\n<h2 id=\\\"04-data-fetch-api\\\"><a href=\\\"#04-data-fetch-api\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>04 Data Fetch Api</h2>\\n<p>To make our app a little bit more useful, lets - instead of using hardcoded strings - fetch some Data from the <a href=\\\"https://developer.github.com/v3/\\\">Github API</a>. We create a <code class=\\\"language-text\\\">./src/shared/api.js</code> file and add the necessary fetch api AJAX request (you need to <code class=\\\"language-text\\\">npm install isomorphic-fetch</code>) to retrieve a JSON response with the most beloved repositories from different programming languages:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> fetch <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'isomorphic-fetch'</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span>language <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'all'</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">const</span> encodedURI <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">encodeURI</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`https://api.github.com/search/repositories?q=stars:>1+language:</span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>language<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&amp;sort=stars&amp;order=desc&amp;type=Repositories`</span></span><span class=\\\"token punctuation\\\">)</span>\\n\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token function\\\">fetch</span><span class=\\\"token punctuation\\\">(</span>encodedURI<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> data<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">json</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>repos<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> repos<span class=\\\"token punctuation\\\">.</span>items<span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      console<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">warn</span><span class=\\\"token punctuation\\\">(</span>error<span class=\\\"token punctuation\\\">)</span>\\n      <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span>\\n    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>To add this data to our server rendered HTML, we first need to import it:</p>\\n<p><code class=\\\"language-text\\\">./src/server/index.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> fetchPopularRepos <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/api'</span></code></pre>\\n      </div>\\n<p>And then pass the data response to the render function:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\">app<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;!DOCTYPE html>\\n    &lt;html>\\n      &lt;head>\\n        &lt;title>Server Rendering with React and React Router&lt;/title>\\n        &lt;script src='/bundle.js' defer>&lt;/script>\\n        &lt;script>window.__INITIAL_DATA__ = </span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span><span class=\\\"token function\\\">serialize</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span><span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/script>\\n      &lt;/head>\\n\\n      &lt;body>\\n        &lt;div id=\\\"app\\\"></span><span class=\\\"token interpolation\\\"><span class=\\\"token interpolation-punctuation punctuation\\\">${</span>markup<span class=\\\"token interpolation-punctuation punctuation\\\">}</span></span><span class=\\\"token string\\\">&lt;/div>\\n      &lt;/body>\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>To make the API response a little bit more readable, lets create a Grid component that will be imported to our &#x3C;App/> component.</p>\\n<p><em>./shared/grid.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> Component <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Grid</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> repos <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>data\\n\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>ul</span> <span class=\\\"token attr-name\\\">style</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">{</span> display<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'flex'</span><span class=\\\"token punctuation\\\">,</span> flexWrap<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'wrap'</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token punctuation\\\">{</span>repos<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">map</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> name<span class=\\\"token punctuation\\\">,</span> owner<span class=\\\"token punctuation\\\">,</span> stargazers_count<span class=\\\"token punctuation\\\">,</span> html_url <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span> <span class=\\\"token attr-name\\\">key</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>name<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token attr-name\\\">style</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">{</span> margin<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">30</span> <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>ul</span><span class=\\\"token punctuation\\\">></span></span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>a</span> <span class=\\\"token attr-name\\\">href</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>html_url<span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">{</span>name<span class=\\\"token punctuation\\\">}</span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>a</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span><span class=\\\"token punctuation\\\">></span></span>@<span class=\\\"token punctuation\\\">{</span>owner<span class=\\\"token punctuation\\\">.</span>login<span class=\\\"token punctuation\\\">}</span><span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>li</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">{</span>stargazers_count<span class=\\\"token punctuation\\\">}</span> stars<span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n            <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>ul</span><span class=\\\"token punctuation\\\">></span></span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>li</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>ul</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">default</span> Grid</code></pre>\\n      </div>\\n<p>Since we already passed down the data from our API call to the &#x3C;App/> component, we can now pass it further down to our new &#x3C;Grid/> component:</p>\\n<p><em>./src/shared/app.js</em></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> Grid <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./grid'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>Grid</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>props<span class=\\\"token punctuation\\\">.</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>The Github API call is now populating the Grid inside our App component. Opening <em><a href=\\\"http://localhost:3000\\\">http://localhost:3000</a></em> inside your browser will show you a list of the most popular github repositories for all programming languages:</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-514ea.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 627px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 37.16108452950559%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFklEQVQoz32Qi2rDMAxF8/+/txH2SFkbJ3E71uD4LVuWZ3XLGKNMEALn2keWOqKSAXJdZqBpSiRGoBCQaiVsWbEW6mlMdL021KqU0jjSugItMhXR7pyOkYTgM6V27Qw55+kwzHYYpD0MZ2+MT8xZoJTGvh+DlGtCxMK8Vb1crtD3J/36Mtvj20d8v9gUYr0JuSthyZhSxJwT7pfY2CSEGXKMPrdiIYeN55JTLAAhN3LjnHQc/i26B//L6ItzwsLsfajPT1t6fNCgVEDu2PaHm3I0DBqMscAv5UF4f5PYyrq6/K35acL/28jeOxpH4eZ5MUptsDc2xuAkhBPtCzHmnZ/PMkq5OK017KJd2t0b4Vd+b1z6bwWfOPEgwOy3McoAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Popular Repositories on Github\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-514ea.png\\\"\\n        srcset=\\\"/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-6f745.png 200w,\\n/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-e47ce.png 400w,\\n/static/ssrrr_04-1e58efd3b97fe81d19d747e06f771b25-514ea.png 627w\\\"\\n        sizes=\\\"(max-width: 627px) 100vw, 627px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<h2 id=\\\"05-react-router\\\"><a href=\\\"#05-react-router\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>05 React Router</h2>\\n<h3 id=\\\"server-side\\\"><a href=\\\"#server-side\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Server Side</h3>\\n<p>Now we want to add some routes to our app, using <a href=\\\"https://github.com/ReactTraining/react-router\\\">React Router</a>. We will have to use a shared route config for server and client side navigation. We will add this central route configuration file in <code class=\\\"language-text\\\">./src/shared/routes.js</code> :</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> Home <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./home'</span>\\n<span class=\\\"token keyword\\\">import</span> Grid <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./grid'</span>\\n\\n<span class=\\\"token keyword\\\">const</span> routes <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span>\\n  <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">,</span>\\n    exact<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'true'</span><span class=\\\"token punctuation\\\">,</span>\\n    component<span class=\\\"token punctuation\\\">:</span> Home<span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">{</span>\\n    path<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/popular/:id'</span><span class=\\\"token punctuation\\\">,</span>\\n    component<span class=\\\"token punctuation\\\">:</span> Grid<span class=\\\"token punctuation\\\">,</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">]</span></code></pre>\\n      </div>\\n<p>The App will have 2 available routes - the root page and the page that will render the Github API response. Lets quickly add a scaffolding for the &#x3C;Home /> component, that will later let you choose the language, you want to see popular repositories for:</p>\\n<p><code class=\\\"language-text\\\">./src/shared/home.js</code></p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">default</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">Home</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n      Select a language\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n  <span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>To enable our server to pre-render each page, we have to add every data request that a route needs into the central route object <code class=\\\"language-text\\\">./src/shared/routes.js</code> :</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> fetchPopularRepos <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./api'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\n<span class=\\\"token punctuation\\\">{</span>\\n  path<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">'/popular/:id'</span><span class=\\\"token punctuation\\\">,</span>\\n  component<span class=\\\"token punctuation\\\">:</span> Grid<span class=\\\"token punctuation\\\">,</span>\\n  fetchInitialData<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">(</span>path <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">''</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span>path<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">split</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'/'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">pop</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>The user will be able to choose the programming language he is interested in inside the &#x3C;Home /> component and will navigate to the specific route <code class=\\\"language-text\\\">/popular/${language}</code>. The initialData for the server rendered page will be take from the Github API call with the chosen language from the URL path.</p>\\n<p>Now we need to make the <code class=\\\"language-text\\\">./src/server/index.js</code> aware what route the user chose, so that correct content will be pre-rendered. We can do this with the <strong>matchPath</strong> method, provided by react-router-dom:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> matchPath <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n<span class=\\\"token keyword\\\">import</span> routes <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/routes'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">//when app receives a GET request...</span>\\n  <span class=\\\"token keyword\\\">const</span> activeRoute <span class=\\\"token operator\\\">=</span> routes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>route<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token function\\\">matchPath</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>url<span class=\\\"token punctuation\\\">,</span> route<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span> <span class=\\\"token comment\\\">//find out what route matches the requested URL...</span>\\n\\n  <span class=\\\"token function\\\">fetchPopularRepos</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token operator\\\">...</span></code></pre>\\n      </div>\\n<p>To find the active route, compare the requested URL with the route Object (imported from <code class=\\\"language-text\\\">./src/shared/routes/</code>), if no match is found, set the active route to an empty object.</p>\\n<p>We can now handle the fetching of Initial data with a promise and remove the <em>fetchPopularRepos</em> API call (as it is now handled inside the central route object):</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token comment\\\">// import { fetchPopularRepos } from '../shared/api' //REMOVE</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\napp<span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">get</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">,</span> res<span class=\\\"token punctuation\\\">,</span> next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">//when app receives a GET request...</span>\\n  <span class=\\\"token keyword\\\">const</span> activeRoute <span class=\\\"token operator\\\">=</span> routes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">find</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>route<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token function\\\">matchPath</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>url<span class=\\\"token punctuation\\\">,</span> route<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span> <span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span> <span class=\\\"token comment\\\">//find out what route matches the requested URL...</span>\\n\\n  <span class=\\\"token keyword\\\">const</span> promise <span class=\\\"token operator\\\">=</span> activeRoute<span class=\\\"token punctuation\\\">.</span>fetchInitialData <span class=\\\"token comment\\\">//find out if the route needs to fetch data</span>\\n    <span class=\\\"token operator\\\">?</span> activeRoute<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">fetchInitialData</span><span class=\\\"token punctuation\\\">(</span>req<span class=\\\"token punctuation\\\">.</span>path<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//if so, fetch the data for the active route</span>\\n    <span class=\\\"token punctuation\\\">:</span> Promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">resolve</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//if no data is needed (home route), just resolve</span>\\n\\n    promise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span> <span class=\\\"token comment\\\">//when everything is fetched, render the app markup with the with {data}</span>\\n      <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n      <span class=\\\"token punctuation\\\">)</span>\\n\\n    res<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">send</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token template-string\\\"><span class=\\\"token string\\\">`\\n    &lt;html>\\n    ...\\n    &lt;/html>\\n  `</span></span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//and send the static HTML page to client</span>\\n  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token keyword\\\">catch</span><span class=\\\"token punctuation\\\">(</span>next<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token comment\\\">//if there are any errors, move on to the next request</span>\\n<span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token operator\\\">...</span></code></pre>\\n      </div>\\n<p>You can test the routing by opening a valid URL that follows our requirement <code class=\\\"language-text\\\">path:&#39;/popular/:id&#39;</code>, e.g. <em><a href=\\\"http://localhost:3000/popular/javascript\\\">http://localhost:3000/popular/javascript</a></em></p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-13b29.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 621px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 64.573268921095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABnUlEQVQoz5VS2Y6jMBDM/3/aPIxENNocwICTYALhcDh9M0VsJqt925YlykW3XdXt3bIs1trlHdaYRWu/AX79BLny/yTvsNFa5bk8n+fTaWRsejy6ILg2TSWliKIyzyscwthASGGtQXrbKiQzpnfujCgix2OSZdXz2Q9Dd7mkSinw1yupqgfAPM9pmmwk/foKOVe+uOuYEHyTCi1mw3rTCdmeHMcBy8s2a6ze8Pm1BAznWC/SSOkTsMP1LmsttlYdDuJy4cYIIXSWyaKQqKWU7fc3KSWaEgSUUpjXjKmPj7koxFrs7onj7HwmnMMa3++jJLmDrOuK0pvrMCFJ33fAjPVBEFFag/bFdf0Yxx4ALSlLimuBpVSuQwhIcp7neaqq4j2qvz07S86zn7t9t8olCOEfgivWcdxmGUPmMPAgKIuCGaPG0dzvdp41EqI/hDWQbZtGHw66aczbMyFpnucA0zSF4WkY1kncbuXnZ4znARyGIWPsZZB9fxO0Axp2myXpZgtVnPuBP58tllMO0k2xbZs0Tb3n5T9Da43hOfwDr3Tv00B/cxUAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;\\\"\\n        alt=\\\"Popular Javascript Repositories on Github\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-13b29.png\\\"\\n        srcset=\\\"/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-97e0b.png 200w,\\n/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-de510.png 400w,\\n/static/ssrrr_05-30459cbc55c3d91d261c1481456ac5ec-13b29.png 621w\\\"\\n        sizes=\\\"(max-width: 621px) 100vw, 621px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>The Router matches the URL, fetches the corresponding data from the Github API and provides it to the Grid component that is rendered and send to the client.</p>\\n<h3 id=\\\"client-side\\\"><a href=\\\"#client-side\\\" aria-hidden=\\\"true\\\" class=\\\"anchor\\\"><svg aria-hidden=\\\"true\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg></a>Client Side</h3>\\n<p>Now we have to add the client side routing. First, we wrap the &#x3C;App /> component <code class=\\\"language-text\\\">./src/browser/index.js</code> inside a &#x3C;BrowserRouter />:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> hydrate <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-dom'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> BrowserRouter <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n\\n<span class=\\\"token keyword\\\">import</span> App <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'../shared/App'</span>\\n\\n<span class=\\\"token function\\\">hydrate</span><span class=\\\"token punctuation\\\">(</span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>BrowserRouter</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>window<span class=\\\"token punctuation\\\">.</span>__INITIAL_DATA__<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n  <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>BrowserRouter</span><span class=\\\"token punctuation\\\">></span></span><span class=\\\"token punctuation\\\">,</span>\\n  document<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">getElementById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'app'</span><span class=\\\"token punctuation\\\">)</span>\\n<span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>And use the &#x3C;StaticRouter /> for the server side render:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> matchPath<span class=\\\"token punctuation\\\">,</span> StaticRouter <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n\\n<span class=\\\"token operator\\\">...</span>\\n\\npromise<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">then</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">const</span> markup <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">renderToString</span><span class=\\\"token punctuation\\\">(</span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>StaticRouter</span> <span class=\\\"token attr-name\\\">location</span><span class=\\\"token attr-value\\\"><span class=\\\"token punctuation\\\">=</span><span class=\\\"token punctuation\\\">'</span>req.url<span class=\\\"token punctuation\\\">'</span></span> <span class=\\\"token attr-name\\\">context</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">}</span></span><span class=\\\"token punctuation\\\">></span></span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>App</span> <span class=\\\"token attr-name\\\">data</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>data<span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n        <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>StaticRouter</span><span class=\\\"token punctuation\\\">></span></span>\\n      <span class=\\\"token punctuation\\\">)</span></code></pre>\\n      </div>\\n<p>The &#x3C;App /> component in <code class=\\\"language-text\\\">./src/shared/app.js</code> now no longer needs to render the &#x3C;Grid /> but will receive </p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-jsx\\\"><code class=\\\"language-jsx\\\"><span class=\\\"token keyword\\\">import</span> React<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span> Component <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react'</span>\\n<span class=\\\"token keyword\\\">import</span> routes <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'./routes'</span>\\n<span class=\\\"token keyword\\\">import</span> <span class=\\\"token punctuation\\\">{</span> Route <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">from</span> <span class=\\\"token string\\\">'react-router-dom'</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">App</span> <span class=\\\"token keyword\\\">extends</span> <span class=\\\"token class-name\\\">Component</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token function\\\">render</span><span class=\\\"token punctuation\\\">(</span>data<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">return</span> <span class=\\\"token punctuation\\\">(</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n        <span class=\\\"token punctuation\\\">{</span>routes<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">map</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">{</span> path<span class=\\\"token punctuation\\\">,</span> exact<span class=\\\"token punctuation\\\">,</span> component<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token constant\\\">C</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token operator\\\">...</span>rest <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n          <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>Route</span>\\n            <span class=\\\"token attr-name\\\">key</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>path<span class=\\\"token punctuation\\\">}</span></span>\\n            <span class=\\\"token attr-name\\\">path</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>path<span class=\\\"token punctuation\\\">}</span></span>\\n            <span class=\\\"token attr-name\\\">exact</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span>exact<span class=\\\"token punctuation\\\">}</span></span>\\n            <span class=\\\"token attr-name\\\">render</span><span class=\\\"token script language-javascript\\\"><span class=\\\"token script-punctuation punctuation\\\">=</span><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">(</span>props<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">=></span> <span class=\\\"token punctuation\\\">(</span>\\n              <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;</span>C</span> <span class=\\\"token spread\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">...</span><span class=\\\"token attr-value\\\">props</span><span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token spread\\\"><span class=\\\"token punctuation\\\">{</span><span class=\\\"token punctuation\\\">...</span><span class=\\\"token attr-value\\\">rest</span><span class=\\\"token punctuation\\\">}</span></span> <span class=\\\"token punctuation\\\">/></span></span>\\n            <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span></span>\\n          <span class=\\\"token punctuation\\\">/></span></span>\\n        <span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token tag\\\"><span class=\\\"token tag\\\"><span class=\\\"token punctuation\\\">&lt;/</span>div</span><span class=\\\"token punctuation\\\">></span></span>\\n    <span class=\\\"token punctuation\\\">)</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">export</span> <span class=\\\"token keyword\\\">default</span> App</code></pre>\\n      </div>\",\"fields\":{\"slug\":\"/server-side-render-react-router/\",\"prefix\":\"2018-01-17\"},\"frontmatter\":{\"title\":\"Server Rendering with React and React Router\",\"subTitle\":\"Server side rendering a React app can provide a few different benefits including performance and SEO. The problem is with those benefits comes a cost of additional complexity to your application. In this project, we'll start from scratch and slowly build a server side rendered React 16.3 with React Router 4.\",\"cover\":{\"childImageSharp\":{\"resize\":{\"src\":\"/static/photo-11627973773_7295195845_o-cover-7ddc1901cf1384438745069bddfdb4e7-160fa.png\"}}}}},\"author\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/author.md absPath of file >>> MarkdownRemark\",\"html\":\"<p><strong>Mike Polinowski</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\\\"/contact/\\\">contact me</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. :hearts:</p>\"},\"footnote\":{\"id\":\"E:/gatsby-starter-personal-blog/content/parts/footnote.md absPath of file >>> MarkdownRemark\",\"html\":\"<ul>\\n<li>This is a personal Developer Blog</li>\\n<li>Ξ</li>\\n<li>built by <a href=\\\"https://github.com/mpolinowski\\\">Mike Polinowski</a></li>\\n<li>Ξ</li>\\n<li>with <a href=\\\"https://www.gatsbyjs.org/\\\">Gatsby</a> &#x26; <a href=\\\"https://reactjs.org\\\">React</a></li>\\n<li>Ξ</li>\\n<li>source code on <a href=\\\"https://github.com/mpolinowski/mpolinowski.github.io\\\">GitHub</a></li>\\n<li>Ξ</li>\\n<li>deliverd by <a href=\\\"https://pages.github.com\\\">Github Pages</a></li>\\n<li>Ξ</li>\\n<li>photos from <a href=\\\"https://www.flickr.com/people/149680084@N06/\\\">Flickr</a></li>\\n</ul>\"}},\"pathContext\":{\"slug\":\"/server-side-render-react-router/\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/server-side-render-react-router.json\n// module id = 680\n// module chunks = 123176868339148"],"sourceRoot":""}