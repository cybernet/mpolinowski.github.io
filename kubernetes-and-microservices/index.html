<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f57237ef82cef6804fb1.css">@font-face{font-family:Bitter;font-style:normal;font-display:swap;font-weight:400;src:local("Bitter Regular "),local("Bitter-Regular"),url(/static/bitter-latin-400-c536cb9ff942711eb641992816492fb6.woff2) format("woff2"),url(/static/bitter-latin-400-d9c3aaf0dc53499b663ed84a4990e7ce.woff) format("woff")}@font-face{font-family:Bitter;font-style:italic;font-display:swap;font-weight:400;src:local("Bitter Regular italic"),local("Bitter-Regularitalic"),url(data:font/woff2;base64,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) format("woff2"),url(/static/bitter-latin-400italic-784ce408bca462385cd79204f62d58be.woff) format("woff")}@font-face{font-family:Bitter;font-style:normal;font-display:swap;font-weight:700;src:local("Bitter Bold "),local("Bitter-Bold"),url(data:font/woff2;base64,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) format("woff2"),url(/static/bitter-latin-700-b79d3f12a101f5f53abc3e10b3a3262e.woff) format("woff")}@font-face{font-family:Open Sans;font-style:normal;font-display:swap;font-weight:300;src:local("Open Sans Light "),local("Open Sans-Light"),url(/static/open-sans-latin-300-60c866748ff15f5b347fdba64596b1b1.woff2) format("woff2"),url(/static/open-sans-latin-300-521d17bc9f3526c690e8ada6eee55bec.woff) format("woff")}@font-face{font-family:Open Sans;font-style:italic;font-display:swap;font-weight:300;src:local("Open Sans Light italic"),local("Open Sans-Lightitalic"),url(/static/open-sans-latin-300italic-06bbd3188b34820cd83a0e0b3d0a6f57.woff2) format("woff2"),url(/static/open-sans-latin-300italic-8a648ff38ded89ea15916e84529d62d3.woff) format("woff")}@font-face{font-family:Open Sans;font-style:normal;font-display:swap;font-weight:400;src:local("Open Sans Regular "),local("Open Sans-Regular"),url(/static/open-sans-latin-400-cffb686d7d2f4682df8342bd4d276e09.woff2) format("woff2"),url(/static/open-sans-latin-400-bf2d0783515b7d75c35bde69e01b3135.woff) format("woff")}@font-face{font-family:Open Sans;font-style:italic;font-display:swap;font-weight:400;src:local("Open Sans Regular italic"),local("Open Sans-Regularitalic"),url(/static/open-sans-latin-400italic-987032ea5d57c93d8da215678eae3b86.woff2) format("woff2"),url(/static/open-sans-latin-400italic-db70d0b9cb27ada1a260a2b35e756b8b.woff) format("woff")}@font-face{font-family:Open Sans;font-style:normal;font-display:swap;font-weight:600;src:local("Open Sans SemiBold "),local("Open Sans-SemiBold"),url(/static/open-sans-latin-600-223a277bd88d8a90c8cdf24cda0ad5f5.woff2) format("woff2"),url(/static/open-sans-latin-600-1cd5320f8937d337b61d5117cf9d7b28.woff) format("woff")}@font-face{font-family:Open Sans;font-style:italic;font-display:swap;font-weight:600;src:local("Open Sans SemiBold italic"),local("Open Sans-SemiBolditalic"),url(/static/open-sans-latin-600italic-4950a7205f0b5cefe41fc03ac346e236.woff2) format("woff2"),url(/static/open-sans-latin-600italic-318ea1ada4102c0704a0637228dcad03.woff) format("woff")}@font-face{font-family:Open Sans;font-style:normal;font-display:swap;font-weight:700;src:local("Open Sans Bold "),local("Open Sans-Bold"),url(/static/open-sans-latin-700-d08c09f2f169f4a6edbcf8b8d1636cb4.woff2) format("woff2"),url(/static/open-sans-latin-700-623e3205570002af47fc2b88f9335d19.woff) format("woff")}@font-face{font-family:Open Sans;font-style:italic;font-display:swap;font-weight:700;src:local("Open Sans Bold italic"),local("Open Sans-Bolditalic"),url(/static/open-sans-latin-700italic-c02f5da6e82e1efe0b45841bfd49ce37.woff2) format("woff2"),url(/static/open-sans-latin-700italic-72e19cbb0e38c6773a7751156752cec4.woff) format("woff")}@font-face{font-family:Open Sans;font-style:normal;font-display:swap;font-weight:800;src:local("Open Sans ExtraBold "),local("Open Sans-ExtraBold"),url(/static/open-sans-latin-800-aaeffaf205b9bbb09920089a14dbe9e8.woff2) format("woff2"),url(/static/open-sans-latin-800-c6aa0c4a601fb6ac66f8253fa594dff5.woff) format("woff")}@font-face{font-family:Open Sans;font-style:italic;font-display:swap;font-weight:800;src:local("Open Sans ExtraBold italic"),local("Open Sans-ExtraBolditalic"),url(/static/open-sans-latin-800italic-6b3973ffe02bb6a8be0f8453506ec032.woff2) format("woff2"),url(/static/open-sans-latin-800italic-79b58175343190550489efe46a7f1138.woff) format("woff")}</style><meta name="generator" content="Gatsby 2.18.11"/><title data-react-helmet="true">Kubernetes and Microservices | | Mike Polinowski | | DevNotes |</title><meta data-react-helmet="true" name="description" content="Domain Driven Design and boundedContext Deploying the Queue Deploying the Position Simulator How to Debug a failed Deployment Deploying the…"/><meta data-react-helmet="true" name="image" content="https://mpolinowski.github.io//social/banner.jpg"/><meta data-react-helmet="true" name="gatsby-starter" content="Gatsby Starter Minimal Blog"/><meta data-react-helmet="true" property="og:locale" content="en_US"/><meta data-react-helmet="true" property="og:site_name" content="minimal"/><meta data-react-helmet="true" property="og:url" content="https://mpolinowski.github.io//kubernetes-and-microservices"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Kubernetes and Microservices | | Mike Polinowski | | DevNotes |"/><meta data-react-helmet="true" property="og:description" content="Domain Driven Design and boundedContext Deploying the Queue Deploying the Position Simulator How to Debug a failed Deployment Deploying the…"/><meta data-react-helmet="true" property="og:image" content="https://mpolinowski.github.io//social/banner.jpg"/><meta data-react-helmet="true" property="og:image:alt" content="Domain Driven Design and boundedContext Deploying the Queue Deploying the Position Simulator How to Debug a failed Deployment Deploying the…"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@minimal"/><meta data-react-helmet="true" name="twitter:title" content="Kubernetes and Microservices | | Mike Polinowski | | DevNotes |"/><meta data-react-helmet="true" name="twitter:url" content="https://mpolinowski.github.io/"/><meta data-react-helmet="true" name="twitter:description" content="Domain Driven Design and boundedContext Deploying the Queue Deploying the Position Simulator How to Debug a failed Deployment Deploying the…"/><meta data-react-helmet="true" name="twitter:image" content="https://mpolinowski.github.io//social/banner.jpg"/><meta data-react-helmet="true" name="twitter:image:alt" content="Domain Driven Design and boundedContext Deploying the Queue Deploying the Position Simulator How to Debug a failed Deployment Deploying the…"/><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"Article","author":{"@type":"Person","name":"Mike Polinowski"},"copyrightHolder":{"@type":"Person","name":"Mike Polinowski"},"copyrightYear":"2019-07-07T14:11:02.932Z","creator":{"@type":"Person","name":"Mike Polinowski"},"publisher":{"@type":"Organization","name":"Mike Polinowski","logo":{"@type":"ImageObject","url":"https://mpolinowski.github.io//social/logo.png"}},"datePublished":"2019-07-07T14:11:02.932Z","dateModified":"2019-07-11T13:52:51.201Z","description":"Domain Driven Design and boundedContext Deploying the Queue Deploying the Position Simulator How to Debug a failed Deployment Deploying the…","headline":"Kubernetes and Microservices | | Mike Polinowski | | DevNotes |","inLanguage":"en","url":"https://mpolinowski.github.io//kubernetes-and-microservices","name":"Kubernetes and Microservices | | Mike Polinowski | | DevNotes |","image":{"@type":"ImageObject","url":"https://mpolinowski.github.io//social/banner.jpg"},"mainEntityOfPage":"https://mpolinowski.github.io//kubernetes-and-microservices"}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","description":"Breadcrumbs list","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","item":{"@id":"https://mpolinowski.github.io/","name":"Homepage"},"position":1},{"@type":"ListItem","item":{"@id":"https://mpolinowski.github.io//contact","name":"Contact"},"position":2},{"@type":"ListItem","item":{"@id":"https://mpolinowski.github.io//kubernetes-and-microservices","name":"Kubernetes and Microservices | | Mike Polinowski | | DevNotes |"},"position":3}]}</script><style data-styled="cKXdoQ hKWAvu fDEBcw eeOUlR kNOMXA jITkvu kkprlB bHdofV lgLxVb bvvdQI lhoXfM hxugeV" data-styled-version="4.4.1">
/* sc-component-id: ImageContainer__Card-sqz07s-0 */
.bHdofV{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:5px;margin:6rem auto 0 auto;padding:1rem;overflow:hidden;background-color:rgb(30,30,30);box-shadow:0px 1px 3px 0px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 2px 1px -1px rgba(0,0,0,0.12);}
/* sc-component-id: Subline-vgu8xv-0 */
.jITkvu{font-size:0.9rem;color:#ededed;}
/* sc-component-id: Header__Wrapper-sc-1foybwl-0 */
.hKWAvu{background:linear-gradient( 45deg,#12644d,#22ba8f );grid-column:1 / -1;margin-left:-1rem;margin-right:-1rem;padding:1rem 2rem 4.5rem 2rem;box-shadow:inset 0px -10px 30px 0px rgba(0,0,0,0.1);} @media (max-width:1200px){.hKWAvu{padding:1rem 2rem 4rem 2rem;}}
/* sc-component-id: Header__Content-sc-1foybwl-1 */
.fDEBcw{max-width:1000px;margin:0 auto;font-size:1.3rem;line-height:1.58;font-weight:bold;font-family:'Bitter',-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Helvetica','Arial',serif;} @media (max-width:600px){.fDEBcw{font-size:1rem;}} .fDEBcw a{color:white;font-size:1.2rem;} .fDEBcw a:hover{opacity:0.85;color:white;}
/* sc-component-id: sc-global-210297847 */
*,*:before,*:after{box-sizing:inherit;} html,body{padding:0;margin:0;} ::selection{color:#ededed;background:#1a8f6e;} html{font-family:'Open Sans',-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Helvetica','Arial',sans-serif;font-size:18px;} html h1{font-size:3.052rem;} html h2{font-size:2.441rem;} html h3{font-size:1.953rem;} html h4{font-size:1.563rem;} html h5{font-size:1.25rem;} @media (max-width:600px){html{font-size:16px;}html h1{font-size:2.488rem;}html h2{font-size:2.074rem;}html h3{font-size:1.728rem;}html h4{font-size:1.444rem;}html h5{font-size:1.2rem;}} body{background:#24292e;color:#ededed;} a{color:#FFC107;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:all 0.5s;transition:all 0.5s;} a:hover{color:#1ea57f;} a:not([href]):not([tabindex]){color:inherit;-webkit-text-decoration:none;text-decoration:none;} a:not([href]):not([tabindex]):hover,a:not([href]):not([tabindex]):focus{color:inherit;-webkit-text-decoration:none;text-decoration:none;} a:not([href]):not([tabindex]):focus{outline:0;} h1,h2,h3,h4,h5,h6{color:#ededed;font-family:'Bitter',-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Helvetica','Arial',serif;} p{color:#ededed;} blockquote{font-style:italic;position:relative;} code{font-style:italic;color:#1ea57f;background:rgba(0,0,0,0.2);} blockquote:before{content:"";position:absolute;background:#1a8f6e;height:100%;width:6px;margin-left:-1.6rem;} label{margin-bottom:.5rem;color:#ededed;} input,textarea,button{font-size:1rem;} textarea{font-family:'Open Sans',-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Helvetica','Arial',sans-serif;} input,textarea{border-radius:.5rem;border:none;background:rgba(0,0,0,0.05);padding:.4rem 1rem;} input:focus,textarea:focus{outline:none;} pre{margin-top:0;margin-bottom:1rem;overflow:auto;} figure{margin:0 0 1rem 0;} img{vertical-align:middle;} [role='button']{cursor:pointer;} a,area,button,[role='button'],input,label,select,summary,textarea{touch-action:manipulation;} table{border-collapse:collapse;background-color:#24292e;} caption{padding-top:1.5rem;padding-bottom:1.5rem;text-align:center;caption-side:bottom;} th{text-align:left;} fieldset{min-width:0;padding:0;margin:0;border:0;} legend{display:block;width:100%;padding:0;margin-bottom:0.5rem;font-size:1.5rem;line-height:inherit;} input[type='search']{-webkit-appearance:none;} output{display:inline-block;} svg:not(:root){overflow:hidden;vertical-align:middle;} [hidden]{display:none !important;}
/* sc-component-id: Layout__Footer-ktgjx5-0 */
.hxugeV{text-align:center;padding:3rem 1rem;} .hxugeV span{font-size:0.75rem;}
/* sc-component-id: PrevNext__Wrapper-sc-1vrmezv-0 */
.lgLxVb{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:6rem auto 0 auto;justify-items:center;} .lgLxVb a{color:#FFC107;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
/* sc-component-id: PrevNext__Prev-sc-1vrmezv-1 */
.bvvdQI span{text-transform:uppercase;font-size:0.8rem;color:#ededed;}
/* sc-component-id: PrevNext__Next-sc-1vrmezv-2 */
.lhoXfM{margin-left:auto;text-align:right;} .lhoXfM span{text-transform:uppercase;font-size:0.8rem;color:#ededed;}
/* sc-component-id: Wrapper-gb426v-0 */
.cKXdoQ{display:grid;grid-template-columns:1fr minmax(280px,1000px) 1fr;}
/* sc-component-id: post__Content-sc-1lfr9gn-0 */
.eeOUlR{grid-column:2;box-shadow:0 4px 120px rgba(0,0,0,0.1);max-width:1000px;border-radius:0.2rem;padding:2rem 4.5rem;background-color:#31363f;z-index:9000;margin-top:-3rem;} @media (max-width:1200px){.eeOUlR{padding:3rem 2rem;}} @media (max-width:600px){.eeOUlR{padding:2rem 1rem;}} .eeOUlR p{font-size:1.1rem;-webkit-letter-spacing:-0.003em;-moz-letter-spacing:-0.003em;-ms-letter-spacing:-0.003em;letter-spacing:-0.003em;line-height:1.58;--baseline-multiplier:0.179;--x-height-multiplier:0.35;} @media (max-width:600px){.eeOUlR p{font-size:1rem;}} .eeOUlR .prism-code{padding:0.75rem;border-radius:5px;margin-bottom:1rem;font-size:16px;}
/* sc-component-id: post__Title-sc-1lfr9gn-1 */
.kNOMXA{margin-bottom:1rem;}
/* sc-component-id: post__PostContent-sc-1lfr9gn-2 */
.kkprlB{margin-top:4rem;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#25ad71"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=31cb743e715b744a26623d32a8929a87"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=31cb743e715b744a26623d32a8929a87"/><link as="script" rel="preload" href="/webpack-runtime-21874df8409d87262c36.js"/><link as="script" rel="preload" href="/styles-7d42529fada194e095c0.js"/><link as="script" rel="preload" href="/app-d99d81405d6e68123448.js"/><link as="script" rel="preload" href="/commons-99565a21e6c752f21563.js"/><link as="script" rel="preload" href="/component---src-templates-post-jsx-88bf0e40afdbabddf566.js"/><link as="fetch" rel="preload" href="/page-data\kubernetes-and-microservices\page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="Wrapper-gb426v-0 cKXdoQ"><header class="Header__Wrapper-sc-1foybwl-0 hKWAvu"><div class="Header__Content-sc-1foybwl-1 fDEBcw"><a href="/">| Mike Polinowski | | DevNotes |</a></div></header><article class="post__Content-sc-1lfr9gn-0 eeOUlR"><h1 class="post__Title-sc-1lfr9gn-1 kNOMXA">Kubernetes and Microservices</h1><div class="Subline-vgu8xv-0 jITkvu">01/17/2019<!-- --> — <!-- -->9<!-- --> Min Read — Categories<!-- -->   <a href="/categories/linux">LINUX</a>, <a href="/categories/docker">Docker</a>, <a href="/categories/kubernetes">Kubernetes</a></div><div class="post__PostContent-sc-1lfr9gn-2 kkprlB"><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1024px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:46.50801862390067%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/250f352f8408a5aa47641f30724d572e/8d3d1/photo-34364880182_fe2d33582b_o.webp 256w,/static/250f352f8408a5aa47641f30724d572e/354cf/photo-34364880182_fe2d33582b_o.webp 512w,/static/250f352f8408a5aa47641f30724d572e/44907/photo-34364880182_fe2d33582b_o.webp 1024w,/static/250f352f8408a5aa47641f30724d572e/a8642/photo-34364880182_fe2d33582b_o.webp 1536w,/static/250f352f8408a5aa47641f30724d572e/8ce9c/photo-34364880182_fe2d33582b_o.webp 1933w" sizes="(max-width: 1024px) 100vw, 1024px" type="image/webp"/>
        <source srcSet="/static/250f352f8408a5aa47641f30724d572e/8f7a7/photo-34364880182_fe2d33582b_o.jpg 256w,/static/250f352f8408a5aa47641f30724d572e/9bced/photo-34364880182_fe2d33582b_o.jpg 512w,/static/250f352f8408a5aa47641f30724d572e/7c71a/photo-34364880182_fe2d33582b_o.jpg 1024w,/static/250f352f8408a5aa47641f30724d572e/ce273/photo-34364880182_fe2d33582b_o.jpg 1536w,/static/250f352f8408a5aa47641f30724d572e/f6b1c/photo-34364880182_fe2d33582b_o.jpg 1933w" sizes="(max-width: 1024px) 100vw, 1024px" type="image/jpeg"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/250f352f8408a5aa47641f30724d572e/7c71a/photo-34364880182_fe2d33582b_o.jpg" alt="Sydney, Australia" title=""/>
      </picture>
  </span></p><ul><li><a href="#domain-driven-design-and-boundedcontext">Domain Driven Design and boundedContext</a><ul><li><a href="#deploying-the-queue">Deploying the Queue</a></li><li><a href="#deploying-the-position-simulator">Deploying the Position Simulator</a></li><li><a href="#how-to-debug-a-failed-deployment">How to Debug a failed Deployment</a></li><li><a href="#deploying-the-position-tracker">Deploying the Position Tracker</a></li><li><a href="#deploying-the-api-gateway">Deploying the API Gateway</a></li><li><a href="#deploying-the-angular-frontend">Deploying the Angular Frontend</a></li></ul></li><li><a href="#persistence-in-a-kubernetes-cluster">Persistence in a Kubernetes Cluster</a><ul><li><a href="#mongodb-pod">MongoDB Pod</a></li><li><a href="#mongodb-service">MongoDB Service</a></li><li><a href="#volume-mounts">Volume Mounts</a></li><li><a href="#using-persistentvolumeclaims">Using PersistentVolumeClaims</a></li></ul></li><li><a href="#cloud-deployment">Cloud Deployment</a></li></ul><h2 id="domain-driven-design-and-boundedcontext"><a href="#domain-driven-design-and-boundedcontext" aria-label="domain driven design and boundedcontext permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Domain Driven Design and boundedContext</h2><p>A Microservice architecture is an implementation of the <a href="https://martinfowler.com/tags/domain%20driven%20design.html" target="_blank" rel="nofollow noopener noreferrer">Domain Drive Design</a> principle and <a href="https://martinfowler.com/bliki/BoundedContext.html" target="_blank" rel="nofollow noopener noreferrer">bounded Context</a> is a central pattern in Domain-Driven Design. It is the focus of DDD&#x27;s strategic design section which is all about dealing with large models and teams. DDD deals with large models by dividing them into different Bounded Contexts and being explicit about their interrelationships.</p><p>The idea behind the principle is to break architectures into small, <strong>cohesive components</strong> that only fullfil one job (<strong>single responsibility principle</strong>) for one other component (<strong>loosely coupled</strong>). E.g. instead of having one big Integration Database that is build with a single schema and serves all parts of your monolithic application we will add a small, exclusive database to every component that needs data storage.</p><p>We are going to continue to build the web application we <a href="https://mpolinowski.github.io/creating-a-kubernetes-cluster/" target="_blank" rel="nofollow noopener noreferrer">started to build earlier</a> - with an ActiveMQ Message broker in the backend and an Angular web frontend that will show us the position of our car fleet on a map. The architecture will consist of 5 pods:</p><pre class="prism-code language-" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Position Simulator -&gt; ActiveMQ -&gt; Position Tracker &lt;- API Gateway &lt;- NGINX Reverse Proxy &lt;-&gt; Web Browser</span></div></pre><p>The necessary Docker images can be found on <a href="https://hub.docker.com/u/richardchesterwood" target="_blank" rel="nofollow noopener noreferrer">DockerHUB</a> - their corresponding source code can be found on <a href="https://github.com/DickChesterwood/k8s-fleetman" target="_blank" rel="nofollow noopener noreferrer">Github</a>.</p><ul><li>The <a href="https://hub.docker.com/r/richardchesterwood/k8s-fleetman-position-simulator" target="_blank" rel="nofollow noopener noreferrer">Position Simulator</a> will simulate the GPS signal from our cars, reporting in their position every 10s.</li><li>The Position Simulator is then send to our <a href="https://hub.docker.com/r/richardchesterwood/k8s-fleetman-queue" target="_blank" rel="nofollow noopener noreferrer">ActiveMQ</a> service we already deployed earlier.</li><li>This Queue server / Message Broker then forwards the information it received to the <a href="https://hub.docker.com/r/richardchesterwood/k8s-fleetman-position-tracker" target="_blank" rel="nofollow noopener noreferrer">Position Tracker</a> that is storing the information as well as doing some basic calculations on it, like estimating the average speed the car is traveling with.</li><li>To prevent the frontend code to directly contact this backend part of our application, we will add an <a href="https://hub.docker.com/r/richardchesterwood/k8s-fleetman-api-gateway" target="_blank" rel="nofollow noopener noreferrer">API Gateway</a> that will serve as an interface between front- and backend. This way changes in the backend will never directly affect the frontend, or vice versa - see <a href="https://microservices.io/patterns/apigateway.html" target="_blank" rel="nofollow noopener noreferrer">API Gateway Pattern</a>.</li><li>The final container will run our <a href="https://hub.docker.com/r/richardchesterwood/k8s-fleetman-webapp-angular" target="_blank" rel="nofollow noopener noreferrer">Web Application Frontend</a> with the help of an NGINX reverse proxy.</li></ul><h3 id="deploying-the-queue"><a href="#deploying-the-queue" aria-label="deploying the queue permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying the Queue</h3><p>We want to start with a fresh cluster - if you already <a href="https://mpolinowski.github.io/creating-a-kubernetes-cluster/" target="_blank" rel="nofollow noopener noreferrer">followed the earlier steps</a>, just enter the directory that contains all your configuration files (services.yaml, pods.yaml, networking-tests.yaml) and force delete everything that was build from them on your cluster:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl delete -f </span><span class="token keyword" style="color:rgb(86, 156, 214)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">rm</span><span class="token plain"> networking-tests.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">mv</span><span class="token plain"> pods.yaml workloads.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">nano</span><span class="token plain"> workloads.yaml</span></div></pre><p>We are also deleting an unnecessary file from the previous step and renaming another - just if you are following along. We can now add the queue server to the <code>workloads.yaml</code> file:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the ReplicaSet instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># the ReplicaSet manages all Pods</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># where the label = app: queue</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># only 1 Pod should exist atm - if it</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># crashes, a new pod will be spawned.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">queue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release1</span></div></pre><p>Secondly, we need to apply a service that exposes our Queue container, which is done in the <code>services.yaml</code> file (if you still have the webapp service from the previous step - just leave it in for now):</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the Service instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> admin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">console</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8161</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8161</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># The nodePort is available from outside of the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># cluster when is set to NodePort. It&#x27;s value has</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># to be &gt; 30000</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">nodePort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">30010</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> endpoint</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">61616</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">61616</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Define which pods are going to</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># be represented by this service</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># The service makes an network</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># endpoint for our app</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Setting the Service type to ClusterIP makes the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># service only available from inside the cluster</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># To expose a port use NodePort instead</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NodePort</span></div></pre><p>The Queue service is going to expose the port <strong>8161</strong> for the administration console (this should be removed once the app goes into production!) and makes it accessible over the port <strong>30010</strong> from outside of the Kubernetes cluster. Additionally we need to expose the port <strong>61616</strong> that ActiveMQ is using to broker messages.</p><p>You can now start both the pod as well as the service with:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f workloads.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f services.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div></pre><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:26.724137931034488%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/bd63052b39fdc44323e580ffe4dd7b91/8d3d1/kubernetes_microservices_01.webp 256w,/static/bd63052b39fdc44323e580ffe4dd7b91/354cf/kubernetes_microservices_01.webp 512w,/static/bd63052b39fdc44323e580ffe4dd7b91/8974e/kubernetes_microservices_01.webp 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/webp"/>
        <source srcSet="/static/bd63052b39fdc44323e580ffe4dd7b91/b1806/kubernetes_microservices_01.png 256w,/static/bd63052b39fdc44323e580ffe4dd7b91/7572d/kubernetes_microservices_01.png 512w,/static/bd63052b39fdc44323e580ffe4dd7b91/20bb3/kubernetes_microservices_01.png 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/bd63052b39fdc44323e580ffe4dd7b91/20bb3/kubernetes_microservices_01.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>The Admin panel should now be accessible over the IP address of your Kubernetes master server with the port <strong>30010</strong>:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:42.98029556650247%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/a5feb4ba5ebf09f41f97271ad02b3231/8d3d1/kubernetes_microservices_02.webp 256w,/static/a5feb4ba5ebf09f41f97271ad02b3231/354cf/kubernetes_microservices_02.webp 512w,/static/a5feb4ba5ebf09f41f97271ad02b3231/8974e/kubernetes_microservices_02.webp 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/webp"/>
        <source srcSet="/static/a5feb4ba5ebf09f41f97271ad02b3231/b1806/kubernetes_microservices_02.png 256w,/static/a5feb4ba5ebf09f41f97271ad02b3231/7572d/kubernetes_microservices_02.png 512w,/static/a5feb4ba5ebf09f41f97271ad02b3231/20bb3/kubernetes_microservices_02.png 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/a5feb4ba5ebf09f41f97271ad02b3231/20bb3/kubernetes_microservices_02.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><h3 id="deploying-the-position-simulator"><a href="#deploying-the-position-simulator" aria-label="deploying the position simulator permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying the Position Simulator</h3><p>We can now add the Position Simulator to the <code>workloads.yaml</code> file - directly under the configuration of our queue server, divided by <code>---</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the ReplicaSet instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># only 1 Pod should exist atm - if it</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># crashes, a new pod will be spawned.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div></pre><p>The configuration for deployment is similar to the ActiveMQ config. We only need to add a <strong>Environment Variable</strong> that sets the service to <em>Production Settings</em> - <code>SPRING_PROFILES_ACTIVE: production-microservice</code> (the service can be started with different profiles, depending if you are in a development or production environment).</p><p>We can apply the new workloads configuration, check for the name of the new container (it will be called <code>position-simulator</code> + an deployment ID + an replicationSet ID) and check if it is build correctly:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f workloads.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl describe pod position-simulator-68bfc8d6fb-8vxkt</span></div></pre><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:815px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:19.509202453987733%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/c1c1a341c54e5cb17428e7b35dd5a3a0/8d3d1/kubernetes_microservices_03.webp 256w,/static/c1c1a341c54e5cb17428e7b35dd5a3a0/354cf/kubernetes_microservices_03.webp 512w,/static/c1c1a341c54e5cb17428e7b35dd5a3a0/16910/kubernetes_microservices_03.webp 815w" sizes="(max-width: 815px) 100vw, 815px" type="image/webp"/>
        <source srcSet="/static/c1c1a341c54e5cb17428e7b35dd5a3a0/b1806/kubernetes_microservices_03.png 256w,/static/c1c1a341c54e5cb17428e7b35dd5a3a0/7572d/kubernetes_microservices_03.png 512w,/static/c1c1a341c54e5cb17428e7b35dd5a3a0/0cfc2/kubernetes_microservices_03.png 815w" sizes="(max-width: 815px) 100vw, 815px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/c1c1a341c54e5cb17428e7b35dd5a3a0/0cfc2/kubernetes_microservices_03.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>This service does not need to be accessed from outside of the Kubernetes cluster - so <strong>we do not need to create a service</strong> for it.</p><p>We can test the deployment by accessing the IP Address followed by the port <strong>30010</strong>, click on <em>Managing ActiveMQ Broker</em>, sign in with <strong>admin, admin</strong> and click on <strong>Queues</strong>:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:804px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:44.27860696517413%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/e73b03c00cd38d492a1a69fd3f90a7c9/8d3d1/kubernetes_microservices_07.webp 256w,/static/e73b03c00cd38d492a1a69fd3f90a7c9/354cf/kubernetes_microservices_07.webp 512w,/static/e73b03c00cd38d492a1a69fd3f90a7c9/d7f04/kubernetes_microservices_07.webp 804w" sizes="(max-width: 804px) 100vw, 804px" type="image/webp"/>
        <source srcSet="/static/e73b03c00cd38d492a1a69fd3f90a7c9/b1806/kubernetes_microservices_07.png 256w,/static/e73b03c00cd38d492a1a69fd3f90a7c9/7572d/kubernetes_microservices_07.png 512w,/static/e73b03c00cd38d492a1a69fd3f90a7c9/2c8f1/kubernetes_microservices_07.png 804w" sizes="(max-width: 804px) 100vw, 804px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/e73b03c00cd38d492a1a69fd3f90a7c9/2c8f1/kubernetes_microservices_07.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:41.50246305418719%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/44b9478322c304d795aaa838e9f32b07/8d3d1/kubernetes_microservices_08.webp 256w,/static/44b9478322c304d795aaa838e9f32b07/354cf/kubernetes_microservices_08.webp 512w,/static/44b9478322c304d795aaa838e9f32b07/8974e/kubernetes_microservices_08.webp 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/webp"/>
        <source srcSet="/static/44b9478322c304d795aaa838e9f32b07/b1806/kubernetes_microservices_08.png 256w,/static/44b9478322c304d795aaa838e9f32b07/7572d/kubernetes_microservices_08.png 512w,/static/44b9478322c304d795aaa838e9f32b07/20bb3/kubernetes_microservices_08.png 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/44b9478322c304d795aaa838e9f32b07/20bb3/kubernetes_microservices_08.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>You should see a rising number of pending messages, telling you that our <strong>Position Simulator</strong> is successfully sending GPS coordinates to the message broker.</p><h3 id="how-to-debug-a-failed-deployment"><a href="#how-to-debug-a-failed-deployment" aria-label="how to debug a failed deployment permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to Debug a failed Deployment</h3><p>As we have seen above the deployment work and the Position Simulator is up and running - but how would we debug a container that cannot be started for some reason? We can create this circumstance by adding a typo in the environment variable inside the config file we created above, e.g. <code>SPRING_PROFILES_ACTIVE: production-microservice-typo</code>:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f workloads.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl describe pod position-simulator-77dcb74d75-dt27n</span></div></pre><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:816px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:17.892156862745097%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/b5b9c0a953e353d429b9ce39bc4f595b/8d3d1/kubernetes_microservices_04.webp 256w,/static/b5b9c0a953e353d429b9ce39bc4f595b/354cf/kubernetes_microservices_04.webp 512w,/static/b5b9c0a953e353d429b9ce39bc4f595b/86ed8/kubernetes_microservices_04.webp 816w" sizes="(max-width: 816px) 100vw, 816px" type="image/webp"/>
        <source srcSet="/static/b5b9c0a953e353d429b9ce39bc4f595b/b1806/kubernetes_microservices_04.png 256w,/static/b5b9c0a953e353d429b9ce39bc4f595b/7572d/kubernetes_microservices_04.png 512w,/static/b5b9c0a953e353d429b9ce39bc4f595b/4b21e/kubernetes_microservices_04.png 816w" sizes="(max-width: 816px) 100vw, 816px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/b5b9c0a953e353d429b9ce39bc4f595b/4b21e/kubernetes_microservices_04.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>We can now see that the deployment is failing and Kubernetes is trying to restart the container in a loop (<strong>CrashLoopBackOff</strong>). To check what is going wrong, we can call the Kubernetes logs for the failing container:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl logs position-simulator-77dcb74d75-dt27n</span></div></pre><p>And the developer of the application should be able to spot the typo inside the selected profile for you:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:815px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:47.60736196319018%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/8d3d1/kubernetes_microservices_05.webp 256w,/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/354cf/kubernetes_microservices_05.webp 512w,/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/16910/kubernetes_microservices_05.webp 815w" sizes="(max-width: 815px) 100vw, 815px" type="image/webp"/>
        <source srcSet="/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/b1806/kubernetes_microservices_05.png 256w,/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/7572d/kubernetes_microservices_05.png 512w,/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/0cfc2/kubernetes_microservices_05.png 815w" sizes="(max-width: 815px) 100vw, 815px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/0cfc2/kubernetes_microservices_05.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>Fixing the <em>typo</em> and re-applying the configuration should show you that the &quot;loop-crashing&quot; container is now being discarded and replaced by a working version:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f workloads.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div></pre><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:804px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:9.577114427860696%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/c327a28b3451e54d92e6f16ba0d636bb/8d3d1/kubernetes_microservices_06.webp 256w,/static/c327a28b3451e54d92e6f16ba0d636bb/354cf/kubernetes_microservices_06.webp 512w,/static/c327a28b3451e54d92e6f16ba0d636bb/d7f04/kubernetes_microservices_06.webp 804w" sizes="(max-width: 804px) 100vw, 804px" type="image/webp"/>
        <source srcSet="/static/c327a28b3451e54d92e6f16ba0d636bb/b1806/kubernetes_microservices_06.png 256w,/static/c327a28b3451e54d92e6f16ba0d636bb/7572d/kubernetes_microservices_06.png 512w,/static/c327a28b3451e54d92e6f16ba0d636bb/2c8f1/kubernetes_microservices_06.png 804w" sizes="(max-width: 804px) 100vw, 804px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/c327a28b3451e54d92e6f16ba0d636bb/2c8f1/kubernetes_microservices_06.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><h3 id="deploying-the-position-tracker"><a href="#deploying-the-position-tracker" aria-label="deploying the position tracker permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying the Position Tracker</h3><p>Now we need to start up the position tracker who&#x27;s job it is take out the message that are send by our position simulator and are currently piling up in our ActiveMQ Server. The position tracked does some calculation on those messages and exposes his results through an REST interface to the API gateway.</p><p>We can now add the <strong>Position Tracker</strong> to the <code>workloads.yaml</code> file - directly under the configuration of our position simulator, divided by <code>---</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the ReplicaSet instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># only 1 Pod should exist atm - if it</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># crashes, a new pod will be spawned.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div></pre><p>We can now deploy the position tracker and then take a look at our message queue. We should be able to see that the tracker is working and messages are getting de-queued:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f workloads.yaml</span></div></pre><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:42.11822660098522%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/16f808f5508fdd96fc8d8cd6ddfc4694/8d3d1/kubernetes_microservices_09.webp 256w,/static/16f808f5508fdd96fc8d8cd6ddfc4694/354cf/kubernetes_microservices_09.webp 512w,/static/16f808f5508fdd96fc8d8cd6ddfc4694/8974e/kubernetes_microservices_09.webp 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/webp"/>
        <source srcSet="/static/16f808f5508fdd96fc8d8cd6ddfc4694/b1806/kubernetes_microservices_09.png 256w,/static/16f808f5508fdd96fc8d8cd6ddfc4694/7572d/kubernetes_microservices_09.png 512w,/static/16f808f5508fdd96fc8d8cd6ddfc4694/20bb3/kubernetes_microservices_09.png 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/16f808f5508fdd96fc8d8cd6ddfc4694/20bb3/kubernetes_microservices_09.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>We can now add a service for the position tracker to expose the REST interface directly on port <strong>8080</strong> (<em>optional - only for testing</em>). For this we need to add the following lines to our <code>services.yaml</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the Service instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> rest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">interface</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># The nodePort is available from outside of the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># cluster when is set to NodePort. It&#x27;s value has</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># to be &gt; 30000</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">nodePort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">30020</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Setting the Service type to ClusterIP makes the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># service only available from inside the cluster</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># To expose a port use NodePort instead</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NodePort</span></div></pre><p>Now apply the changes <code>kubectl apply -f services.yaml</code> and open the REST interface on your Master server IP address with the port <strong>30020</strong>:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">http://195.201.148.210:30020/vehicles/City%20Truck</span></div></pre><p>You should be able to see the current location and speed of the vehicle with the designation <strong>City Truck</strong>:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:21.305418719211822%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/1d9e3bff8329df2211e9be7c9e711b96/8d3d1/kubernetes_microservices_10.webp 256w,/static/1d9e3bff8329df2211e9be7c9e711b96/354cf/kubernetes_microservices_10.webp 512w,/static/1d9e3bff8329df2211e9be7c9e711b96/8974e/kubernetes_microservices_10.webp 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/webp"/>
        <source srcSet="/static/1d9e3bff8329df2211e9be7c9e711b96/b1806/kubernetes_microservices_10.png 256w,/static/1d9e3bff8329df2211e9be7c9e711b96/7572d/kubernetes_microservices_10.png 512w,/static/1d9e3bff8329df2211e9be7c9e711b96/20bb3/kubernetes_microservices_10.png 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/1d9e3bff8329df2211e9be7c9e711b96/20bb3/kubernetes_microservices_10.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>Since it would be dangerous to expose the REST API directly to the internet, we will remove the NodePort and have the API be available only from inside our cluster on port 8080:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the Service instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> rest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">interface</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Setting the Service type to ClusterIP makes the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># service only available from inside the cluster</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># To expose a port use NodePort instead</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ClusterIP</span></div></pre><h3 id="deploying-the-api-gateway"><a href="#deploying-the-api-gateway" aria-label="deploying the api gateway permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying the API Gateway</h3><p>We can now add the <strong>API Gateway</strong> to the <code>workloads.yaml</code> file - directly under the configuration of our position tracker, divided by <code>---</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the ReplicaSet instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># only 1 Pod should exist atm - if it</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># crashes, a new pod will be spawned.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div></pre><p>We can now deploy the gateway with <code>kubectl apply -f workloads.yaml</code>. And then expose the port <strong>8080</strong> to the Kubernetes cluster in <code>services.yaml</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the Service instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> rest</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">interface</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Setting the Service type to ClusterIP makes the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># service only available from inside the cluster</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># To expose a port use NodePort instead</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ClusterIP</span></div></pre><h3 id="deploying-the-angular-frontend"><a href="#deploying-the-angular-frontend" aria-label="deploying the angular frontend permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploying the Angular Frontend</h3><p>We can now add the <strong>Web APP</strong> to the <code>workloads.yaml</code> file - directly under the configuration of our position tracker, divided by <code>---</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the ReplicaSet instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># only 1 Pod should exist atm - if it</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># crashes, a new pod will be spawned.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">webapp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">angular</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div></pre><p>We can now deploy the frontend with <code>kubectl apply -f workloads.yaml</code>. And then expose the port <strong>80</strong> to the Kubernetes cluster in <code>services.yaml</code>, as well as adding the public port (NodePort) <strong>30080</strong>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Unique key of the Service instance</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Accept traffic sent to port 80</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> http</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># The nodePort is available from outside of the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># cluster when is set to NodePort. It&#x27;s value has</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># to be &gt; 30000</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">nodePort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">30080</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Define which pods are going to</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># be represented by this service</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># The service makes an network</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># endpoint for our app</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># Setting the Service type to ClusterIP makes the</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># service only available from inside the cluster</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># To expose a port use NodePort instead</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NodePort</span></div></pre><p>Your complete Microservice deployment should now look something like this:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:816px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:60.90686274509803%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/ff553fffe62b42391529e3e63c32176e/8d3d1/kubernetes_microservices_11.webp 256w,/static/ff553fffe62b42391529e3e63c32176e/354cf/kubernetes_microservices_11.webp 512w,/static/ff553fffe62b42391529e3e63c32176e/86ed8/kubernetes_microservices_11.webp 816w" sizes="(max-width: 816px) 100vw, 816px" type="image/webp"/>
        <source srcSet="/static/ff553fffe62b42391529e3e63c32176e/b1806/kubernetes_microservices_11.png 256w,/static/ff553fffe62b42391529e3e63c32176e/7572d/kubernetes_microservices_11.png 512w,/static/ff553fffe62b42391529e3e63c32176e/4b21e/kubernetes_microservices_11.png 816w" sizes="(max-width: 816px) 100vw, 816px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/ff553fffe62b42391529e3e63c32176e/4b21e/kubernetes_microservices_11.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>And you should be able to access the web interface on port <strong>30080</strong> on your master server IP address:</p><div class="ImageContainer__Card-sqz07s-0 bHdofV"><img src="/assets/gif/kubernetes_microservices_12.gif" alt="A Kubernetes Cluster&amp;Microservices"/></div><h2 id="persistence-in-a-kubernetes-cluster"><a href="#persistence-in-a-kubernetes-cluster" aria-label="persistence in a kubernetes cluster permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Persistence in a Kubernetes Cluster</h2><p>In Docker all data that is generated inside a container is lost when you restart it. So if we, for example, want to store the geo location of our car fleet and calculate a travel path from it, all of that is gone, when the container restarts. Docker offers persistent in external volumes to prevent this from happening.</p><p>To add <strong>vehicle tracking</strong> to our app, we need to update all of our images to the <code>:release2</code> in <code>workloads.yaml</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> queue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">queue</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">simulator</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">position</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">tracker</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">api</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">gateway</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> webapp</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> richardchesterwood/k8s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">webapp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">angular</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">release2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> SPRING_PROFILES_ACTIVE</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> production</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">microservice</span></div></pre><p>Restarting everything with <code>kubectl apply -f workloads.yaml</code> now shows us the v2 interface on port <strong>30080</strong>. Clicking on a vehicle name in the list on the left will jump you to the selected truck and highlight the path that vehicle has taken:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:812px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:66.62561576354679%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/1bd8c895ab589876872d5b16180e04f2/8d3d1/kubernetes_microservices_13.webp 256w,/static/1bd8c895ab589876872d5b16180e04f2/354cf/kubernetes_microservices_13.webp 512w,/static/1bd8c895ab589876872d5b16180e04f2/8974e/kubernetes_microservices_13.webp 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/webp"/>
        <source srcSet="/static/1bd8c895ab589876872d5b16180e04f2/b1806/kubernetes_microservices_13.png 256w,/static/1bd8c895ab589876872d5b16180e04f2/7572d/kubernetes_microservices_13.png 512w,/static/1bd8c895ab589876872d5b16180e04f2/20bb3/kubernetes_microservices_13.png 812w" sizes="(max-width: 812px) 100vw, 812px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/1bd8c895ab589876872d5b16180e04f2/20bb3/kubernetes_microservices_13.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>This data is stored in an internal data structure inside the <strong>Position Tracker</strong> container and will be lost if you reload that container. You can get the webapp pod name and delete it:</p><pre class="prism-code language-" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl delete pod -f pod/position-tracker-684d9d84cb-st8pc</span></div></pre><p>Your deployment will take care of restarting the webapp for you - if you reload the web interface you will see that the tracker data has been lost. To prevent this from happening, we now want to add a <strong>MongoDB</strong> database to our cluster that stores the data tracker produces in a persistent way.</p><h3 id="mongodb-pod"><a href="#mongodb-pod" aria-label="mongodb pod permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MongoDB Pod</h3><p>We have a new release of the app <code>:release3</code> that is build, expecting there to be a <a href="https://hub.docker.com/_/mongo" target="_blank" rel="nofollow noopener noreferrer">MongoDB Database</a> (<em>3.6.10-stretch</em>) on our cluster to store the tracking data in. We can create a new Kubernetes deployment for this Docker images and we are going to configure it in a file called <code>mongo-stack.yaml</code>:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">3.6.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">stretch</span></div></pre><p>Now update only the <strong>Position Tracker</strong> image in <code>workloads.yaml</code> to v3 (same as before, see above) and apply all changes to the cluster:</p><pre class="prism-code language-" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f mongo-stack.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f workloads.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div></pre><h3 id="mongodb-service"><a href="#mongodb-service" aria-label="mongodb service permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MongoDB Service</h3><p>To enable our tracker to use our new database we need to add a Kubernetes service and expose the MongoDB port to the Cluster. And we can define this services inside the <code>mongo-stack.yaml</code> file, right under the pod config:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">3.6.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">stretch</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Service</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> fleetman</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">default</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">27017</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">targetPort</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">27017</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> ClusterIP</span></div></pre><p>It is critical to add the metadata name <code>fleetman-mongodb</code> as this is going to be the domain name that CoreDNS inside our cluster is using to resolve the pod IP address and our v3 <strong>Production Tracker</strong> is <a href="https://github.com/DickChesterwood/k8s-fleetman/blob/release3/k8s-fleetman-position-tracker/src/main/resources/application-production-microservice.properties" target="_blank" rel="nofollow noopener noreferrer">configured to search</a> for the MongoDB database on <code>mongodb.host=fleetman-mongodb.default.svc.cluster.local</code>!</p><p>Also make sure that the service <strong>Selector</strong> is set to match the <strong>matchLabels</strong> in the pod config above, as this is used to connect the service. Now re-apply the Mongo stack configuration to start up the service. If you repeat the experiment from earlier and delete the <strong>Position Tracker</strong> the collected data will persist. </p><pre class="prism-code language-" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f mongo-stack.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get all</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl delete pod -f pod/position-tracker-684d9d84cb-st8pc</span></div></pre><h3 id="volume-mounts"><a href="#volume-mounts" aria-label="volume mounts permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Volume Mounts</h3><p>Right now the data is still stored on the filesystem of the MongoDB container. We need to configure the MongoDB container to persist the data outside of the container itself, on our Kubernetes node filesystem in a <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/" target="_blank" rel="nofollow noopener noreferrer">Persistent Volume</a> to make it survive a complete reload of our cluster.</p><p>To mount an external volume into the MongoDB container, we need to add a few lines to the pod configuration file. If you scroll to the bottom of the  DockerHub page (<a href="https://hub.docker.com/_/mongo" target="_blank" rel="nofollow noopener noreferrer">Where to Store Data?</a>) you can see that the default data storage path inside the MongoDB container is <code>/data/db</code>. We now have to link this path inside the container (<code>mountPath</code>) to a volume on our host server (or an EBS volume on AWS). You can find all the options for the receiving volume in the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.13/#volume-v1-core" target="_blank" rel="nofollow noopener noreferrer">Kubernetes documentation</a>. We are going to use a <a href="https://kubernetes.io/docs/concepts/storage/volumes/#hostpath" target="_blank" rel="nofollow noopener noreferrer">hostPath</a> with the type <strong>DirectoryOrCreate</strong> - meaning that we don&#x27;t have to go into the host and create the directory first (it will be created if not existing):</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">3.6.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">stretch</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">volumeMounts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">storage</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> /data/db</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">storage      </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">hostPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)"># directory location on host</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> /mnt/kubernetes/mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)"># DirectoryOrCreate, Directory, FileOrCreate, File, etc.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> DirectoryOrCreate</span></div></pre><p>Apply those changes to your cluster and use the <code>describe</code> command to check if the mount was successful:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:815px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:113.00613496932516%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/d764fe9312a671cc9015cf9224e57601/8d3d1/kubernetes_microservices_14.webp 256w,/static/d764fe9312a671cc9015cf9224e57601/354cf/kubernetes_microservices_14.webp 512w,/static/d764fe9312a671cc9015cf9224e57601/16910/kubernetes_microservices_14.webp 815w" sizes="(max-width: 815px) 100vw, 815px" type="image/webp"/>
        <source srcSet="/static/d764fe9312a671cc9015cf9224e57601/b1806/kubernetes_microservices_14.png 256w,/static/d764fe9312a671cc9015cf9224e57601/7572d/kubernetes_microservices_14.png 512w,/static/d764fe9312a671cc9015cf9224e57601/0cfc2/kubernetes_microservices_14.png 815w" sizes="(max-width: 815px) 100vw, 815px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/d764fe9312a671cc9015cf9224e57601/0cfc2/kubernetes_microservices_14.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><p>From the event log at the bottom we can see that the container was deployed to <code>in-centos-minion2</code> (alternatively use <code>kubectl get pods -o wide</code> to list the nodes your pods are hosted on) - a quick check confirms that the volume <code>/mnt/kubernetes/mongodb</code> was created and MongoDB started to use it:</p><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:806px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:43.920595533498755%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/581e7d9eab1f1f03a4377a5e6a7783a4/8d3d1/kubernetes_microservices_15.webp 256w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/354cf/kubernetes_microservices_15.webp 512w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/84f92/kubernetes_microservices_15.webp 806w" sizes="(max-width: 806px) 100vw, 806px" type="image/webp"/>
        <source srcSet="/static/581e7d9eab1f1f03a4377a5e6a7783a4/b1806/kubernetes_microservices_15.png 256w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/7572d/kubernetes_microservices_15.png 512w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/01074/kubernetes_microservices_15.png 806w" sizes="(max-width: 806px) 100vw, 806px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/581e7d9eab1f1f03a4377a5e6a7783a4/01074/kubernetes_microservices_15.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><h3 id="using-persistentvolumeclaims"><a href="#using-persistentvolumeclaims" aria-label="using persistentvolumeclaims permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using PersistentVolumeClaims</h3><p>A <a href="https://kubernetes.io/docs/concepts/storage/volumes/#persistentvolumeclaim" target="_blank" rel="nofollow noopener noreferrer">persistentVolumeClaim</a> volume is used to mount a PersistentVolume into a Pod. PersistentVolumes are a way for users to “claim” durable storage (such as a GCE PersistentDisk or an iSCSI volume) without knowing the details of the particular cloud environment. This is just a minor change to our <code>mongo-stack.yaml</code> file:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> apps/v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Deployment</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">replicas</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">template</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongodb</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain">3.6.10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">stretch</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token key atrule">volumeMounts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">storage</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token key atrule">mountPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> /data/db</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">storage</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token key atrule">persistentVolumeClaim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token key atrule">claimName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">pvc</span></div></pre><p>The persistent volume is then configured in a separate configuration file we will call <code>storage.yaml</code> - this way, if we have to move our cluster to a new cloud provider we do not have to make any changes to the workload or service file:</p><pre class="prism-code language-yaml" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># What do want?</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> PersistentVolumeClaim</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># has to match the name you used as claimName!</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">pvc</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)"># linking the claim with the implementation below</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">storageClassName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mylocalstorage</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">accessModes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> ReadWriteOnce</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)"># Let Kubernetes find a node that offers at least the amount of storage</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">      </span><span class="token key atrule">storage</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 1Gi</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># How do we want it implemented</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> PersistentVolume</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> local</span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain">storage</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">storageClassName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> mylocalstorage</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">capacity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># create a storage claim for this amount - e.g. create a EBS volume on AWS</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">storage</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> 1Gi</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">accessModes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> ReadWriteOnce</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token key atrule">hostPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># directory location on host</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/mnt/kubernetes/mongodb-tracking-data&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># DirectoryOrCreate, Directory, FileOrCreate, File, etc.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> DirectoryOrCreate</span></div></pre><p>The <code>PersistentVolumeClaim</code> and <code>PersistentVolume</code> are matched up by the <code>storageClassName</code>. The cloud administrator has to create persistent storages based on available hardware (or cloud storage partitions). The web developer then creates a claim for storage with a certain capacity - so Kubernetes can search for a fitting volume among the available.</p><p>We choose the <code>storageClassName: mylocalstorage</code> - in production this would be something more useful. E.g. your pods really need very fast storage - so you can set a claim for a <strong>storageClassName</strong> that refers to high performance <em>SSD</em> storage.</p><p>Noteworthy also is the <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#access-modes" target="_blank" rel="nofollow noopener noreferrer">Access Mode</a> that can be:</p><ul><li>ReadWriteOnce – the volume can be mounted as read-write by a single node</li><li>ReadOnlyMany – the volume can be mounted read-only by many nodes</li><li>ReadWriteMany – the volume can be mounted as read-write by many nodes</li></ul><p>In the CLI, the access modes are abbreviated to:</p><ul><li>RWO - ReadWriteOnce</li><li>ROX - ReadOnlyMany</li><li>RWX - ReadWriteMany</li></ul><p>Once you done with the configuration, apply it and check if the pv (persistent volume) was created and bound to the MongoDB pod:</p><pre class="prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f storage.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl apply -f mongo-stack.yaml</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get </span><span class="token function" style="color:rgb(220, 220, 170)">pv</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">kubectl get pvc</span></div></pre><hr/><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:806px">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:43.920595533498755%;position:relative;bottom:0;left:0;background-size:cover;display:block"></span>
    <picture>
        <source srcSet="/static/581e7d9eab1f1f03a4377a5e6a7783a4/8d3d1/kubernetes_microservices_15.webp 256w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/354cf/kubernetes_microservices_15.webp 512w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/84f92/kubernetes_microservices_15.webp 806w" sizes="(max-width: 806px) 100vw, 806px" type="image/webp"/>
        <source srcSet="/static/581e7d9eab1f1f03a4377a5e6a7783a4/b1806/kubernetes_microservices_15.png 256w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/7572d/kubernetes_microservices_15.png 512w,/static/581e7d9eab1f1f03a4377a5e6a7783a4/01074/kubernetes_microservices_15.png 806w" sizes="(max-width: 806px) 100vw, 806px" type="image/png"/>
        <img class="gatsby-resp-image-image" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white" src="/static/581e7d9eab1f1f03a4377a5e6a7783a4/01074/kubernetes_microservices_15.png" alt="A Kubernetes Cluster &amp; Microservices" title=""/>
      </picture>
  </span></p><hr/><h2 id="cloud-deployment"><a href="#cloud-deployment" aria-label="cloud deployment permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cloud Deployment</h2><p>kubectl expose deployment webapp --type=LoadBalancer --name=exposed-webapp</p><p>Examples:</p><ul><li>Create a service for a replicated nginx, which serves on port 80 and connects to the containers on port 8000.
kubectl expose rc nginx --port=80 --target-port=8000</li><li>Create a service for a replication controller identified by type and name specified in &quot;nginx-controller.yaml&quot;,
which serves on port 80 and connects to the containers on port 8000.
kubectl expose -f nginx-controller.yaml --port=80 --target-port=8000
</li><li>Create a service for a pod valid-pod, which serves on port 444 with the name &quot;frontend&quot;
kubectl expose pod valid-pod --port=444 --name=frontend</li><li>Create a second service based on the above service, exposing the container port 8443 as port 443 with the name
&quot;nginx-https&quot;
kubectl expose service nginx --port=443 --target-port=8443 --name=nginx-https
</li><li>Create a service for a replicated streaming application on port 4100 balancing UDP traffic and named &#x27;video-stream&#x27;.
kubectl expose rc streamer --port=4100 --protocol=udp --name=video-stream</li><li>Create a service for a replicated nginx using replica set, which serves on port 80 and connects to the containers on
port 8000.
kubectl expose rs nginx --port=80 --target-port=8000
</li><li>Create a service for an nginx deployment, which serves on port 80 and connects to the containers on port 8000.
kubectl expose deployment nginx --port=80 --target-port=8000</li></ul></div><div class="PrevNext__Wrapper-sc-1vrmezv-0 lgLxVb"><div class="PrevNext__Prev-sc-1vrmezv-1 bvvdQI"><span>Previous</span><a href="/creating-a-kubernetes-cluster">Creating a Kubernetes Cluster</a></div><div class="PrevNext__Next-sc-1vrmezv-2 lhoXfM"><span>Next</span><a href="/kubernetes-cluster-monitoring-logging">Kubernetes Cluster Monitoring &amp; Logging</a></div></div></article></div><footer class="Layout__Footer-ktgjx5-0 hxugeV">© 2019 by Mike Polinowski<br/><a href="https://github.com/mpolinowski/">GitHub</a> <br/><span>Last build: <!-- -->2019-12-14</span></footer></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-76200392-4', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/kubernetes-and-microservices";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-d99d81405d6e68123448.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-328a2b7c20aa4ad52a6f.js"],"component---src-templates-post-jsx":["/component---src-templates-post-jsx-88bf0e40afdbabddf566.js"],"component---src-templates-category-jsx":["/component---src-templates-category-jsx-ca9bf5885fd868dd04f8.js"],"component---src-pages-caloric-burn-jsx":["/component---src-pages-caloric-burn-jsx-18dba9db0b27f98f3510.js"],"component---src-pages-categories-jsx":["/component---src-pages-categories-jsx-049481ee343a5a07924a.js"],"component---src-pages-creating-a-grafana-dashboard-jsx":["/component---src-pages-creating-a-grafana-dashboard-jsx-a66755dbf08c4ed76709.js"],"component---src-pages-curriculum-vitae-jsx":["/component---src-pages-curriculum-vitae-jsx-8525404441b70ae9cb29.js"],"component---src-pages-developing-software-in-china-jsx":["/component---src-pages-developing-software-in-china-jsx-ce623d7f6fa76ae5d841.js"],"component---src-pages-elasticsearch-kibana-jsx":["/component---src-pages-elasticsearch-kibana-jsx-fd649ec9565109147a56.js"],"component---src-pages-elasticsearch-react-example-jsx":["/component---src-pages-elasticsearch-react-example-jsx-e11b85551ff145d860e5.js"],"component---src-pages-express-generator-app-docker-jsx":["/component---src-pages-express-generator-app-docker-jsx-0a42d928334adee12173.js"],"component---src-pages-express-generator-dockerrized-jsx":["/component---src-pages-express-generator-dockerrized-jsx-7e807859648c9b475780.js"],"component---src-pages-first-openshift-3-cluster-jsx":["/component---src-pages-first-openshift-3-cluster-jsx-bce773a4ba2ac67cb6e7.js"],"component---src-pages-gatsby-reactstrap-jsx":["/component---src-pages-gatsby-reactstrap-jsx-805a5aa3dadc62b974c8.js"],"component---src-pages-gatsby-wiki-jsx":["/component---src-pages-gatsby-wiki-jsx-085ee3ee63b6015cd672.js"],"component---src-pages-google-analytics-amp-jsx":["/component---src-pages-google-analytics-amp-jsx-63d8514e575ca589720e.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-cbdf9f6f331f4561fb5a.js"],"component---src-pages-installing-openshift-3-on-centos-7-jsx":["/component---src-pages-installing-openshift-3-on-centos-7-jsx-ce2785d1b1ffda95eb63.js"],"component---src-pages-javascript-apis-and-ajax-jsx":["/component---src-pages-javascript-apis-and-ajax-jsx-15467025af210c453ee7.js"],"component---src-pages-kubernetes-cluster-logging-jsx":["/component---src-pages-kubernetes-cluster-logging-jsx-fe8683007f57bad00fd8.js"],"component---src-pages-machine-learning-with-python-jsx":["/component---src-pages-machine-learning-with-python-jsx-1c7cfc3ad596b9b93d80.js"],"component---src-pages-next-start-jsx":["/component---src-pages-next-start-jsx-4a23a0906d25a6de5646.js"],"component---src-pages-nginx-ingress-cert-manager-jsx":["/component---src-pages-nginx-ingress-cert-manager-jsx-42a82f138962150192bd.js"],"component---src-pages-nginx-node-security-jsx":["/component---src-pages-nginx-node-security-jsx-e40a1715c561e2f62940.js"],"component---src-pages-node-express-docker-container-jsx":["/component---src-pages-node-express-docker-container-jsx-cfbf1c24487ce7e83e74.js"],"component---src-pages-node-express-mongodb-jsx":["/component---src-pages-node-express-mongodb-jsx-aa8fe833808087d2d90f.js"],"component---src-pages-node-express-static-wiki-jsx":["/component---src-pages-node-express-static-wiki-jsx-6a1b2b22c43042edc536.js"],"component---src-pages-nodered-cryptocurrency-dashboard-jsx":["/component---src-pages-nodered-cryptocurrency-dashboard-jsx-721acc3a35339f020cbe.js"],"component---src-pages-nodered-dashboard-getting-started-jsx":["/component---src-pages-nodered-dashboard-getting-started-jsx-fbd15f296f3331f0fe0d.js"],"component---src-pages-nodered-getting-started-jsx":["/component---src-pages-nodered-getting-started-jsx-b828c80ff4efcba89c11.js"],"component---src-pages-nodered-http-connect-jsx":["/component---src-pages-nodered-http-connect-jsx-0a1c4cc71ab3e994190d.js"],"component---src-pages-nodered-mqtt-connect-jsx":["/component---src-pages-nodered-mqtt-connect-jsx-19c50e090452e6d5c3bc.js"],"component---src-pages-nodered-sqlite-jsx":["/component---src-pages-nodered-sqlite-jsx-eb6091605271bbd917ee.js"],"component---src-pages-openhab-2-mqtt-nodered-jsx":["/component---src-pages-openhab-2-mqtt-nodered-jsx-f3736ea093275ad1ddbd.js"],"component---src-pages-postgresql-getting-started-jsx":["/component---src-pages-postgresql-getting-started-jsx-8c5041c1ac37b65a80ee.js"],"component---src-pages-python-ssh-logger-jsx":["/component---src-pages-python-ssh-logger-jsx-7d0a95fcd8236106d580.js"],"component---src-pages-react-transition-group-demo-jsx":["/component---src-pages-react-transition-group-demo-jsx-9d3122f8e037f83937bf.js"],"component---src-pages-reactive-material-jsx":["/component---src-pages-reactive-material-jsx-adf5194424fd5e5c83bc.js"],"component---src-pages-red-hat-certified-engineer-rhce-jsx":["/component---src-pages-red-hat-certified-engineer-rhce-jsx-50968f84517f2ee482e2.js"],"component---src-pages-red-hat-containerized-application-development-rhcs-jsx":["/component---src-pages-red-hat-containerized-application-development-rhcs-jsx-851f6f1ddd2297cd6f58.js"],"component---src-pages-securing-elasticsearch-readonlyrest-jsx":["/component---src-pages-securing-elasticsearch-readonlyrest-jsx-11eddedc32c62fcf0766.js"],"component---src-pages-securing-elasticsearch-xpack-jsx":["/component---src-pages-securing-elasticsearch-xpack-jsx-d5c36b3f964a7ab3dc2a.js"],"component---src-pages-server-side-render-react-router-jsx":["/component---src-pages-server-side-render-react-router-jsx-112da0c476f74af61eaf.js"],"component---src-pages-umlaute-on-us-keyboard-jsx":["/component---src-pages-umlaute-on-us-keyboard-jsx-c9c845292164b1266eb6.js"],"component---src-pages-windows-10-control-jsx":["/component---src-pages-windows-10-control-jsx-afb90bc1c9fc4dee8697.js"],"component---src-pages-zigbee-2-mqtt-xiaomi-fhem-jsx":["/component---src-pages-zigbee-2-mqtt-xiaomi-fhem-jsx-35ca514a2ff08a02d03d.js"]};/*]]>*/</script><script src="/component---src-templates-post-jsx-88bf0e40afdbabddf566.js" async=""></script><script src="/commons-99565a21e6c752f21563.js" async=""></script><script src="/app-d99d81405d6e68123448.js" async=""></script><script src="/styles-7d42529fada194e095c0.js" async=""></script><script src="/webpack-runtime-21874df8409d87262c36.js" async=""></script></body></html>