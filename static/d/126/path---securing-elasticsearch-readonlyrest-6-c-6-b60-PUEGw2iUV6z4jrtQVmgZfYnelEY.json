{"data":{"post":{"id":"c6aded51-2238-5ddd-b8de-b1a814a2740e","html":"<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d8eb999ae7de5ced143e3fe98f41cc76/b721b/photo-15514459555_50b13064fa_o.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 38.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAACRklEQVQozxWQ20+SAQDFvz+kx17KrXJZahqpeFdMRRIhFLloOQQ/vIWo8AkKqMsrqKihiDMvSyunbWW5LNt8sctay7X50u2l/oVfXw9n52xnO2fnCAbvPhkNT0kzbZFav0mKjGTjFpdNm6RbN7lqkblxm2tNu1x3PEfZtk9OxwF5Xe/I7z5CHzrGOf0Zb/yE6PYpQoElgtbzitKOPfLElxSKz6h27VDY+gKFeEB2+1tyO99Q0HVIcc8Rqr5jyvs/oQ5+oW70G0PrP9g6/Et87w+B9V8IZ84rUVbaKKkfoLJxEJ3VhaXRicnej861Rl3vI2qCR+hGvlI7cYp5+ju2Bz+R1n6ztHPCRGyb4cgG0ZXXTK2/R0hVlHLu0g3OXsjhikJFtVaP2WzCarXSYncg2p14PAGk+wkGZ3cJb3wk9vgDCys7RCPjtIoiaVmV6Ax3qDE6EPKLylBX3UJVXkF6Vj6FZRrEFhsWObS9rQW320XQ72HQ10N0PERiboKZ8BDRyX6WZoKsLo4zNurD53fgk8wImZkpFKtyqdAUcVNTSK1Jj8Mp4pBD/b12fDJGgm4WpiRWYiGerEVYTYywvhQgHnURm77H8qKfnoCIJNUgKLOTUCiS0GlLcDpMuDv/T9XLWktAaibY10Sfx8jYsI3EvJf4nER4zM7MWAPzYZtc1MHyXBcPY7IX9SNUqDIoKbiIuiwZo05Bc2Mxd80FdIkagr1G/N1GOp1qpO7b+L1GBiQDIZ+BuUmRxKyL+EyrXFglX2JjfmKAf2Chh2qTwi3VAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"Battambang, Cambodia\"\n        title=\"\"\n        src=\"/static/d8eb999ae7de5ced143e3fe98f41cc76/b21dd/photo-15514459555_50b13064fa_o.png\"\n        srcset=\"/static/d8eb999ae7de5ced143e3fe98f41cc76/2d451/photo-15514459555_50b13064fa_o.png 200w,\n/static/d8eb999ae7de5ced143e3fe98f41cc76/06807/photo-15514459555_50b13064fa_o.png 400w,\n/static/d8eb999ae7de5ced143e3fe98f41cc76/b21dd/photo-15514459555_50b13064fa_o.png 800w,\n/static/d8eb999ae7de5ced143e3fe98f41cc76/c9309/photo-15514459555_50b13064fa_o.png 1200w,\n/static/d8eb999ae7de5ced143e3fe98f41cc76/b721b/photo-15514459555_50b13064fa_o.png 1500w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<!-- TOC -->\n<ul>\n<li>\n<p><a href=\"#securing-elasticsearch-with-readonlyrest\">Securing Elasticsearch with ReadonlyREST</a></p>\n<ul>\n<li><a href=\"#install-elasticsearch\">Install Elasticsearch</a></li>\n<li><a href=\"#install-kibana\">Install Kibana</a></li>\n<li><a href=\"#secure-elasticsearch\">Secure Elasticsearch</a></li>\n<li><a href=\"#securing-kibana\">Securing Kibana</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<h2 id=\"securing-elasticsearch-with-readonlyrest\"><a href=\"#securing-elasticsearch-with-readonlyrest\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Securing Elasticsearch with ReadonlyREST</h2>\n<p>Neither <a href=\"https://www.elastic.co/downloads/elasticsearch\">Elasticsearch</a> nor <a href=\"https://www.elastic.co/downloads/kibana\">Kibana</a> offer a user authentication. In earlier <a href=\"https://github.com/mpolinowski/express-static\">Projects</a> we circumvented this issue by blocking all access - only allowing our Website and Kibana to access the database via localhost.</p>\n<p>But now we need an anonymous user account that is only allowed to Request and Read search results - while Writing to the database is forbidden.</p>\n<p>Elastic offer their own solution for it called <a href=\"https://www.elastic.co/downloads/x-pack\">X-Pack</a> (On how to set it up - <a href=\"https://mpolinowski.github.io/nginx-node-elasticsearch/\">read more</a>) - which is a premium extension to the ELK stack and nobody seems to know how much it would cost to buy it. But as the wise man from the vintage sport car dealership knows - if you have to ask for the prize, you cannot afford it anyway. So are there free solutions out there?</p>\n<p>Yes! Searching for alternatives lead me to 2 solutions that are mentioned often - there are more if you keep searching:</p>\n<ol>\n<li><a href=\"https://github.com/sscarduzio/elasticsearch-readonlyrest-plugin\">ReadOnlyREST</a></li>\n<li><a href=\"https://github.com/floragunncom/search-guard\">SearchGuard</a></li>\n</ol>\n<p>Today we are going to set up the first of them. The first thing I noticed is, that those plugins are written for the exact Version number of Elasticsearch. The newest version of RestOnlyREST supports Elasticsearch Version 6.2.3 - I am using 6.2.4, which unfortunately means that I have to downgrade my ES version… and since there is no downgrade option with ES, I have to shut off the service and go in manually to delete every folder that ES has generated on my CentOS server (really ? That is the only option that I could find online.. but it is really a mess…).</p>\n<h3 id=\"install-elasticsearch\"><a href=\"#install-elasticsearch\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install Elasticsearch</h3>\n<p><strong>I. Download and install the public signing key</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"> rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch</code></pre></div>\n<p><strong>II. Add the following in your /etc/yum.repos.d/ directory in a file with a .repo suffix, for example elasticsearch.repo</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">[elasticsearch-6.x]\nname=Elasticsearch repository for 6.x packages\nbaseurl=https://artifacts.elastic.co/packages/6.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md</code></pre></div>\n<p><strong>III. Install a specific version of Elasticsearch</strong></p>\n<p>ReadOnlyREST requires us to install a specific version (6.2.3) of Elasticsearch. Let’s check what versions are available to install (CentOS/yum):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yum --showduplicates list elasticsearch <span class=\"token operator\">|</span> <span class=\"token function\">expand</span>\nInstalled Packages\nelasticsearch.noarch                 6.2.4-1                  @elasticsearch-6.x\nAvailable Packages\nelasticsearch.noarch                 6.0.0-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.0.0-1                  kibana-6.x\nelasticsearch.noarch                 6.0.1-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.0.1-1                  kibana-6.x\nelasticsearch.noarch                 6.1.0-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.0-1                  kibana-6.x\nelasticsearch.noarch                 6.1.1-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.1-1                  kibana-6.x\nelasticsearch.noarch                 6.1.2-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.2-1                  kibana-6.x\nelasticsearch.noarch                 6.1.3-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.3-1                  kibana-6.x\nelasticsearch.noarch                 6.1.4-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.4-1                  kibana-6.x\nelasticsearch.noarch                 6.2.0-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.0-1                  kibana-6.x\nelasticsearch.noarch                 6.2.1-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.1-1                  kibana-6.x\nelasticsearch.noarch                 6.2.2-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.2-1                  kibana-6.x\nelasticsearch.noarch                 6.2.3-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.3-1                  kibana-6.x\nelasticsearch.noarch                 6.2.4-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.4-1                  kibana-6.x</code></pre></div>\n<p>To install the version 6.2.3 of elasticsearch type:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> elasticsearch-6.2.3-1</code></pre></div>\n<p>Here I ran into issues due to the messy uninstall of the earlier (newer) version of Elasticsearch - <strong>if someone knows a cleaner way to do this, please tell :)</strong></p>\n<p>Yum still had the older version in its DB leading to an “package already installed. Checking for update. Nothing to do” error. This can be fixed by:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rpm -e --justdb --nodeps elasticsearch\nrpm -e --justdb --nodeps kibana</code></pre></div>\n<p>Now re-run the install command above:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> elasticsearch-6.2.3-1\nDependencies Resolved\n\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\n Package                  Arch              Version              Repository                    Size\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nInstalling:\n elasticsearch            noarch            6.2.3-1              elasticsearch-6.x             28 M\n\nTransaction Summary\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nInstall  1 Package\n\nTotal download size: 28 M\nInstalled size: 31 M\nIs this ok <span class=\"token punctuation\">[</span>y/d/N<span class=\"token punctuation\">]</span>:y</code></pre></div>\n<p><strong>IV. Restrict access to your Elasticsearch instance</strong></p>\n<p>To configure Elasticsearch open the following file inside your text editor: <em>/etc/elasticsearch/elasticsearch.yml</em>. We want to limit access to localhost and a public domain that we are going to configure in NGINX. This can be done with the variable <strong>network.host</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"># ---------------------------------- Network -----------------------------------\n#\n# Set the bind address to a specific IP (IPv4 or IPv6):\n#\nnetwork.host: 127.0.0.1, my.domain.com\n#\n# Set a custom port for HTTP:\n#\nhttp.port: 9200</code></pre></div>\n<p>The HTTP port 9200 is the default port and should be changed - but we are only going to use it on localhost. NGINX will take care of it on the outside - so we will just leave it at it’s default value. The webserver will also add a security layer to our app - which means, we will need to enable <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\">CORS header</a> for the transaction. Add the following lines below the Network Block:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"># --------------------------------- CORS ----------------------------------\n#\n#\n#http.cors:\n#  enabled: true\n#  allow-origin: /https?:\\/\\/my.domain.com(:[0-9]+)?/\nhttp.cors:\n enabled: true\n allow-origin: /https?:\\/\\/my.domain.com(:[0-9][0-9][0-9][0-9])?/</code></pre></div>\n<p>Both examples above allow Cross-Origin Resource Sharing for your domain on every available port - but for some reasons the first regular expression stopped to work in Elasticsearch 6.2.x. You just need one of them.</p>\n<p><strong>V. Set up the Elasticsearch Service</strong></p>\n<p>To configure Elasticsearch to start automatically when the system boots up, run the following commands:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo /bin/systemctl daemon-reload\nsudo /bin/systemctl enable elasticsearch.service</code></pre></div>\n<p>Elasticsearch can be started and stopped as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo systemctl start elasticsearch.service\nsudo systemctl stop elasticsearch.service</code></pre></div>\n<h3 id=\"install-kibana\"><a href=\"#install-kibana\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install Kibana</h3>\n<p>Since we installed a specific version (6.2.3) of Elasticsearch we now need to install the same version of the admin panel Kibana. First Create and edit a new yum repository file for Kibana in <em>/etc/yum.repos.d/kibana.repo</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">[kibana-6.x]\nname=Kibana repository for 6.x packages\nbaseurl=https://artifacts.elastic.co/packages/6.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md</code></pre></div>\n<p>Then install the correct version as listed earlier:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yum <span class=\"token function\">install</span> kibana-6.2.3-1</code></pre></div>\n<p>Now set the Elasticsearch Connection URL for Kibana in <em>/etc/kibana/kibana.yml</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">elasticsearch.url: &quot;http://localhost:9200&quot;</code></pre></div>\n<p>To configure Kibana to start automatically when the system boots up, run the following commands:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> /bin/systemctl daemon-reload\n<span class=\"token function\">sudo</span> /bin/systemctl <span class=\"token function\">enable</span> kibana.service</code></pre></div>\n<p>Kibana can be started and stopped as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo systemctl start kibana.service\nsudo systemctl stop kibana.service</code></pre></div>\n<h3 id=\"secure-elasticsearch\"><a href=\"#secure-elasticsearch\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Secure Elasticsearch</h3>\n<p>Now we can install RestOnlyREST to secure the database. First <a href=\"https://readonlyrest.com/download.html\">download</a> the correct package for the installed version of Elasticsearch and place it inside the <em>./tmp</em> directory.</p>\n<p>First set up the configuration file in <em>/etc/elasticsearch/readonlyrest.yml</em> to allow all access from localhost (required by Kibana) and restrict outside access to specific indices to read only:</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">readonlyrest:\n    #optional\n    response_if_req_forbidden: Sorry, your request is forbidden.\n    \n    access_control_rules:\n\n    - name: Accept all requests from localhost\n      hosts: [127.0.0.1]\n\n    - name: Just certain indices, and read only\n      actions: [&quot;indices:data/read/*&quot;]\n      indices: [&quot;all_my_public_indices_start_with*&quot;] # index aliases are taken in account!</code></pre></div>\n<p>Then install the plugin to the elasticsearch plugin directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> /usr/share/elasticsearch/bin\n./elasticsearch-plugin <span class=\"token function\">install</span> file:///tmp/readonlyrest-1.16.18_es6.2.3.zip\n\n-<span class=\"token operator\">></span> Downloading file:///tmp/readonlyrest-1.16.18_es6.2.3.zip\n<span class=\"token punctuation\">[</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span><span class=\"token punctuation\">]</span> 100%  \n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@     WARNING: plugin requires additional permissions     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n* java.io.FilePermission <span class=\"token operator\">&lt;&lt;</span> ALL FILES <span class=\"token operator\">>></span> <span class=\"token function\">read</span>\n* java.lang.RuntimePermission accessDeclaredMembers\n* java.lang.RuntimePermission getClassLoader\n* java.lang.reflect.ReflectPermission suppressAccessChecks\n* java.net.SocketPermission * connect,accept,resolve\n* java.security.SecurityPermission getProperty.ssl.KeyManagerFactory.algorithm\n* java.util.PropertyPermission * read,write\nSee http://docs.oracle.com/javase/8/docs/technotes/guides/security/permissions.html\n<span class=\"token keyword\">for</span> descriptions of what these permissions allow and the associated risks.\n\nContinue with installation? <span class=\"token punctuation\">[</span>y/N<span class=\"token punctuation\">]</span>y\n-<span class=\"token operator\">></span> Installed readonlyrest</code></pre></div>\n<h3 id=\"securing-kibana\"><a href=\"#securing-kibana\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Securing Kibana</h3>\n<p>Remember to <a href=\"/nginx-node-security/\">secure Kibana with NGINX</a>, since it is not protected by the free version of ReadOnlyREST!</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/d8eb999ae7de5ced143e3fe98f41cc76/b721b/photo-15514459555_50b13064fa_o.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 38.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAACRklEQVQozxWQ20+SAQDFvz+kx17KrXJZahqpeFdMRRIhFLloOQQ/vIWo8AkKqMsrqKihiDMvSyunbWW5LNt8sctay7X50u2l/oVfXw9n52xnO2fnCAbvPhkNT0kzbZFav0mKjGTjFpdNm6RbN7lqkblxm2tNu1x3PEfZtk9OxwF5Xe/I7z5CHzrGOf0Zb/yE6PYpQoElgtbzitKOPfLElxSKz6h27VDY+gKFeEB2+1tyO99Q0HVIcc8Rqr5jyvs/oQ5+oW70G0PrP9g6/Et87w+B9V8IZ84rUVbaKKkfoLJxEJ3VhaXRicnej861Rl3vI2qCR+hGvlI7cYp5+ju2Bz+R1n6ztHPCRGyb4cgG0ZXXTK2/R0hVlHLu0g3OXsjhikJFtVaP2WzCarXSYncg2p14PAGk+wkGZ3cJb3wk9vgDCys7RCPjtIoiaVmV6Ax3qDE6EPKLylBX3UJVXkF6Vj6FZRrEFhsWObS9rQW320XQ72HQ10N0PERiboKZ8BDRyX6WZoKsLo4zNurD53fgk8wImZkpFKtyqdAUcVNTSK1Jj8Mp4pBD/b12fDJGgm4WpiRWYiGerEVYTYywvhQgHnURm77H8qKfnoCIJNUgKLOTUCiS0GlLcDpMuDv/T9XLWktAaibY10Sfx8jYsI3EvJf4nER4zM7MWAPzYZtc1MHyXBcPY7IX9SNUqDIoKbiIuiwZo05Bc2Mxd80FdIkagr1G/N1GOp1qpO7b+L1GBiQDIZ+BuUmRxKyL+EyrXFglX2JjfmKAf2Chh2qTwi3VAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"Battambang, Cambodia","title":"","src":"/static/d8eb999ae7de5ced143e3fe98f41cc76/b21dd/photo-15514459555_50b13064fa_o.png","srcSet":["/static/d8eb999ae7de5ced143e3fe98f41cc76/2d451/photo-15514459555_50b13064fa_o.png 200w","/static/d8eb999ae7de5ced143e3fe98f41cc76/06807/photo-15514459555_50b13064fa_o.png 400w","/static/d8eb999ae7de5ced143e3fe98f41cc76/b21dd/photo-15514459555_50b13064fa_o.png 800w","/static/d8eb999ae7de5ced143e3fe98f41cc76/c9309/photo-15514459555_50b13064fa_o.png 1200w","/static/d8eb999ae7de5ced143e3fe98f41cc76/b721b/photo-15514459555_50b13064fa_o.png 1500w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"comment","value":" TOC "},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#securing-elasticsearch-with-readonlyrest"},"children":[{"type":"text","value":"Securing Elasticsearch with ReadonlyREST"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#install-elasticsearch"},"children":[{"type":"text","value":"Install Elasticsearch"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#install-kibana"},"children":[{"type":"text","value":"Install Kibana"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#secure-elasticsearch"},"children":[{"type":"text","value":"Secure Elasticsearch"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#securing-kibana"},"children":[{"type":"text","value":"Securing Kibana"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"comment","value":" /TOC "},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"securing-elasticsearch-with-readonlyrest"},"children":[{"type":"element","tagName":"a","properties":{"href":"#securing-elasticsearch-with-readonlyrest","ariaHidden":true,"className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Securing Elasticsearch with ReadonlyREST"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Neither "},{"type":"element","tagName":"a","properties":{"href":"https://www.elastic.co/downloads/elasticsearch"},"children":[{"type":"text","value":"Elasticsearch"}]},{"type":"text","value":" nor "},{"type":"element","tagName":"a","properties":{"href":"https://www.elastic.co/downloads/kibana"},"children":[{"type":"text","value":"Kibana"}]},{"type":"text","value":" offer a user authentication. In earlier "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/mpolinowski/express-static"},"children":[{"type":"text","value":"Projects"}]},{"type":"text","value":" we circumvented this issue by blocking all access - only allowing our Website and Kibana to access the database via localhost."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"But now we need an anonymous user account that is only allowed to Request and Read search results - while Writing to the database is forbidden."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Elastic offer their own solution for it called "},{"type":"element","tagName":"a","properties":{"href":"https://www.elastic.co/downloads/x-pack"},"children":[{"type":"text","value":"X-Pack"}]},{"type":"text","value":" (On how to set it up - "},{"type":"element","tagName":"a","properties":{"href":"https://mpolinowski.github.io/nginx-node-elasticsearch/"},"children":[{"type":"text","value":"read more"}]},{"type":"text","value":") - which is a premium extension to the ELK stack and nobody seems to know how much it would cost to buy it. But as the wise man from the vintage sport car dealership knows - if you have to ask for the prize, you cannot afford it anyway. So are there free solutions out there?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yes! Searching for alternatives lead me to 2 solutions that are mentioned often - there are more if you keep searching:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/sscarduzio/elasticsearch-readonlyrest-plugin"},"children":[{"type":"text","value":"ReadOnlyREST"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/floragunncom/search-guard"},"children":[{"type":"text","value":"SearchGuard"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Today we are going to set up the first of them. The first thing I noticed is, that those plugins are written for the exact Version number of Elasticsearch. The newest version of RestOnlyREST supports Elasticsearch Version 6.2.3 - I am using 6.2.4, which unfortunately means that I have to downgrade my ES version… and since there is no downgrade option with ES, I have to shut off the service and go in manually to delete every folder that ES has generated on my CentOS server (really ? That is the only option that I could find online.. but it is really a mess…)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"install-elasticsearch"},"children":[{"type":"element","tagName":"a","properties":{"href":"#install-elasticsearch","ariaHidden":true,"className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Install Elasticsearch"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"I. Download and install the public signing key"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":" rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"II. Add the following in your /etc/yum.repos.d/ directory in a file with a .repo suffix, for example elasticsearch.repo"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"text","value":"[elasticsearch-6.x]\nname=Elasticsearch repository for 6.x packages\nbaseurl=https://artifacts.elastic.co/packages/6.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"III. Install a specific version of Elasticsearch"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ReadOnlyREST requires us to install a specific version (6.2.3) of Elasticsearch. Let’s check what versions are available to install (CentOS/yum):"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"yum --showduplicates list elasticsearch "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"|"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"expand"}]},{"type":"text","value":"\nInstalled Packages\nelasticsearch.noarch                 6.2.4-1                  @elasticsearch-6.x\nAvailable Packages\nelasticsearch.noarch                 6.0.0-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.0.0-1                  kibana-6.x\nelasticsearch.noarch                 6.0.1-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.0.1-1                  kibana-6.x\nelasticsearch.noarch                 6.1.0-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.0-1                  kibana-6.x\nelasticsearch.noarch                 6.1.1-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.1-1                  kibana-6.x\nelasticsearch.noarch                 6.1.2-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.2-1                  kibana-6.x\nelasticsearch.noarch                 6.1.3-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.3-1                  kibana-6.x\nelasticsearch.noarch                 6.1.4-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.1.4-1                  kibana-6.x\nelasticsearch.noarch                 6.2.0-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.0-1                  kibana-6.x\nelasticsearch.noarch                 6.2.1-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.1-1                  kibana-6.x\nelasticsearch.noarch                 6.2.2-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.2-1                  kibana-6.x\nelasticsearch.noarch                 6.2.3-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.3-1                  kibana-6.x\nelasticsearch.noarch                 6.2.4-1                  elasticsearch-6.x\nelasticsearch.noarch                 6.2.4-1                  kibana-6.x"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To install the version 6.2.3 of elasticsearch type:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"yum "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" elasticsearch-6.2.3-1"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here I ran into issues due to the messy uninstall of the earlier (newer) version of Elasticsearch - "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"if someone knows a cleaner way to do this, please tell :)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yum still had the older version in its DB leading to an “package already installed. Checking for update. Nothing to do” error. This can be fixed by:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"rpm -e --justdb --nodeps elasticsearch\nrpm -e --justdb --nodeps kibana"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now re-run the install command above:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"yum "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" elasticsearch-6.2.3-1\nDependencies Resolved\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"text","value":"\n Package                  Arch              Version              Repository                    Size\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"text","value":"\nInstalling:\n elasticsearch            noarch            6.2.3-1              elasticsearch-6.x             28 M\n\nTransaction Summary\n"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"text","value":"\nInstall  1 Package\n\nTotal download size: 28 M\nInstalled size: 31 M\nIs this ok "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"y/d/N"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":":y"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"IV. Restrict access to your Elasticsearch instance"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To configure Elasticsearch open the following file inside your text editor: "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"/etc/elasticsearch/elasticsearch.yml"}]},{"type":"text","value":". We want to limit access to localhost and a public domain that we are going to configure in NGINX. This can be done with the variable "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"network.host"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"text","value":"# ---------------------------------- Network -----------------------------------\n#\n# Set the bind address to a specific IP (IPv4 or IPv6):\n#\nnetwork.host: 127.0.0.1, my.domain.com\n#\n# Set a custom port for HTTP:\n#\nhttp.port: 9200"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The HTTP port 9200 is the default port and should be changed - but we are only going to use it on localhost. NGINX will take care of it on the outside - so we will just leave it at it’s default value. The webserver will also add a security layer to our app - which means, we will need to enable "},{"type":"element","tagName":"a","properties":{"href":"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"},"children":[{"type":"text","value":"CORS header"}]},{"type":"text","value":" for the transaction. Add the following lines below the Network Block:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"text","value":"# --------------------------------- CORS ----------------------------------\n#\n#\n#http.cors:\n#  enabled: true\n#  allow-origin: /https?:\\/\\/my.domain.com(:[0-9]+)?/\nhttp.cors:\n enabled: true\n allow-origin: /https?:\\/\\/my.domain.com(:[0-9][0-9][0-9][0-9])?/"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Both examples above allow Cross-Origin Resource Sharing for your domain on every available port - but for some reasons the first regular expression stopped to work in Elasticsearch 6.2.x. You just need one of them."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"V. Set up the Elasticsearch Service"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To configure Elasticsearch to start automatically when the system boots up, run the following commands:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"sudo /bin/systemctl daemon-reload\nsudo /bin/systemctl enable elasticsearch.service"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Elasticsearch can be started and stopped as follows:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"sudo systemctl start elasticsearch.service\nsudo systemctl stop elasticsearch.service"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"install-kibana"},"children":[{"type":"element","tagName":"a","properties":{"href":"#install-kibana","ariaHidden":true,"className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Install Kibana"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Since we installed a specific version (6.2.3) of Elasticsearch we now need to install the same version of the admin panel Kibana. First Create and edit a new yum repository file for Kibana in "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"/etc/yum.repos.d/kibana.repo"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"text","value":"[kibana-6.x]\nname=Kibana repository for 6.x packages\nbaseurl=https://artifacts.elastic.co/packages/6.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then install the correct version as listed earlier:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"yum "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" kibana-6.2.3-1"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now set the Elasticsearch Connection URL for Kibana in "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"/etc/kibana/kibana.yml"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"text","value":"elasticsearch.url: \"http://localhost:9200\""}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To configure Kibana to start automatically when the system boots up, run the following commands:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" /bin/systemctl daemon-reload\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" /bin/systemctl "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"enable"}]},{"type":"text","value":" kibana.service"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kibana can be started and stopped as follows:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"sudo systemctl start kibana.service\nsudo systemctl stop kibana.service"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"secure-elasticsearch"},"children":[{"type":"element","tagName":"a","properties":{"href":"#secure-elasticsearch","ariaHidden":true,"className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Secure Elasticsearch"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we can install RestOnlyREST to secure the database. First "},{"type":"element","tagName":"a","properties":{"href":"https://readonlyrest.com/download.html"},"children":[{"type":"text","value":"download"}]},{"type":"text","value":" the correct package for the installed version of Elasticsearch and place it inside the "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"./tmp"}]},{"type":"text","value":" directory."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"First set up the configuration file in "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"/etc/elasticsearch/readonlyrest.yml"}]},{"type":"text","value":" to allow all access from localhost (required by Kibana) and restrict outside access to specific indices to read only:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yml"]},"children":[{"type":"text","value":"readonlyrest:\n    #optional\n    response_if_req_forbidden: Sorry, your request is forbidden.\n    \n    access_control_rules:\n\n    - name: Accept all requests from localhost\n      hosts: [127.0.0.1]\n\n    - name: Just certain indices, and read only\n      actions: [\"indices:data/read/*\"]\n      indices: [\"all_my_public_indices_start_with*\"] # index aliases are taken in account!"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then install the plugin to the elasticsearch plugin directory:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"cd"}]},{"type":"text","value":" /usr/share/elasticsearch/bin\n./elasticsearch-plugin "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" file:///tmp/readonlyrest-1.16.18_es6.2.3.zip\n\n-"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" Downloading file:///tmp/readonlyrest-1.16.18_es6.2.3.zip\n"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"=="}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":" 100%  \n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@     WARNING: plugin requires additional permissions     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n* java.io.FilePermission "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"<<"}]},{"type":"text","value":" ALL FILES "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">>"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"read"}]},{"type":"text","value":"\n* java.lang.RuntimePermission accessDeclaredMembers\n* java.lang.RuntimePermission getClassLoader\n* java.lang.reflect.ReflectPermission suppressAccessChecks\n* java.net.SocketPermission * connect,accept,resolve\n* java.security.SecurityPermission getProperty.ssl.KeyManagerFactory.algorithm\n* java.util.PropertyPermission * read,write\nSee http://docs.oracle.com/javase/8/docs/technotes/guides/security/permissions.html\n"},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"for"}]},{"type":"text","value":" descriptions of what these permissions allow and the associated risks.\n\nContinue with installation? "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"y/N"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"y\n-"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":">"}]},{"type":"text","value":" Installed readonlyrest"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"securing-kibana"},"children":[{"type":"element","tagName":"a","properties":{"href":"#securing-kibana","ariaHidden":true,"className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Securing Kibana"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Remember to "},{"type":"element","tagName":"a","properties":{"href":"/nginx-node-security/"},"children":[{"type":"text","value":"secure Kibana with NGINX"}]},{"type":"text","value":", since it is not protected by the free version of ReadOnlyREST!"}]}],"data":{"quirksMode":false}},"fields":{"slug":"/securing-elasticsearch-readonlyrest/","prefix":"2018-01-01"},"frontmatter":{"title":"Securing Elasticsearch with ReadOnlyREST","subTitle":"Elasticsearch doesn't have a basic user authentication - a problem!","cover":{"childImageSharp":{"resize":{"src":"/static/5cafdd7be072f038d3f17c0f4b38fade/f2a5a/photo-15514459555_50b13064fa_o-cover.png"}}}}},"author":{"id":"a72f1dd6-324a-57c6-ba3f-8d83b2b423ee","html":"<p><strong>Mike Polinowski</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\"/contact/\">contact me</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. :hearts:</p>"},"footnote":{"id":"54cf7902-3197-5bb5-bfe3-c36e8dd43f48","html":"<ul>\n<li>This is a personal Developer Blog</li>\n<li>Ξ</li>\n<li>built by <a href=\"https://github.com/mpolinowski\">Mike Polinowski</a></li>\n<li>Ξ</li>\n<li>with <a href=\"https://www.gatsbyjs.org/\">Gatsby</a> &#x26; <a href=\"https://reactjs.org\">React</a></li>\n<li>Ξ</li>\n<li>source code on <a href=\"https://github.com/mpolinowski/mpolinowski.github.io\">GitHub</a></li>\n<li>Ξ</li>\n<li>deliverd by <a href=\"https://pages.github.com\">Github Pages</a></li>\n<li>Ξ</li>\n<li>photos from <a href=\"https://www.flickr.com/people/149680084@N06/\">Flickr</a></li>\n</ul>"}},"pageContext":{"slug":"/securing-elasticsearch-readonlyrest/"}}