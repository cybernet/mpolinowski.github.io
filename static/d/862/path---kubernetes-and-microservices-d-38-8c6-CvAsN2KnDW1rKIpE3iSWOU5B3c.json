{"data":{"post":{"id":"91142a22-26c6-5e86-9864-a5992a27c9f4","html":"<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/250f352f8408a5aa47641f30724d572e/283d3/photo-34364880182_fe2d33582b_o.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 46.50801862390067%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAGHa1SMJyj/xAAaEAEAAgMBAAAAAAAAAAAAAAABAAIDIjM0/9oACAEBAAEFAqix1bBK+jN1n//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAgEBPwFUf//EABoQAAICAwAAAAAAAAAAAAAAAAABAhAhMUH/2gAIAQEABj8Cy0bRwRKv/8QAHRAAAgICAwEAAAAAAAAAAAAAAAERIUGxMVFxof/aAAgBAQABPyFBNrsoQvF4GWnKyuHZo6PqMLw//9oADAMBAAIAAwAAABCr3//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAwEBPxBRMtv/xAAXEQADAQAAAAAAAAAAAAAAAAAAARFR/9oACAECAQE/EFoRH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAIRFBkaEQYYH/2gAIAQEAAT8QGiGjLzs9RtEbCccuYIgAgU+zq+AHpT//2Q=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"Sydney, Australia\"\n        title=\"\"\n        src=\"/static/250f352f8408a5aa47641f30724d572e/78f2b/photo-34364880182_fe2d33582b_o.jpg\"\n        srcset=\"/static/250f352f8408a5aa47641f30724d572e/dce19/photo-34364880182_fe2d33582b_o.jpg 200w,\n/static/250f352f8408a5aa47641f30724d572e/c1413/photo-34364880182_fe2d33582b_o.jpg 400w,\n/static/250f352f8408a5aa47641f30724d572e/78f2b/photo-34364880182_fe2d33582b_o.jpg 800w,\n/static/250f352f8408a5aa47641f30724d572e/ab4c4/photo-34364880182_fe2d33582b_o.jpg 1200w,\n/static/250f352f8408a5aa47641f30724d572e/bc99b/photo-34364880182_fe2d33582b_o.jpg 1600w,\n/static/250f352f8408a5aa47641f30724d572e/283d3/photo-34364880182_fe2d33582b_o.jpg 1933w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<!-- TOC -->\n<ul>\n<li>\n<p><a href=\"#domain-driven-design-and-boundedcontext\">Domain Driven Design and boundedContext</a></p>\n<ul>\n<li><a href=\"#deploying-the-queue\">Deploying the Queue</a></li>\n<li><a href=\"#deploying-the-position-simulator\">Deploying the Position Simulator</a></li>\n<li><a href=\"#how-to-debug-a-failed-deployment\">How to Debug a failed Deployment</a></li>\n<li><a href=\"#deploying-the-position-tracker\">Deploying the Position Tracker</a></li>\n<li><a href=\"#deploying-the-api-gateway\">Deploying the API Gateway</a></li>\n<li><a href=\"#deploying-the-angular-frontend\">Deploying the Angular Frontend</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<h2 id=\"domain-driven-design-and-boundedcontext\"><a href=\"#domain-driven-design-and-boundedcontext\" aria-label=\"domain driven design and boundedcontext permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Domain Driven Design and boundedContext</h2>\n<p>A Microservice architecture is an implementation of the <a href=\"https://martinfowler.com/tags/domain%20driven%20design.html\">Domain Drive Design</a> principle and <a href=\"https://martinfowler.com/bliki/BoundedContext.html\">bounded Context</a> is a central pattern in Domain-Driven Design. It is the focus of DDD’s strategic design section which is all about dealing with large models and teams. DDD deals with large models by dividing them into different Bounded Contexts and being explicit about their interrelationships.</p>\n<p>The idea behind the principle is to break architectures into small, <strong>cohesive components</strong> that only fullfil one job (<strong>single responsibility principle</strong>) for one other component (<strong>loosely coupled</strong>). E.g. instead of having one big Integration Database that is build with a single schema and serves all parts of your monolithic application we will add a small, exclusive database to every component that needs data storage.</p>\n<p>We are going to continue to build the web application we <a href=\"https://mpolinowski.github.io/creating-a-kubernetes-cluster/\">started to build earlier</a> - with an ActiveMQ Message broker in the backend and an Angular web frontend that will show us the position of our car fleet on a map. The architecture will consist of 5 pods:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Position Simulator -&gt; ActiveMQ -&gt; Position Tracker &lt;- API Gateway &lt;- NGINX Reverse Proxy &lt;-&gt; Web Browser</code></pre></div>\n<p>The necessary Docker images can be found on <a href=\"https://hub.docker.com/u/richardchesterwood\">DockerHUB</a> - their corresponding source code can be found on <a href=\"https://github.com/DickChesterwood/k8s-fleetman\">Github</a>.</p>\n<ul>\n<li>The <a href=\"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-position-simulator\">Position Simulator</a> will simulate the GPS signal from our cars, reporting in their position every 10s.</li>\n<li>The Position Simulator is then send to our <a href=\"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-queue\">ActiveMQ</a> service we already deployed earlier.</li>\n<li>This Queue server / Message Broker then forwards the information it received to the <a href=\"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-position-tracker\">Position Tracker</a> that is storing the information as well as doing some basic calculations on it, like estimating the average speed the car is traveling with.</li>\n<li>To prevent the frontend code to directly contact this backend part of our application, we will add an <a href=\"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-api-gateway\">API Gateway</a> that will serve as an interface between front- and backend. This way changes in the backend will never directly affect the frontend, or vice versa - see <a href=\"https://microservices.io/patterns/apigateway.html\">API Gateway Pattern</a>.</li>\n<li>The final container will run our <a href=\"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-webapp-angular\">Web Application Frontend</a> with the help of an NGINX reverse proxy.</li>\n</ul>\n<h3 id=\"deploying-the-queue\"><a href=\"#deploying-the-queue\" aria-label=\"deploying the queue permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the Queue</h3>\n<p>We want to start with a fresh cluster - if you already <a href=\"https://mpolinowski.github.io/creating-a-kubernetes-cluster/\">followed the earlier steps</a>, just enter the directory that contains all your configuration files (services.yaml, pods.yaml, networking-tests.yaml) and force delete everything that was build from them on your cluster:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete -f <span class=\"token keyword\">.</span>\n<span class=\"token function\">rm</span> networking-tests.yaml\n<span class=\"token function\">mv</span> pods.yaml workloads.yaml\n<span class=\"token function\">nano</span> workloads.yaml</code></pre></div>\n<p>We are also deleting an unnecessary file from the previous step and renaming another - just if you are following along. We can now add the queue server to the <code class=\"language-text\">workloads.yaml</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the ReplicaSet instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> queue\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># the ReplicaSet manages all Pods</span>\n      <span class=\"token comment\"># where the label = app: queue</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> queue\n  <span class=\"token comment\"># only 1 Pod should exist atm - if it</span>\n  <span class=\"token comment\"># crashes, a new pod will be spawned.</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> queue\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> queue\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> richardchesterwood/k8s<span class=\"token punctuation\">-</span>fleetman<span class=\"token punctuation\">-</span>queue<span class=\"token punctuation\">:</span>release1</code></pre></div>\n<p>Secondly, we need to apply a service that exposes our Queue container, which is done in the <code class=\"language-text\">services.yaml</code> file (if you still have the webapp service from the previous step - just leave it in for now):</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the Service instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> fleetman<span class=\"token punctuation\">-</span>queue\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> admin<span class=\"token punctuation\">-</span>console\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8161</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8161</span>\n      <span class=\"token comment\"># The nodePort is available from outside of the</span>\n      <span class=\"token comment\"># cluster when is set to NodePort. It's value has</span>\n      <span class=\"token comment\"># to be > 30000</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30010</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> endpoint\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">61616</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">61616</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Define which pods are going to</span>\n    <span class=\"token comment\"># be represented by this service</span>\n    <span class=\"token comment\"># The service makes an network</span>\n    <span class=\"token comment\"># endpoint for our app</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> queue\n  <span class=\"token comment\"># Setting the Service type to ClusterIP makes the</span>\n  <span class=\"token comment\"># service only available from inside the cluster</span>\n  <span class=\"token comment\"># To expose a port use NodePort instead</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort</code></pre></div>\n<p>The Queue service is going to expose the port <strong>8161</strong> for the administration console (this should be removed once the app goes into production!) and makes it accessible over the port <strong>30010</strong> from outside of the Kubernetes cluster. Additionally we need to expose the port <strong>61616</strong> that ActiveMQ is using to broker messages.</p>\n<p>You can now start both the pod as well as the service with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f workloads.yaml\nkubectl apply -f services.yaml\nkubectl get all</code></pre></div>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bd63052b39fdc44323e580ffe4dd7b91/60964/kubernetes_microservices_01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 26.724137931034488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA3klEQVQY002O3U6EMBgFCxEoWyrGZWNUZKEt/YdSwPj+b+ZXE43JXJybORlE7UFMJHoDsAyNiY/uoP7s9BZVWNUmmUP9jD7kLwoNEg0KvTFEzV7LgOcVi6USHi7y0cBjrULGXWX3jNknHVsZLsxemAMqZh+4R68TInZv/EmXz9rEUobn7QuOWn9CAlEBKvK77pdzcMeVuSuz3WQb8FVI8ruOL8LfmOsmc2MWT6YQvuCuFEvJPZZrNppU2//PVuhuUnZrItWBzCtVoZEQ78vUnwC54B5GPupsUH/8yBrkb2vwIsYTFdT6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/bd63052b39fdc44323e580ffe4dd7b91/b21dd/kubernetes_microservices_01.png\"\n        srcset=\"/static/bd63052b39fdc44323e580ffe4dd7b91/2d451/kubernetes_microservices_01.png 200w,\n/static/bd63052b39fdc44323e580ffe4dd7b91/06807/kubernetes_microservices_01.png 400w,\n/static/bd63052b39fdc44323e580ffe4dd7b91/b21dd/kubernetes_microservices_01.png 800w,\n/static/bd63052b39fdc44323e580ffe4dd7b91/60964/kubernetes_microservices_01.png 812w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>The Admin panel should now be accessible over the IP address of your Kubernetes master server with the port <strong>30010</strong>:</p>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a5feb4ba5ebf09f41f97271ad02b3231/60964/kubernetes_microservices_02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 42.98029556650247%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABuklEQVQoz32Q3U/aUBTA79+4xAWdsqmp4Pa47VUf/HhwiSwKQ5ZpXK0KCFaJiZOthhcYjFpKAYeILmyBugJFitJbSnt3HcnUbNkvv5ycnI+Hc8DomH2VXGO5VDQWT3IpPi2khayQyfHpDM7vKQi4jcX5q3nHCGEDelc3kdnVu5iOppkIqVBttVqdv9CgZhomBiFkGIau6+BmB5nhxc2dCbf/hSM0uURYhx9Y+sQLEQ/1RntRFqtZP1MqFrgMXyieQg2CcrZ4HE9RMy7ns0nP89mVl3OeacfC1Fw+wUun3ytfz8X8Nxx/FkpnR7lEiEkdRj8fRLhIvCk3QIzcY31hNvDpiD5kg0wyyPB05Hgvym0xSW+Y9X384xfvQXxjP0Ht89uR3IdYrXwBpMu6pMg1RRZlqdqU60qj1mygf9E1DbFSOS+eSVIVH6KqKui0Iby8hs02VNr4H+i/XCtX9Ub95guGASEEtIvcda7t/Dbk2dh9Q/lfr/gcy975dwHne/rtOu2hegbdZMBN4sr2ErXlWi2XfoDRx8NPbXY7YRsnxuwEMU7YngxarQOD2KH+R0OWO/bfOvDQcpLP/wIrd6PliyArVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/a5feb4ba5ebf09f41f97271ad02b3231/b21dd/kubernetes_microservices_02.png\"\n        srcset=\"/static/a5feb4ba5ebf09f41f97271ad02b3231/2d451/kubernetes_microservices_02.png 200w,\n/static/a5feb4ba5ebf09f41f97271ad02b3231/06807/kubernetes_microservices_02.png 400w,\n/static/a5feb4ba5ebf09f41f97271ad02b3231/b21dd/kubernetes_microservices_02.png 800w,\n/static/a5feb4ba5ebf09f41f97271ad02b3231/60964/kubernetes_microservices_02.png 812w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<h3 id=\"deploying-the-position-simulator\"><a href=\"#deploying-the-position-simulator\" aria-label=\"deploying the position simulator permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the Position Simulator</h3>\n<p>We can now add the Position Simulator to the <code class=\"language-text\">workloads.yaml</code> file - directly under the configuration of our queue server, divided by <code class=\"language-text\">---</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the ReplicaSet instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>simulator\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>simulator\n  <span class=\"token comment\"># only 1 Pod should exist atm - if it</span>\n  <span class=\"token comment\"># crashes, a new pod will be spawned.</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>simulator\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>simulator\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> richardchesterwood/k8s<span class=\"token punctuation\">-</span>fleetman<span class=\"token punctuation\">-</span>position<span class=\"token punctuation\">-</span>simulator<span class=\"token punctuation\">:</span>release1\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_PROFILES_ACTIVE\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> production<span class=\"token punctuation\">-</span>microservice</code></pre></div>\n<p>The configuration for deployment is similar to the ActiveMQ config. We only need to add a <strong>Environment Variable</strong> that sets the service to <em>Production Settings</em> - <code class=\"language-text\">SPRING_PROFILES_ACTIVE: production-microservice</code> (the service can be started with different profiles, depending if you are in a development or production environment).</p>\n<p>We can apply the new workloads configuration, check for the name of the new container (it will be called <code class=\"language-text\">position-simulator</code> + an deployment ID + an replicationSet ID) and check if it is build correctly:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f workloads.yaml\nkubectl get all\nkubectl describe pod position-simulator-68bfc8d6fb-8vxkt</code></pre></div>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c1c1a341c54e5cb17428e7b35dd5a3a0/76a8f/kubernetes_microservices_03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 19.509202453987733%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuklEQVQI1y1P2Q6CMBAsHuUQKMQ3FUGOHrZdKpf+/5e5iMlmMpnZncwSvwPa2kOtD/WTNmb/ULtKkbsghUAr6MArJSqIG9lV8jfKuzYkszPTEzNzJFyix5BDyPsjplSKdjaQjmIEh0j0qAer+x+/5CSHNzNTooegs7FaEYuEwqEdtyYXfcYhwW2xXkbSYQoiBlE8zmDJYUn1eJLu7D7pc4jVi6Foxka9bma6w1K01is4/rKV98qVkEv9BS1ZHKzzZr5qAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/c1c1a341c54e5cb17428e7b35dd5a3a0/b21dd/kubernetes_microservices_03.png\"\n        srcset=\"/static/c1c1a341c54e5cb17428e7b35dd5a3a0/2d451/kubernetes_microservices_03.png 200w,\n/static/c1c1a341c54e5cb17428e7b35dd5a3a0/06807/kubernetes_microservices_03.png 400w,\n/static/c1c1a341c54e5cb17428e7b35dd5a3a0/b21dd/kubernetes_microservices_03.png 800w,\n/static/c1c1a341c54e5cb17428e7b35dd5a3a0/76a8f/kubernetes_microservices_03.png 815w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>This service does not need to be accessed from outside of the Kubernetes cluster - so <strong>we do not need to create a service</strong> for it.</p>\n<p>We can test the deployment by accessing the IP Address followed by the port <strong>30010</strong>, click on <em>Managing ActiveMQ Broker</em>, sign in with <strong>admin, admin</strong> and click on <strong>Queues</strong>:</p>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e73b03c00cd38d492a1a69fd3f90a7c9/9f07b/kubernetes_microservices_07.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 44.27860696517413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACR0lEQVQoz5WS3UvTYRiG91eUaGm66dyHmiWiK2MzFTNL+7DMOu+gSFALTMqDohOpk3JBUc0CoW+ihMTNzZg6nQYhWpHklLY13abbmrg1d/X6K6LTXri476OL53l4ZcFgEH8ggN/vJxz9gT+8QsPxJrTaArR529GIVOZqyFVpUanzJDa6RpvPiHOctXiM5eVlQqEQAeGRJZNJfsbjrJNkzjHFiOk1jQ1N6HaVoTfspWyPgaLiEvLyC/+RihTdbHpB5PsSrnkXrjkXkXAYWWJ9XZIthgI8v2mi62Qr1ZU1aMR0GxMqsnMl5AolWXKl6Coys7LJzlHxxGji69Q0Ex/eMzbhJLAcROabXcDW/ZSh28/ou97D4ytG9lfUULCjGLW2UAjUQiSEIjMyMklLTWNbVo4Qanl4rZvR+28YvveK8d63fHw3iWwtkcDj9uJdcOP3LuKZ/0Z5eSWbNqeRniFny9ZMtqTLSUlJpbj8GIdOd6HILUChVNP/sg/flwUx5WdCS0EiIbFy3OPBOzPNvMeN2+thTtzj0uVOzpw9R2vbBVpa22hpO09zczNXu4wYH/XT3tFJ+8UOJh1OPs3M4PP52DhddHVVCO8+INnTy2osQTQYIroS4X9ePBb72xNiW5lzbIKju/dxqqKeJsNBThgO0KivlThcWkXtTv1vivTUlVZSr6uirqRCol5XyZGyaomqfB13btxCtvF37CPDjDpGGZbSIXXHmAO73c6gdZAB84CExWLBZrNhFdj+YLVZsQ0NYbaYmZ2d5RfkYfAv1K0DTgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/e73b03c00cd38d492a1a69fd3f90a7c9/b21dd/kubernetes_microservices_07.png\"\n        srcset=\"/static/e73b03c00cd38d492a1a69fd3f90a7c9/2d451/kubernetes_microservices_07.png 200w,\n/static/e73b03c00cd38d492a1a69fd3f90a7c9/06807/kubernetes_microservices_07.png 400w,\n/static/e73b03c00cd38d492a1a69fd3f90a7c9/b21dd/kubernetes_microservices_07.png 800w,\n/static/e73b03c00cd38d492a1a69fd3f90a7c9/9f07b/kubernetes_microservices_07.png 804w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/44b9478322c304d795aaa838e9f32b07/60964/kubernetes_microservices_08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 41.50246305418719%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABvklEQVQY0z1RTW/TQBD1j+LCgSM3zki9wYmfwJ0DEgcOlQoHEKCqPaBK0KJEiDZyoUi0cdKksRM7CYlje73e2I7r76/1x5oNSIyenp5mNPNGM0xVVjjPSUNcYFoLgKRVbLrX3d5Z58wyLVKTAhdlUZRlmfpRYjhpFAdBkCZ56CGmJqSqqrDGrVeHL+4/2dt5evD42aMHD+/cu8txXNM0tEoIoUKbyr39ljjmOxfnvCiGAWI8ZEtsnz9hW7sfDp6//vjyzafd9539z1/fHfW+nK+uhN8/h+K3y9Hx98Exy52w3NHpqH0hnHbRUmISLwALXX97aLdZx3AcGWrCfDWcBpq1WejmTDXnKhIVNJG1m9n0R395ya/6EygqG0NmqroyzLUXBnVDqN4yqSuyFWSLZrvx36ACAeg6LqGXaJrQRwzN6kAXhPGkxw/YrjSWRr8G4z5Pme/e8FfDyYifSVOeGzobx4Zrz75N/bCuG/8WUue6sOxMASnQMTSwgTBEmQ5zoBdrM4szB7o4xVmUYIwtYLimk8cptfbdf80qwPNlJiuVDikIHaGoparVEFVJEF23yzjCcU6/ZSzV9UL73/wHiBCiUM5Nda8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/44b9478322c304d795aaa838e9f32b07/b21dd/kubernetes_microservices_08.png\"\n        srcset=\"/static/44b9478322c304d795aaa838e9f32b07/2d451/kubernetes_microservices_08.png 200w,\n/static/44b9478322c304d795aaa838e9f32b07/06807/kubernetes_microservices_08.png 400w,\n/static/44b9478322c304d795aaa838e9f32b07/b21dd/kubernetes_microservices_08.png 800w,\n/static/44b9478322c304d795aaa838e9f32b07/60964/kubernetes_microservices_08.png 812w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>You should see a rising number of pending messages, telling you that our <strong>Position Simulator</strong> is successfully sending GPS coordinates to the message broker.</p>\n<h3 id=\"how-to-debug-a-failed-deployment\"><a href=\"#how-to-debug-a-failed-deployment\" aria-label=\"how to debug a failed deployment permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How to Debug a failed Deployment</h3>\n<p>As we have seen above the deployment work and the Position Simulator is up and running - but how would we debug a container that cannot be started for some reason? We can create this circumstance by adding a typo in the environment variable inside the config file we created above, e.g. <code class=\"language-text\">SPRING_PROFILES_ACTIVE: production-microservice-typo</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f workloads.yaml\nkubectl get all\nkubectl describe pod position-simulator-77dcb74d75-dt27n</code></pre></div>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b5b9c0a953e353d429b9ce39bc4f595b/25912/kubernetes_microservices_04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 17.892156862745097%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAt0lEQVQI1yWM7Q6CMAxFp6AT+RBM/KcYGGMb7dgcIO//ZhZMTpqbtucyLse4gZOAqBmixrCnZK+eQtwCq/XhrVmtCC7tuUMKtNlRjMjMJzOhGr/ZEK7Kk0NPqQmp9tTISXhvQtI7up4FXpRL+jGhqRy7uzUfpr9c2oXCxh5of8Olciv9xdJy7S/mE3f20EIk8CiQleOSwybzzpY4FwRMBcyV2+qopfTrA6YwBAch4Gy11wJ1hyjtDzlkHm8KJu+lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/b5b9c0a953e353d429b9ce39bc4f595b/b21dd/kubernetes_microservices_04.png\"\n        srcset=\"/static/b5b9c0a953e353d429b9ce39bc4f595b/2d451/kubernetes_microservices_04.png 200w,\n/static/b5b9c0a953e353d429b9ce39bc4f595b/06807/kubernetes_microservices_04.png 400w,\n/static/b5b9c0a953e353d429b9ce39bc4f595b/b21dd/kubernetes_microservices_04.png 800w,\n/static/b5b9c0a953e353d429b9ce39bc4f595b/25912/kubernetes_microservices_04.png 816w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>We can now see that the deployment is failing and Kubernetes is trying to restart the container in a loop (<strong>CrashLoopBackOff</strong>). To check what is going wrong, we can call the Kubernetes logs for the failing container:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl logs position-simulator-77dcb74d75-dt27n</code></pre></div>\n<p>And the developer of the application should be able to spot the typo inside the selected profile for you:</p>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/76a8f/kubernetes_microservices_05.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 47.60736196319018%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZklEQVQoz31S2W6DMBB0GlpuSBpVqnqRQGyMTw5D/v/POoao6lOk1cp4Pbszs5CI6per8tEg64iakBp8bhk34VX/5bWqn86cVJy8V+S5UU/nLqhlUAsc9hexv3Tkmz2Kn/YOzrohRfA+bvukHSJm0H6H8gPklj1YjGk3epJUx7xPeB+1dgcuDbhI8Ar/MccN2K0CTfDVkDc9n8R07IaytQWzOdVJo9JGFa0FhZgZtAM1n/kAF6Aubm3Ch7BiZDSLlc6IUYvRyqljmlMtmOnkBC7AZN2Yi7GQU+p5DRiLjrl0YUXJwSwHcyuVK/V8NAveAQBLUwEjBojySDGVas74kMtxMyjzYEZO9na0SyndUc+vOKOXng/a+XZqLpRbx6K18yXl7o/tLblwAj6o5QIZ7d2mEMQgbNWGFfTbNBCJmUVgnUGj9p81QQ2WYkP+x7gqFFYz1eqwl7e5DSEx9VuMmPUPqN5/1L+8Ykish4WUAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/b21dd/kubernetes_microservices_05.png\"\n        srcset=\"/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/2d451/kubernetes_microservices_05.png 200w,\n/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/06807/kubernetes_microservices_05.png 400w,\n/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/b21dd/kubernetes_microservices_05.png 800w,\n/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/76a8f/kubernetes_microservices_05.png 815w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>Fixing the <em>typo</em> and re-applying the configuration should show you that the “loop-crashing” container is now being discarded and replaced by a working version:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f workloads.yaml\nkubectl get all</code></pre></div>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c327a28b3451e54d92e6f16ba0d636bb/9f07b/kubernetes_microservices_06.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 9.577114427860696%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAb0lEQVQI10XLuw6CMBQA0CYYINYCjiaixr57bwul1IEZ//+XYILkrIcwl6iJ1EZqxhbnHYPUYFrc9Pd5tVFyqGUoBVbCFx9LXvp0D7nF3PncwHw1Y61CybEQ+JReDb+HHnqBjAN565ubLl8gvTryBt6DD24DYegTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/c327a28b3451e54d92e6f16ba0d636bb/b21dd/kubernetes_microservices_06.png\"\n        srcset=\"/static/c327a28b3451e54d92e6f16ba0d636bb/2d451/kubernetes_microservices_06.png 200w,\n/static/c327a28b3451e54d92e6f16ba0d636bb/06807/kubernetes_microservices_06.png 400w,\n/static/c327a28b3451e54d92e6f16ba0d636bb/b21dd/kubernetes_microservices_06.png 800w,\n/static/c327a28b3451e54d92e6f16ba0d636bb/9f07b/kubernetes_microservices_06.png 804w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<h3 id=\"deploying-the-position-tracker\"><a href=\"#deploying-the-position-tracker\" aria-label=\"deploying the position tracker permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the Position Tracker</h3>\n<p>Now we need to start up the position tracker who’s job it is take out the message that are send by our position simulator and are currently piling up in our ActiveMQ Server. The position tracked does some calculation on those messages and exposes his results through an REST interface to the API gateway.</p>\n<p>We can now add the <strong>Position Tracker</strong> to the <code class=\"language-text\">workloads.yaml</code> file - directly under the configuration of our position simulator, divided by <code class=\"language-text\">---</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the ReplicaSet instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>tracker\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>tracker\n  <span class=\"token comment\"># only 1 Pod should exist atm - if it</span>\n  <span class=\"token comment\"># crashes, a new pod will be spawned.</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>tracker\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>tracker\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> richardchesterwood/k8s<span class=\"token punctuation\">-</span>fleetman<span class=\"token punctuation\">-</span>position<span class=\"token punctuation\">-</span>tracker<span class=\"token punctuation\">:</span>release1\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_PROFILES_ACTIVE\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> production<span class=\"token punctuation\">-</span>microservice</code></pre></div>\n<p>We can now deploy the position tracker and then take a look at our message queue. We should be able to see that the tracker is working and messages are getting de-queued:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f workloads.yaml</code></pre></div>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/16f808f5508fdd96fc8d8cd6ddfc4694/60964/kubernetes_microservices_09.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 42.11822660098522%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABsElEQVQY02VRy27TQBT119FdBQKJbT8BIbasEQvU7lqpEgsEldpNeSgtaZOWlkDckvqRsetHHoQkdp06iePxjMeeGccMlWDD0TnS1b260r3nSBnJGGcZIh7o+tf9wBrcdH4dVav1eh0jzMWMMkaFGLpdYG+WIgRjiBDKskxaliVhecd1Nx4+Xb//ZHvt+cbjZ/dWVlYfPUAYlWW5vIMonIu2/OYjMPSj05oC9JxSyf7Ssk4uG3uHOy82d15u7b7a/rT5rv72w+HrPbMmdxuqc3YFKg1t/7S1fyK/r8m7Va1yrh18nY4DyTN7PxVrBLqhO7p1hxN7YDfVcbsb9X3f6PmmYH+suUPV6TTb7rnSaai9C2OoOfF0LkVx5E1u+LIo/2J5x/9BC+YPRrNwVvBCPJLnuZRACBTdsW31uGlqwLhUwXcFNFVDVvWzH+ZV2wKmZVyDlj4Nw9ALZkGYxqjgnBAiUUoxRAlMFuEcJ8IjhGGSEAJtN6p8XsR4HkSiiRIhFE2mcL7IMCmK4s+ySIITxkhOGf3nLeWcpylHOAvHEHyjIo8kFQh6IxFkhlJxt1j+DRNco2mlW+0EAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/16f808f5508fdd96fc8d8cd6ddfc4694/b21dd/kubernetes_microservices_09.png\"\n        srcset=\"/static/16f808f5508fdd96fc8d8cd6ddfc4694/2d451/kubernetes_microservices_09.png 200w,\n/static/16f808f5508fdd96fc8d8cd6ddfc4694/06807/kubernetes_microservices_09.png 400w,\n/static/16f808f5508fdd96fc8d8cd6ddfc4694/b21dd/kubernetes_microservices_09.png 800w,\n/static/16f808f5508fdd96fc8d8cd6ddfc4694/60964/kubernetes_microservices_09.png 812w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>We can now add a service for the position tracker to expose the REST interface directly on port <strong>8080</strong> (<em>optional - only for testing</em>). For this we need to add the following lines to our <code class=\"language-text\">services.yaml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the Service instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> fleetman<span class=\"token punctuation\">-</span>position<span class=\"token punctuation\">-</span>tracker\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> rest<span class=\"token punctuation\">-</span>interface\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n      <span class=\"token comment\"># The nodePort is available from outside of the</span>\n      <span class=\"token comment\"># cluster when is set to NodePort. It's value has</span>\n      <span class=\"token comment\"># to be > 30000</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30020</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>tracker\n  <span class=\"token comment\"># Setting the Service type to ClusterIP makes the</span>\n  <span class=\"token comment\"># service only available from inside the cluster</span>\n  <span class=\"token comment\"># To expose a port use NodePort instead</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort</code></pre></div>\n<p>Now apply the changes <code class=\"language-text\">kubectl apply -f services.yaml</code> and open the REST interface on your Master server IP address with the port <strong>30020</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">http://195.201.148.210:30020/vehicles/City%20Truck</code></pre></div>\n<p>You should be able to see the current location and speed of the vehicle with the designation <strong>City Truck</strong>:</p>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1d9e3bff8329df2211e9be7c9e711b96/60964/kubernetes_microservices_10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 21.305418719211822%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAuUlEQVQI132L2w6CMBiDeTjwHUQcLuIpeIzxbQVR0f2bOhcHGSgwd2GMV35pmqZpreEkNJpM5+Nw3usHttOyHaeDev3hGAcjPBh5Pm57yPV8t+u7HuogjHCwXG9mi5VFAQ7J/pyezifCKBV3wTknlAL5YEoKRsAYAwAhRJ7nUkqllFVIBTE5xPs0OQIxE8qvvMhU9aqautFaN43xb9D1D9ZTlZcdM88o3m6jKIkTllJ5e5RZUVe1/ssbweXApop3QaMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/1d9e3bff8329df2211e9be7c9e711b96/b21dd/kubernetes_microservices_10.png\"\n        srcset=\"/static/1d9e3bff8329df2211e9be7c9e711b96/2d451/kubernetes_microservices_10.png 200w,\n/static/1d9e3bff8329df2211e9be7c9e711b96/06807/kubernetes_microservices_10.png 400w,\n/static/1d9e3bff8329df2211e9be7c9e711b96/b21dd/kubernetes_microservices_10.png 800w,\n/static/1d9e3bff8329df2211e9be7c9e711b96/60964/kubernetes_microservices_10.png 812w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>Since it would be dangerous to expose the REST API directly to the internet, we will remove the NodePort and have the API be available only from inside our cluster on port 8080:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the Service instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> fleetman<span class=\"token punctuation\">-</span>position<span class=\"token punctuation\">-</span>tracker\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> rest<span class=\"token punctuation\">-</span>interface\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> position<span class=\"token punctuation\">-</span>tracker\n  <span class=\"token comment\"># Setting the Service type to ClusterIP makes the</span>\n  <span class=\"token comment\"># service only available from inside the cluster</span>\n  <span class=\"token comment\"># To expose a port use NodePort instead</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> ClusterIP</code></pre></div>\n<h3 id=\"deploying-the-api-gateway\"><a href=\"#deploying-the-api-gateway\" aria-label=\"deploying the api gateway permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the API Gateway</h3>\n<p>We can now add the <strong>API Gateway</strong> to the <code class=\"language-text\">workloads.yaml</code> file - directly under the configuration of our position tracker, divided by <code class=\"language-text\">---</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the ReplicaSet instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> api<span class=\"token punctuation\">-</span>gateway\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> api<span class=\"token punctuation\">-</span>gateway\n  <span class=\"token comment\"># only 1 Pod should exist atm - if it</span>\n  <span class=\"token comment\"># crashes, a new pod will be spawned.</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> api<span class=\"token punctuation\">-</span>gateway\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> api<span class=\"token punctuation\">-</span>gateway\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> richardchesterwood/k8s<span class=\"token punctuation\">-</span>fleetman<span class=\"token punctuation\">-</span>api<span class=\"token punctuation\">-</span>gateway<span class=\"token punctuation\">:</span>release1\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_PROFILES_ACTIVE\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> production<span class=\"token punctuation\">-</span>microservice</code></pre></div>\n<p>We can now deploy the gateway with <code class=\"language-text\">kubectl apply -f workloads.yaml</code>. And then expose the port <strong>8080</strong> to the Kubernetes cluster in <code class=\"language-text\">services.yaml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the Service instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> fleetman<span class=\"token punctuation\">-</span>api<span class=\"token punctuation\">-</span>gateway\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> rest<span class=\"token punctuation\">-</span>interface\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> api<span class=\"token punctuation\">-</span>gateway\n  <span class=\"token comment\"># Setting the Service type to ClusterIP makes the</span>\n  <span class=\"token comment\"># service only available from inside the cluster</span>\n  <span class=\"token comment\"># To expose a port use NodePort instead</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> ClusterIP</code></pre></div>\n<h3 id=\"deploying-the-angular-frontend\"><a href=\"#deploying-the-angular-frontend\" aria-label=\"deploying the angular frontend permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Deploying the Angular Frontend</h3>\n<p>We can now add the <strong>Web APP</strong> to the <code class=\"language-text\">workloads.yaml</code> file - directly under the configuration of our position tracker, divided by <code class=\"language-text\">---</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">---</span>\n<span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the ReplicaSet instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> webapp\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> webapp\n  <span class=\"token comment\"># only 1 Pod should exist atm - if it</span>\n  <span class=\"token comment\"># crashes, a new pod will be spawned.</span>\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> webapp\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> webapp\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> richardchesterwood/k8s<span class=\"token punctuation\">-</span>fleetman<span class=\"token punctuation\">-</span>webapp<span class=\"token punctuation\">-</span>angular<span class=\"token punctuation\">:</span>release1\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> SPRING_PROFILES_ACTIVE\n          <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> production<span class=\"token punctuation\">-</span>microservice</code></pre></div>\n<p>We can now deploy the frontend with <code class=\"language-text\">kubectl apply -f workloads.yaml</code>. And then expose the port <strong>80</strong> to the Kubernetes cluster in <code class=\"language-text\">services.yaml</code>, as well as adding the public port (NodePort) <strong>30080</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Service\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># Unique key of the Service instance</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> fleetman<span class=\"token punctuation\">-</span>webapp\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Accept traffic sent to port 80</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> http\n      <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n      <span class=\"token key atrule\">targetPort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n      <span class=\"token comment\"># The nodePort is available from outside of the</span>\n      <span class=\"token comment\"># cluster when is set to NodePort. It's value has</span>\n      <span class=\"token comment\"># to be > 30000</span>\n      <span class=\"token key atrule\">nodePort</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30080</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Define which pods are going to</span>\n    <span class=\"token comment\"># be represented by this service</span>\n    <span class=\"token comment\"># The service makes an network</span>\n    <span class=\"token comment\"># endpoint for our app</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> webapp\n  <span class=\"token comment\"># Setting the Service type to ClusterIP makes the</span>\n  <span class=\"token comment\"># service only available from inside the cluster</span>\n  <span class=\"token comment\"># To expose a port use NodePort instead</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> NodePort</code></pre></div>\n<p>Your complete Microservice deployment should now look something like this:</p>\n<hr>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ff553fffe62b42391529e3e63c32176e/25912/kubernetes_microservices_11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 60.90686274509803%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABmklEQVQoz22S3Y6CMBCFqwiIf+iKNy7KItCWUgotbMTNvv9z7SlcmDUmEzIpc2a+OS05VP2KtwFtECvWrku9LFTA20gYI4xkTUmVk1WLW0Wu7BkJJ+cbOap7pIdjOxz1I9KPfd2vWOPntZvLj+YeCjNPuJfJNW/Jhb6Kd9xshFlzjd8Ba/BjduXOV+mkAhQ+VbOEYSzavZkcis4rahdgqfByOUs4kiVtrJhraHCIvmi3KTVyO39COKdWjJ2nsX5Rg3BxE8idm8Dylj+TCFTj0MvrOaBGrtlnRsKyG7GtVdaVC3XthhpF8M+3UHJJlRXTZisMhgPTzWsnzgkqEGgJ2gkJMgxEe9QhR7hjUxxO3Z/YO9H5hfJGNnydtFykFUahDth2bKGWmP/2qiI1nPrfyAwn8xNKuz+oQDv/4ijCbiSm6BWAPC5exVuux0eicL2wmlyYRU04AsNhHvRoN13Eq/gg+x2i6rZVt5Pdvv5GIIcL9p7GdcAMq61tMf0n3lf99LZOBt8BYS3kGsvPEwbbUGofWS7h9vORjeI/6j9Q2iAA8R4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;\"\n        alt=\"A Kubernetes Cluster & Microservices\"\n        title=\"\"\n        src=\"/static/ff553fffe62b42391529e3e63c32176e/b21dd/kubernetes_microservices_11.png\"\n        srcset=\"/static/ff553fffe62b42391529e3e63c32176e/2d451/kubernetes_microservices_11.png 200w,\n/static/ff553fffe62b42391529e3e63c32176e/06807/kubernetes_microservices_11.png 400w,\n/static/ff553fffe62b42391529e3e63c32176e/b21dd/kubernetes_microservices_11.png 800w,\n/static/ff553fffe62b42391529e3e63c32176e/25912/kubernetes_microservices_11.png 816w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n  </span>\n  </a></p>\n<hr>\n<p>And you should be able to access the web interface on port <strong>30080</strong> on your master server IP address:</p>\n<hr>\n<p><img src=\"/kubernetes_microservices_12-d61b7852ef6d025a1dedb4fa7616327d.gif\" alt=\"A Kubernetes Cluster &#x26; Microservices\"></p>\n<hr>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/250f352f8408a5aa47641f30724d572e/283d3/photo-34364880182_fe2d33582b_o.jpg","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 46.50801862390067%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAGHa1SMJyj/xAAaEAEAAgMBAAAAAAAAAAAAAAABAAIDIjM0/9oACAEBAAEFAqix1bBK+jN1n//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABYRAAMAAAAAAAAAAAAAAAAAABARIf/aAAgBAgEBPwFUf//EABoQAAICAwAAAAAAAAAAAAAAAAABAhAhMUH/2gAIAQEABj8Cy0bRwRKv/8QAHRAAAgICAwEAAAAAAAAAAAAAAAERIUGxMVFxof/aAAgBAQABPyFBNrsoQvF4GWnKyuHZo6PqMLw//9oADAMBAAIAAwAAABCr3//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAwEBPxBRMtv/xAAXEQADAQAAAAAAAAAAAAAAAAAAARFR/9oACAECAQE/EFoRH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAIRFBkaEQYYH/2gAIAQEAAT8QGiGjLzs9RtEbCccuYIgAgU+zq+AHpT//2Q=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"Sydney, Australia","title":"","src":"/static/250f352f8408a5aa47641f30724d572e/78f2b/photo-34364880182_fe2d33582b_o.jpg","srcSet":["/static/250f352f8408a5aa47641f30724d572e/dce19/photo-34364880182_fe2d33582b_o.jpg 200w","/static/250f352f8408a5aa47641f30724d572e/c1413/photo-34364880182_fe2d33582b_o.jpg 400w","/static/250f352f8408a5aa47641f30724d572e/78f2b/photo-34364880182_fe2d33582b_o.jpg 800w","/static/250f352f8408a5aa47641f30724d572e/ab4c4/photo-34364880182_fe2d33582b_o.jpg 1200w","/static/250f352f8408a5aa47641f30724d572e/bc99b/photo-34364880182_fe2d33582b_o.jpg 1600w","/static/250f352f8408a5aa47641f30724d572e/283d3/photo-34364880182_fe2d33582b_o.jpg 1933w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"comment","value":" TOC "},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#domain-driven-design-and-boundedcontext"},"children":[{"type":"text","value":"Domain Driven Design and boundedContext"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-queue"},"children":[{"type":"text","value":"Deploying the Queue"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-position-simulator"},"children":[{"type":"text","value":"Deploying the Position Simulator"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#how-to-debug-a-failed-deployment"},"children":[{"type":"text","value":"How to Debug a failed Deployment"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-position-tracker"},"children":[{"type":"text","value":"Deploying the Position Tracker"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-api-gateway"},"children":[{"type":"text","value":"Deploying the API Gateway"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-angular-frontend"},"children":[{"type":"text","value":"Deploying the Angular Frontend"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"comment","value":" /TOC "},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"domain-driven-design-and-boundedcontext"},"children":[{"type":"element","tagName":"a","properties":{"href":"#domain-driven-design-and-boundedcontext","ariaLabel":"domain driven design and boundedcontext permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Domain Driven Design and boundedContext"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A Microservice architecture is an implementation of the "},{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/tags/domain%20driven%20design.html"},"children":[{"type":"text","value":"Domain Drive Design"}]},{"type":"text","value":" principle and "},{"type":"element","tagName":"a","properties":{"href":"https://martinfowler.com/bliki/BoundedContext.html"},"children":[{"type":"text","value":"bounded Context"}]},{"type":"text","value":" is a central pattern in Domain-Driven Design. It is the focus of DDD’s strategic design section which is all about dealing with large models and teams. DDD deals with large models by dividing them into different Bounded Contexts and being explicit about their interrelationships."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The idea behind the principle is to break architectures into small, "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"cohesive components"}]},{"type":"text","value":" that only fullfil one job ("},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"single responsibility principle"}]},{"type":"text","value":") for one other component ("},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"loosely coupled"}]},{"type":"text","value":"). E.g. instead of having one big Integration Database that is build with a single schema and serves all parts of your monolithic application we will add a small, exclusive database to every component that needs data storage."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We are going to continue to build the web application we "},{"type":"element","tagName":"a","properties":{"href":"https://mpolinowski.github.io/creating-a-kubernetes-cluster/"},"children":[{"type":"text","value":"started to build earlier"}]},{"type":"text","value":" - with an ActiveMQ Message broker in the backend and an Angular web frontend that will show us the position of our car fleet on a map. The architecture will consist of 5 pods:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Position Simulator -> ActiveMQ -> Position Tracker <- API Gateway <- NGINX Reverse Proxy <-> Web Browser"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The necessary Docker images can be found on "},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/u/richardchesterwood"},"children":[{"type":"text","value":"DockerHUB"}]},{"type":"text","value":" - their corresponding source code can be found on "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/DickChesterwood/k8s-fleetman"},"children":[{"type":"text","value":"Github"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-position-simulator"},"children":[{"type":"text","value":"Position Simulator"}]},{"type":"text","value":" will simulate the GPS signal from our cars, reporting in their position every 10s."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The Position Simulator is then send to our "},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-queue"},"children":[{"type":"text","value":"ActiveMQ"}]},{"type":"text","value":" service we already deployed earlier."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"This Queue server / Message Broker then forwards the information it received to the "},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-position-tracker"},"children":[{"type":"text","value":"Position Tracker"}]},{"type":"text","value":" that is storing the information as well as doing some basic calculations on it, like estimating the average speed the car is traveling with."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"To prevent the frontend code to directly contact this backend part of our application, we will add an "},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-api-gateway"},"children":[{"type":"text","value":"API Gateway"}]},{"type":"text","value":" that will serve as an interface between front- and backend. This way changes in the backend will never directly affect the frontend, or vice versa - see "},{"type":"element","tagName":"a","properties":{"href":"https://microservices.io/patterns/apigateway.html"},"children":[{"type":"text","value":"API Gateway Pattern"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"The final container will run our "},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/r/richardchesterwood/k8s-fleetman-webapp-angular"},"children":[{"type":"text","value":"Web Application Frontend"}]},{"type":"text","value":" with the help of an NGINX reverse proxy."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"deploying-the-queue"},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-queue","ariaLabel":"deploying the queue permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Deploying the Queue"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We want to start with a fresh cluster - if you already "},{"type":"element","tagName":"a","properties":{"href":"https://mpolinowski.github.io/creating-a-kubernetes-cluster/"},"children":[{"type":"text","value":"followed the earlier steps"}]},{"type":"text","value":", just enter the directory that contains all your configuration files (services.yaml, pods.yaml, networking-tests.yaml) and force delete everything that was build from them on your cluster:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl delete -f "},{"type":"element","tagName":"span","properties":{"className":["token","keyword"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"rm"}]},{"type":"text","value":" networking-tests.yaml\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"mv"}]},{"type":"text","value":" pods.yaml workloads.yaml\n"},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"nano"}]},{"type":"text","value":" workloads.yaml"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We are also deleting an unnecessary file from the previous step and renaming another - just if you are following along. We can now add the queue server to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"workloads.yaml"}]},{"type":"text","value":" file:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" apps/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Deployment\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the ReplicaSet instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" queue\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchLabels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# the ReplicaSet manages all Pods"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# where the label = app: queue"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" queue\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# only 1 Pod should exist atm - if it"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# crashes, a new pod will be spawned."}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" queue\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" queue\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" richardchesterwood/k8s"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"queue"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"release1"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Secondly, we need to apply a service that exposes our Queue container, which is done in the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"services.yaml"}]},{"type":"text","value":" file (if you still have the webapp service from the previous step - just leave it in for now):"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the Service instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"queue\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"ports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" admin"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"console\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8161"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8161"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# The nodePort is available from outside of the"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# cluster when is set to NodePort. It's value has"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# to be > 30000"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"nodePort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"30010"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" endpoint\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"61616"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"61616"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Define which pods are going to"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# be represented by this service"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# The service makes an network"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# endpoint for our app"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" queue\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Setting the Service type to ClusterIP makes the"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# service only available from inside the cluster"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# To expose a port use NodePort instead"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" NodePort"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The Queue service is going to expose the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"8161"}]},{"type":"text","value":" for the administration console (this should be removed once the app goes into production!) and makes it accessible over the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"30010"}]},{"type":"text","value":" from outside of the Kubernetes cluster. Additionally we need to expose the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"61616"}]},{"type":"text","value":" that ActiveMQ is using to broker messages."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can now start both the pod as well as the service with:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml\nkubectl apply -f services.yaml\nkubectl get all"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/bd63052b39fdc44323e580ffe4dd7b91/60964/kubernetes_microservices_01.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 26.724137931034488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA3klEQVQY002O3U6EMBgFCxEoWyrGZWNUZKEt/YdSwPj+b+ZXE43JXJybORlE7UFMJHoDsAyNiY/uoP7s9BZVWNUmmUP9jD7kLwoNEg0KvTFEzV7LgOcVi6USHi7y0cBjrULGXWX3jNknHVsZLsxemAMqZh+4R68TInZv/EmXz9rEUobn7QuOWn9CAlEBKvK77pdzcMeVuSuz3WQb8FVI8ruOL8LfmOsmc2MWT6YQvuCuFEvJPZZrNppU2//PVuhuUnZrItWBzCtVoZEQ78vUnwC54B5GPupsUH/8yBrkb2vwIsYTFdT6AAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/bd63052b39fdc44323e580ffe4dd7b91/b21dd/kubernetes_microservices_01.png","srcSet":["/static/bd63052b39fdc44323e580ffe4dd7b91/2d451/kubernetes_microservices_01.png 200w","/static/bd63052b39fdc44323e580ffe4dd7b91/06807/kubernetes_microservices_01.png 400w","/static/bd63052b39fdc44323e580ffe4dd7b91/b21dd/kubernetes_microservices_01.png 800w","/static/bd63052b39fdc44323e580ffe4dd7b91/60964/kubernetes_microservices_01.png 812w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The Admin panel should now be accessible over the IP address of your Kubernetes master server with the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"30010"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/a5feb4ba5ebf09f41f97271ad02b3231/60964/kubernetes_microservices_02.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 42.98029556650247%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABuklEQVQoz32Q3U/aUBTA79+4xAWdsqmp4Pa47VUf/HhwiSwKQ5ZpXK0KCFaJiZOthhcYjFpKAYeILmyBugJFitJbSnt3HcnUbNkvv5ycnI+Hc8DomH2VXGO5VDQWT3IpPi2khayQyfHpDM7vKQi4jcX5q3nHCGEDelc3kdnVu5iOppkIqVBttVqdv9CgZhomBiFkGIau6+BmB5nhxc2dCbf/hSM0uURYhx9Y+sQLEQ/1RntRFqtZP1MqFrgMXyieQg2CcrZ4HE9RMy7ns0nP89mVl3OeacfC1Fw+wUun3ytfz8X8Nxx/FkpnR7lEiEkdRj8fRLhIvCk3QIzcY31hNvDpiD5kg0wyyPB05Hgvym0xSW+Y9X384xfvQXxjP0Ht89uR3IdYrXwBpMu6pMg1RRZlqdqU60qj1mygf9E1DbFSOS+eSVIVH6KqKui0Iby8hs02VNr4H+i/XCtX9Ub95guGASEEtIvcda7t/Dbk2dh9Q/lfr/gcy975dwHne/rtOu2hegbdZMBN4sr2ErXlWi2XfoDRx8NPbXY7YRsnxuwEMU7YngxarQOD2KH+R0OWO/bfOvDQcpLP/wIrd6PliyArVAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/a5feb4ba5ebf09f41f97271ad02b3231/b21dd/kubernetes_microservices_02.png","srcSet":["/static/a5feb4ba5ebf09f41f97271ad02b3231/2d451/kubernetes_microservices_02.png 200w","/static/a5feb4ba5ebf09f41f97271ad02b3231/06807/kubernetes_microservices_02.png 400w","/static/a5feb4ba5ebf09f41f97271ad02b3231/b21dd/kubernetes_microservices_02.png 800w","/static/a5feb4ba5ebf09f41f97271ad02b3231/60964/kubernetes_microservices_02.png 812w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"deploying-the-position-simulator"},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-position-simulator","ariaLabel":"deploying the position simulator permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Deploying the Position Simulator"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now add the Position Simulator to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"workloads.yaml"}]},{"type":"text","value":" file - directly under the configuration of our queue server, divided by "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" apps/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Deployment\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the ReplicaSet instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"simulator\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchLabels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"simulator\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# only 1 Pod should exist atm - if it"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# crashes, a new pod will be spawned."}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"simulator\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"simulator\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" richardchesterwood/k8s"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"simulator"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"release1\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" SPRING_PROFILES_ACTIVE\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" production"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"microservice"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The configuration for deployment is similar to the ActiveMQ config. We only need to add a "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Environment Variable"}]},{"type":"text","value":" that sets the service to "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Production Settings"}]},{"type":"text","value":" - "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SPRING_PROFILES_ACTIVE: production-microservice"}]},{"type":"text","value":" (the service can be started with different profiles, depending if you are in a development or production environment)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can apply the new workloads configuration, check for the name of the new container (it will be called "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"position-simulator"}]},{"type":"text","value":" + an deployment ID + an replicationSet ID) and check if it is build correctly:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml\nkubectl get all\nkubectl describe pod position-simulator-68bfc8d6fb-8vxkt"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/c1c1a341c54e5cb17428e7b35dd5a3a0/76a8f/kubernetes_microservices_03.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 19.509202453987733%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAuklEQVQI1y1P2Q6CMBAsHuUQKMQ3FUGOHrZdKpf+/5e5iMlmMpnZncwSvwPa2kOtD/WTNmb/ULtKkbsghUAr6MArJSqIG9lV8jfKuzYkszPTEzNzJFyix5BDyPsjplSKdjaQjmIEh0j0qAer+x+/5CSHNzNTooegs7FaEYuEwqEdtyYXfcYhwW2xXkbSYQoiBlE8zmDJYUn1eJLu7D7pc4jVi6Foxka9bma6w1K01is4/rKV98qVkEv9BS1ZHKzzZr5qAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/c1c1a341c54e5cb17428e7b35dd5a3a0/b21dd/kubernetes_microservices_03.png","srcSet":["/static/c1c1a341c54e5cb17428e7b35dd5a3a0/2d451/kubernetes_microservices_03.png 200w","/static/c1c1a341c54e5cb17428e7b35dd5a3a0/06807/kubernetes_microservices_03.png 400w","/static/c1c1a341c54e5cb17428e7b35dd5a3a0/b21dd/kubernetes_microservices_03.png 800w","/static/c1c1a341c54e5cb17428e7b35dd5a3a0/76a8f/kubernetes_microservices_03.png 815w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This service does not need to be accessed from outside of the Kubernetes cluster - so "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"we do not need to create a service"}]},{"type":"text","value":" for it."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can test the deployment by accessing the IP Address followed by the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"30010"}]},{"type":"text","value":", click on "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Managing ActiveMQ Broker"}]},{"type":"text","value":", sign in with "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"admin, admin"}]},{"type":"text","value":" and click on "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Queues"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/e73b03c00cd38d492a1a69fd3f90a7c9/9f07b/kubernetes_microservices_07.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 44.27860696517413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACR0lEQVQoz5WS3UvTYRiG91eUaGm66dyHmiWiK2MzFTNL+7DMOu+gSFALTMqDohOpk3JBUc0CoW+ihMTNzZg6nQYhWpHklLY13abbmrg1d/X6K6LTXri476OL53l4ZcFgEH8ggN/vJxz9gT+8QsPxJrTaArR529GIVOZqyFVpUanzJDa6RpvPiHOctXiM5eVlQqEQAeGRJZNJfsbjrJNkzjHFiOk1jQ1N6HaVoTfspWyPgaLiEvLyC/+RihTdbHpB5PsSrnkXrjkXkXAYWWJ9XZIthgI8v2mi62Qr1ZU1aMR0GxMqsnMl5AolWXKl6Coys7LJzlHxxGji69Q0Ex/eMzbhJLAcROabXcDW/ZSh28/ou97D4ytG9lfUULCjGLW2UAjUQiSEIjMyMklLTWNbVo4Qanl4rZvR+28YvveK8d63fHw3iWwtkcDj9uJdcOP3LuKZ/0Z5eSWbNqeRniFny9ZMtqTLSUlJpbj8GIdOd6HILUChVNP/sg/flwUx5WdCS0EiIbFy3OPBOzPNvMeN2+thTtzj0uVOzpw9R2vbBVpa22hpO09zczNXu4wYH/XT3tFJ+8UOJh1OPs3M4PP52DhddHVVCO8+INnTy2osQTQYIroS4X9ePBb72xNiW5lzbIKju/dxqqKeJsNBThgO0KivlThcWkXtTv1vivTUlVZSr6uirqRCol5XyZGyaomqfB13btxCtvF37CPDjDpGGZbSIXXHmAO73c6gdZAB84CExWLBZrNhFdj+YLVZsQ0NYbaYmZ2d5RfkYfAv1K0DTgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/e73b03c00cd38d492a1a69fd3f90a7c9/b21dd/kubernetes_microservices_07.png","srcSet":["/static/e73b03c00cd38d492a1a69fd3f90a7c9/2d451/kubernetes_microservices_07.png 200w","/static/e73b03c00cd38d492a1a69fd3f90a7c9/06807/kubernetes_microservices_07.png 400w","/static/e73b03c00cd38d492a1a69fd3f90a7c9/b21dd/kubernetes_microservices_07.png 800w","/static/e73b03c00cd38d492a1a69fd3f90a7c9/9f07b/kubernetes_microservices_07.png 804w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/44b9478322c304d795aaa838e9f32b07/60964/kubernetes_microservices_08.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 41.50246305418719%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABvklEQVQY0z1RTW/TQBD1j+LCgSM3zki9wYmfwJ0DEgcOlQoHEKCqPaBK0KJEiDZyoUi0cdKksRM7CYlje73e2I7r76/1x5oNSIyenp5mNPNGM0xVVjjPSUNcYFoLgKRVbLrX3d5Z58wyLVKTAhdlUZRlmfpRYjhpFAdBkCZ56CGmJqSqqrDGrVeHL+4/2dt5evD42aMHD+/cu8txXNM0tEoIoUKbyr39ljjmOxfnvCiGAWI8ZEtsnz9hW7sfDp6//vjyzafd9539z1/fHfW+nK+uhN8/h+K3y9Hx98Exy52w3NHpqH0hnHbRUmISLwALXX97aLdZx3AcGWrCfDWcBpq1WejmTDXnKhIVNJG1m9n0R395ya/6EygqG0NmqroyzLUXBnVDqN4yqSuyFWSLZrvx36ACAeg6LqGXaJrQRwzN6kAXhPGkxw/YrjSWRr8G4z5Pme/e8FfDyYifSVOeGzobx4Zrz75N/bCuG/8WUue6sOxMASnQMTSwgTBEmQ5zoBdrM4szB7o4xVmUYIwtYLimk8cptfbdf80qwPNlJiuVDikIHaGoparVEFVJEF23yzjCcU6/ZSzV9UL73/wHiBCiUM5Nda8AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/44b9478322c304d795aaa838e9f32b07/b21dd/kubernetes_microservices_08.png","srcSet":["/static/44b9478322c304d795aaa838e9f32b07/2d451/kubernetes_microservices_08.png 200w","/static/44b9478322c304d795aaa838e9f32b07/06807/kubernetes_microservices_08.png 400w","/static/44b9478322c304d795aaa838e9f32b07/b21dd/kubernetes_microservices_08.png 800w","/static/44b9478322c304d795aaa838e9f32b07/60964/kubernetes_microservices_08.png 812w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You should see a rising number of pending messages, telling you that our "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Position Simulator"}]},{"type":"text","value":" is successfully sending GPS coordinates to the message broker."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"how-to-debug-a-failed-deployment"},"children":[{"type":"element","tagName":"a","properties":{"href":"#how-to-debug-a-failed-deployment","ariaLabel":"how to debug a failed deployment permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"How to Debug a failed Deployment"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As we have seen above the deployment work and the Position Simulator is up and running - but how would we debug a container that cannot be started for some reason? We can create this circumstance by adding a typo in the environment variable inside the config file we created above, e.g. "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"SPRING_PROFILES_ACTIVE: production-microservice-typo"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml\nkubectl get all\nkubectl describe pod position-simulator-77dcb74d75-dt27n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/b5b9c0a953e353d429b9ce39bc4f595b/25912/kubernetes_microservices_04.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 17.892156862745097%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAt0lEQVQI1yWM7Q6CMAxFp6AT+RBM/KcYGGMb7dgcIO//ZhZMTpqbtucyLse4gZOAqBmixrCnZK+eQtwCq/XhrVmtCC7tuUMKtNlRjMjMJzOhGr/ZEK7Kk0NPqQmp9tTISXhvQtI7up4FXpRL+jGhqRy7uzUfpr9c2oXCxh5of8Olciv9xdJy7S/mE3f20EIk8CiQleOSwybzzpY4FwRMBcyV2+qopfTrA6YwBAch4Gy11wJ1hyjtDzlkHm8KJu+lAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/b5b9c0a953e353d429b9ce39bc4f595b/b21dd/kubernetes_microservices_04.png","srcSet":["/static/b5b9c0a953e353d429b9ce39bc4f595b/2d451/kubernetes_microservices_04.png 200w","/static/b5b9c0a953e353d429b9ce39bc4f595b/06807/kubernetes_microservices_04.png 400w","/static/b5b9c0a953e353d429b9ce39bc4f595b/b21dd/kubernetes_microservices_04.png 800w","/static/b5b9c0a953e353d429b9ce39bc4f595b/25912/kubernetes_microservices_04.png 816w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now see that the deployment is failing and Kubernetes is trying to restart the container in a loop ("},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"CrashLoopBackOff"}]},{"type":"text","value":"). To check what is going wrong, we can call the Kubernetes logs for the failing container:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl logs position-simulator-77dcb74d75-dt27n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And the developer of the application should be able to spot the typo inside the selected profile for you:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/76a8f/kubernetes_microservices_05.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 47.60736196319018%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABZklEQVQoz31S2W6DMBB0GlpuSBpVqnqRQGyMTw5D/v/POoao6lOk1cp4Pbszs5CI6per8tEg64iakBp8bhk34VX/5bWqn86cVJy8V+S5UU/nLqhlUAsc9hexv3Tkmz2Kn/YOzrohRfA+bvukHSJm0H6H8gPklj1YjGk3epJUx7xPeB+1dgcuDbhI8Ar/MccN2K0CTfDVkDc9n8R07IaytQWzOdVJo9JGFa0FhZgZtAM1n/kAF6Aubm3Ch7BiZDSLlc6IUYvRyqljmlMtmOnkBC7AZN2Yi7GQU+p5DRiLjrl0YUXJwSwHcyuVK/V8NAveAQBLUwEjBojySDGVas74kMtxMyjzYEZO9na0SyndUc+vOKOXng/a+XZqLpRbx6K18yXl7o/tLblwAj6o5QIZ7d2mEMQgbNWGFfTbNBCJmUVgnUGj9p81QQ2WYkP+x7gqFFYz1eqwl7e5DSEx9VuMmPUPqN5/1L+8Ykish4WUAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/b21dd/kubernetes_microservices_05.png","srcSet":["/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/2d451/kubernetes_microservices_05.png 200w","/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/06807/kubernetes_microservices_05.png 400w","/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/b21dd/kubernetes_microservices_05.png 800w","/static/a677b2fa4cd3cb6a416fdf76c1b0e5f8/76a8f/kubernetes_microservices_05.png 815w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Fixing the "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"typo"}]},{"type":"text","value":" and re-applying the configuration should show you that the “loop-crashing” container is now being discarded and replaced by a working version:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml\nkubectl get all"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/c327a28b3451e54d92e6f16ba0d636bb/9f07b/kubernetes_microservices_06.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 9.577114427860696%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAb0lEQVQI10XLuw6CMBQA0CYYINYCjiaixr57bwul1IEZ//+XYILkrIcwl6iJ1EZqxhbnHYPUYFrc9Pd5tVFyqGUoBVbCFx9LXvp0D7nF3PncwHw1Y61CybEQ+JReDb+HHnqBjAN565ubLl8gvTryBt6DD24DYegTAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/c327a28b3451e54d92e6f16ba0d636bb/b21dd/kubernetes_microservices_06.png","srcSet":["/static/c327a28b3451e54d92e6f16ba0d636bb/2d451/kubernetes_microservices_06.png 200w","/static/c327a28b3451e54d92e6f16ba0d636bb/06807/kubernetes_microservices_06.png 400w","/static/c327a28b3451e54d92e6f16ba0d636bb/b21dd/kubernetes_microservices_06.png 800w","/static/c327a28b3451e54d92e6f16ba0d636bb/9f07b/kubernetes_microservices_06.png 804w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"deploying-the-position-tracker"},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-position-tracker","ariaLabel":"deploying the position tracker permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Deploying the Position Tracker"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we need to start up the position tracker who’s job it is take out the message that are send by our position simulator and are currently piling up in our ActiveMQ Server. The position tracked does some calculation on those messages and exposes his results through an REST interface to the API gateway."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now add the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Position Tracker"}]},{"type":"text","value":" to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"workloads.yaml"}]},{"type":"text","value":" file - directly under the configuration of our position simulator, divided by "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" apps/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Deployment\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the ReplicaSet instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchLabels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# only 1 Pod should exist atm - if it"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# crashes, a new pod will be spawned."}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" richardchesterwood/k8s"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"release1\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" SPRING_PROFILES_ACTIVE\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" production"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"microservice"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now deploy the position tracker and then take a look at our message queue. We should be able to see that the tracker is working and messages are getting de-queued:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/16f808f5508fdd96fc8d8cd6ddfc4694/60964/kubernetes_microservices_09.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 42.11822660098522%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABsElEQVQY02VRy27TQBT119FdBQKJbT8BIbasEQvU7lqpEgsEldpNeSgtaZOWlkDckvqRsetHHoQkdp06iePxjMeeGccMlWDD0TnS1b260r3nSBnJGGcZIh7o+tf9wBrcdH4dVav1eh0jzMWMMkaFGLpdYG+WIgRjiBDKskxaliVhecd1Nx4+Xb//ZHvt+cbjZ/dWVlYfPUAYlWW5vIMonIu2/OYjMPSj05oC9JxSyf7Ssk4uG3uHOy82d15u7b7a/rT5rv72w+HrPbMmdxuqc3YFKg1t/7S1fyK/r8m7Va1yrh18nY4DyTN7PxVrBLqhO7p1hxN7YDfVcbsb9X3f6PmmYH+suUPV6TTb7rnSaai9C2OoOfF0LkVx5E1u+LIo/2J5x/9BC+YPRrNwVvBCPJLnuZRACBTdsW31uGlqwLhUwXcFNFVDVvWzH+ZV2wKmZVyDlj4Nw9ALZkGYxqjgnBAiUUoxRAlMFuEcJ8IjhGGSEAJtN6p8XsR4HkSiiRIhFE2mcL7IMCmK4s+ySIITxkhOGf3nLeWcpylHOAvHEHyjIo8kFQh6IxFkhlJxt1j+DRNco2mlW+0EAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/16f808f5508fdd96fc8d8cd6ddfc4694/b21dd/kubernetes_microservices_09.png","srcSet":["/static/16f808f5508fdd96fc8d8cd6ddfc4694/2d451/kubernetes_microservices_09.png 200w","/static/16f808f5508fdd96fc8d8cd6ddfc4694/06807/kubernetes_microservices_09.png 400w","/static/16f808f5508fdd96fc8d8cd6ddfc4694/b21dd/kubernetes_microservices_09.png 800w","/static/16f808f5508fdd96fc8d8cd6ddfc4694/60964/kubernetes_microservices_09.png 812w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now add a service for the position tracker to expose the REST interface directly on port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":" ("},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"optional - only for testing"}]},{"type":"text","value":"). For this we need to add the following lines to our "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"services.yaml"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the Service instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"ports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" rest"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"interface\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# The nodePort is available from outside of the"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# cluster when is set to NodePort. It's value has"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# to be > 30000"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"nodePort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"30020"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Setting the Service type to ClusterIP makes the"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# service only available from inside the cluster"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# To expose a port use NodePort instead"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" NodePort"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now apply the changes "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"kubectl apply -f services.yaml"}]},{"type":"text","value":" and open the REST interface on your Master server IP address with the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"30020"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"http://195.201.148.210:30020/vehicles/City%20Truck"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You should be able to see the current location and speed of the vehicle with the designation "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"City Truck"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/1d9e3bff8329df2211e9be7c9e711b96/60964/kubernetes_microservices_10.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 21.305418719211822%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAuUlEQVQI132L2w6CMBiDeTjwHUQcLuIpeIzxbQVR0f2bOhcHGSgwd2GMV35pmqZpreEkNJpM5+Nw3usHttOyHaeDev3hGAcjPBh5Pm57yPV8t+u7HuogjHCwXG9mi5VFAQ7J/pyezifCKBV3wTknlAL5YEoKRsAYAwAhRJ7nUkqllFVIBTE5xPs0OQIxE8qvvMhU9aqautFaN43xb9D1D9ZTlZcdM88o3m6jKIkTllJ5e5RZUVe1/ssbweXApop3QaMAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/1d9e3bff8329df2211e9be7c9e711b96/b21dd/kubernetes_microservices_10.png","srcSet":["/static/1d9e3bff8329df2211e9be7c9e711b96/2d451/kubernetes_microservices_10.png 200w","/static/1d9e3bff8329df2211e9be7c9e711b96/06807/kubernetes_microservices_10.png 400w","/static/1d9e3bff8329df2211e9be7c9e711b96/b21dd/kubernetes_microservices_10.png 800w","/static/1d9e3bff8329df2211e9be7c9e711b96/60964/kubernetes_microservices_10.png 812w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Since it would be dangerous to expose the REST API directly to the internet, we will remove the NodePort and have the API be available only from inside our cluster on port 8080:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the Service instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"ports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" rest"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"interface\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" position"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"tracker\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Setting the Service type to ClusterIP makes the"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# service only available from inside the cluster"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# To expose a port use NodePort instead"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" ClusterIP"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"deploying-the-api-gateway"},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-api-gateway","ariaLabel":"deploying the api gateway permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Deploying the API Gateway"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now add the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"API Gateway"}]},{"type":"text","value":" to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"workloads.yaml"}]},{"type":"text","value":" file - directly under the configuration of our position tracker, divided by "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" apps/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Deployment\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the ReplicaSet instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchLabels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# only 1 Pod should exist atm - if it"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# crashes, a new pod will be spawned."}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" richardchesterwood/k8s"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"release1\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" SPRING_PROFILES_ACTIVE\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" production"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"microservice"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now deploy the gateway with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml"}]},{"type":"text","value":". And then expose the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":" to the Kubernetes cluster in "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"services.yaml"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the Service instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"ports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" rest"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"interface\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"8080"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" api"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"gateway\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Setting the Service type to ClusterIP makes the"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# service only available from inside the cluster"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# To expose a port use NodePort instead"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" ClusterIP"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"deploying-the-angular-frontend"},"children":[{"type":"element","tagName":"a","properties":{"href":"#deploying-the-angular-frontend","ariaLabel":"deploying the angular frontend permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Deploying the Angular Frontend"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now add the "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web APP"}]},{"type":"text","value":" to the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"workloads.yaml"}]},{"type":"text","value":" file - directly under the configuration of our position tracker, divided by "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" apps/v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Deployment\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the ReplicaSet instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" webapp\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"matchLabels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" webapp\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# only 1 Pod should exist atm - if it"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# crashes, a new pod will be spawned."}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"replicas"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"template"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"labels"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" webapp\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"containers"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" webapp\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"image"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" richardchesterwood/k8s"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"webapp"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"angular"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"release1\n        "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"env"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n        "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" SPRING_PROFILES_ACTIVE\n          "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"value"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" production"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"microservice"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can now deploy the frontend with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"kubectl apply -f workloads.yaml"}]},{"type":"text","value":". And then expose the port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"80"}]},{"type":"text","value":" to the Kubernetes cluster in "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"services.yaml"}]},{"type":"text","value":", as well as adding the public port (NodePort) "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"30080"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"yaml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-yaml"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"apiVersion"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" v1\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"kind"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" Service\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"metadata"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Unique key of the Service instance"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" fleetman"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":"webapp\n"},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"spec"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"ports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Accept traffic sent to port 80"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" http\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"port"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"80"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"targetPort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"80"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# The nodePort is available from outside of the"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# cluster when is set to NodePort. It's value has"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# to be > 30000"}]},{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"nodePort"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"30080"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"selector"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Define which pods are going to"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# be represented by this service"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# The service makes an network"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# endpoint for our app"}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"app"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" webapp\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Setting the Service type to ClusterIP makes the"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# service only available from inside the cluster"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# To expose a port use NodePort instead"}]},{"type":"text","value":"\n  "},{"type":"element","tagName":"span","properties":{"className":["token","key","atrule"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" NodePort"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Your complete Microservice deployment should now look something like this:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/ff553fffe62b42391529e3e63c32176e/25912/kubernetes_microservices_11.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block;  max-width: 800px; margin-left: auto; margin-right: auto;"},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 60.90686274509803%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABmklEQVQoz22S3Y6CMBCFqwiIf+iKNy7KItCWUgotbMTNvv9z7SlcmDUmEzIpc2a+OS05VP2KtwFtECvWrku9LFTA20gYI4xkTUmVk1WLW0Wu7BkJJ+cbOap7pIdjOxz1I9KPfd2vWOPntZvLj+YeCjNPuJfJNW/Jhb6Kd9xshFlzjd8Ba/BjduXOV+mkAhQ+VbOEYSzavZkcis4rahdgqfByOUs4kiVtrJhraHCIvmi3KTVyO39COKdWjJ2nsX5Rg3BxE8idm8Dylj+TCFTj0MvrOaBGrtlnRsKyG7GtVdaVC3XthhpF8M+3UHJJlRXTZisMhgPTzWsnzgkqEGgJ2gkJMgxEe9QhR7hjUxxO3Z/YO9H5hfJGNnydtFykFUahDth2bKGWmP/2qiI1nPrfyAwn8xNKuz+oQDv/4ijCbiSm6BWAPC5exVuux0eicL2wmlyYRU04AsNhHvRoN13Eq/gg+x2i6rZVt5Pdvv5GIIcL9p7GdcAMq61tMf0n3lf99LZOBt8BYS3kGsvPEwbbUGofWS7h9vORjeI/6j9Q2iAA8R4AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n    "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px transparent;","alt":"A Kubernetes Cluster & Microservices","title":"","src":"/static/ff553fffe62b42391529e3e63c32176e/b21dd/kubernetes_microservices_11.png","srcSet":["/static/ff553fffe62b42391529e3e63c32176e/2d451/kubernetes_microservices_11.png 200w","/static/ff553fffe62b42391529e3e63c32176e/06807/kubernetes_microservices_11.png 400w","/static/ff553fffe62b42391529e3e63c32176e/b21dd/kubernetes_microservices_11.png 800w","/static/ff553fffe62b42391529e3e63c32176e/25912/kubernetes_microservices_11.png 816w"],"sizes":["(max-width:","800px)","100vw,","800px"]},"children":[]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n  "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And you should be able to access the web interface on port "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"30080"}]},{"type":"text","value":" on your master server IP address:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"/kubernetes_microservices_12-d61b7852ef6d025a1dedb4fa7616327d.gif","alt":"A Kubernetes Cluster & Microservices"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"hr","properties":{},"children":[]}],"data":{"quirksMode":false}},"fields":{"slug":"/kubernetes-and-microservices/","prefix":"2019-01-17"},"frontmatter":{"title":"Kubernetes and Microservices","subTitle":"Red Hat Enterprise and Centos Linux Server Adminsitration","cover":{"childImageSharp":{"resize":{"src":"/static/90ae2099634c4c40434aae05c0647f4d/ada8c/photo-34364880182_fe2d33582b_o-cover.jpg"}}}}},"author":{"id":"9c69de06-11ab-55c9-b52a-3cc0b2f51365","html":"<p><strong>Mike Polinowski</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\"/contact/\">contact me</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. :hearts:</p>"},"footnote":{"id":"24817670-3434-5a21-9de1-e9fab89708d7","html":"<ul>\n<li>This is a personal Developer Blog</li>\n<li>Ξ</li>\n<li>built by <a href=\"https://github.com/mpolinowski\">Mike Polinowski</a></li>\n<li>Ξ</li>\n<li>with <a href=\"https://www.gatsbyjs.org/\">Gatsby</a> &#x26; <a href=\"https://reactjs.org\">React</a></li>\n<li>Ξ</li>\n<li>source code on <a href=\"https://github.com/mpolinowski/mpolinowski.github.io\">GitHub</a></li>\n<li>Ξ</li>\n<li>deliverd by <a href=\"https://pages.github.com\">Github Pages</a></li>\n<li>Ξ</li>\n<li>photos from <a href=\"https://www.flickr.com/people/149680084@N06/\">Flickr</a></li>\n</ul>"}},"pageContext":{"slug":"/kubernetes-and-microservices/"}}